# Event 40

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 2/3       |
| Offset          | 0x0001    |
| Data Size       | 491 bytes |
| Calculated Size | 491 bytes |
| Instructions    | 71        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0000:    20 01 42 45 00 80 F0  FF FF 7F F0 FF FF 7F 66    .BE..........f
0010: 64 6F 31 01 80 55 00 80  F0 FF FF 7F F0 FF FF 7F  do1..U..........
0020: 66 64 6F 31 5C 00 02 80  5C 01 02 80 75 00 03 80  fdo1\...\...u...
0030: 75 01 38 04 80 46 01 29  03 F0 FF FF 7F 10 79 00  u.8..F.)......y.
0040: 06 30 0F 01 F0 FF FF 7F  79 00 F0 FF FF 7F 06 30  .0......y......0
0050: 0F 01 45 05 80 F0 FF FF  7F F0 FF FF 7F 63 6D 32  ..E..........cm2
0060: 30 01 80 55 05 80 F0 FF  FF 7F F0 FF FF 7F 63 6D  0..U..........cm
0070: 32 30 4C 80 06 30 0F 01  45 00 80 F0 FF FF 7F F0  20L..0..E.......
0080: FF FF 7F 66 64 69 31 01  80 55 00 80 F0 FF FF 7F  ...fdi1..U......
0090: F0 FF FF 7F 66 64 69 31  1C 06 80 2B 06 30 0F 01  ....fdi1...+.0..
00A0: 07 80 23 27 03 06 30 0F  01 03 27 03 F0 FF FF 7F  ..#'..0...'.....
00B0: 11 1C 08 80 4D 45 05 80  F0 FF FF 7F F0 FF FF 7F  ....ME..........
00C0: 63 6D 32 31 01 80 55 05  80 F0 FF FF 7F F0 FF FF  cm21..U.........
00D0: 7F 63 6D 32 31 1C 09 80  29 04 F0 FF FF 7F 33 29  .cm21...).....3)
00E0: 04 06 30 0F 01 09 4A F0  FF FF 7F 06 30 0F 01 4A  ..0...J.....0..J
00F0: 06 30 0F 01 F0 FF FF 7F  6F 76 06 30 0F 01 27 04  .0......ov.0..'.
0100: 06 30 0F 01 04 2B 06 30  0F 01 0A 80 23 29 05 06  .0...+.0....#)..
0110: 30 0F 01 08 45 05 80 F0  FF FF 7F F0 FF FF 7F 63  0...E..........c
0120: 6D 32 32 01 80 55 05 80  F0 FF FF 7F F0 FF FF 7F  m22..U..........
0130: 63 6D 32 32 2B 06 30 0F  01 0B 80 23 2B 06 30 0F  cm22+.0....#+.0.
0140: 01 0C 80 23 27 04 06 30  0F 01 07 1C 06 80 7D 0D  ...#'..0......}.
0150: 80 45 0E 80 F0 FF FF 7F  F0 FF FF 7F 71 73 74 63  .E..........qstc
0160: 01 80 1C 0F 80 2B 06 30  0F 01 10 80 23 1C 06 80  .....+.0....#...
0170: 7B F0 FF FF 7F 27 03 F0  FF FF 7F 15 1C 11 80 45  {....'.........E
0180: 05 80 F0 FF FF 7F F0 FF  FF 7F 63 6D 32 33 01 80  ..........cm23..
0190: 55 05 80 F0 FF FF 7F F0  FF FF 7F 63 6D 32 33 4C  U..........cm23L
01A0: 1C 12 80 4D 45 00 80 F0  FF FF 7F F0 FF FF 7F 66  ...ME..........f
01B0: 64 6F 32 01 80 55 00 80  F0 FF FF 7F F0 FF FF 7F  do2..U..........
01C0: 66 64 6F 32 5C 00 13 80  5C 01 13 80 46 00 7B 06  fdo2\...\...F.{.
01D0: 30 0F 01 4E 01 06 30 0F  01 45 00 80 F0 FF FF 7F  0..N..0..E......
01E0: F0 FF FF 7F 66 64 69 32  01 80 21 00              ....fdi2..!.    
```

## Opcodes

```
  0: 0x0001 [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
  1: 0x0003 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  2: 0x0004 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdo1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
  3: 0x0015 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdo1" with entities [LocalPlayer, LocalPlayer], work=200*
  4: 0x0024 [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 162*
  5: 0x0028 [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 162*
  6: 0x002C [0x75] LOAD_ROOM(Load indoor room, room=436*)
  7: 0x0030 [0x75] LOAD_ROOM(No action)
  8: 0x0032 [0x38] SET_CLIENT_EVENT_MODE(mode=3*)
  9: 0x0035 [0x46] CAMERA_CONTROL: Disable user control
 10: 0x0037 [0x29] REQ_SET_WAIT(priority=0x03, entity_id=LocalPlayer, tag_num=0x10)
 11: 0x003E [0x79] Heimji-Keimji (ID: 17772550/0x010F3006) looks at LocalPlayer (Basic look)
 12: 0x0048 [0x79] LocalPlayer looks at Heimji-Keimji (ID: 17772550/0x010F3006) (Basic look)
 13: 0x0052 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "cm20" with entities [LocalPlayer, LocalPlayer], work=[143*, 0*]
 14: 0x0063 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "cm20" with entities [LocalPlayer, LocalPlayer], work=143*
 15: 0x0072 [0x4C] EventEntity->StatusEvent = 8 // Open door
 16: 0x0073 [0x80] LOAD_WAIT(entity=Heimji-Keimji (ID: 17772550/0x010F3006))
 17: 0x0078 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdi1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 18: 0x0089 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdi1" with entities [LocalPlayer, LocalPlayer], work=200*
 19: 0x0098 [0x1C] WAIT(60* ticks)
 20: 0x009B [0x2B] Heimji-Keimji (ID: 17772550/0x010F3006) [10059*]:
    → "Oh, you're finally back.\u007F1\u0000\u0007"
 21: 0x00A2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 22: 0x00A3 [0x27] REQ_SET(priority=0x03, entity_id=Heimji-Keimji (ID: 17772550/0x010F3006), tag_num=0x03)
 23: 0x00AA [0x27] REQ_SET(priority=0x03, entity_id=LocalPlayer, tag_num=0x11)
 24: 0x00B1 [0x1C] WAIT(150* ticks)
 25: 0x00B4 [0x4D] EventEntity->StatusEvent = 9 // Close door
 26: 0x00B5 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "cm21" with entities [LocalPlayer, LocalPlayer], work=[143*, 0*]
 27: 0x00C6 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "cm21" with entities [LocalPlayer, LocalPlayer], work=143*
 28: 0x00D5 [0x1C] WAIT(30* ticks)
 29: 0x00D8 [0x29] REQ_SET_WAIT(priority=0x04, entity_id=LocalPlayer, tag_num=0x33)
 30: 0x00DF [0x29] REQ_SET_WAIT(priority=0x04, entity_id=Heimji-Keimji (ID: 17772550/0x010F3006), tag_num=0x09)
 31: 0x00E6 [0x4A] LocalPlayer looks at Heimji-Keimji (ID: 17772550/0x010F3006)
 32: 0x00EF [0x4A] Heimji-Keimji (ID: 17772550/0x010F3006) looks at LocalPlayer
 33: 0x00F8 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 34: 0x00F9 [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until Heimji-Keimji (ID: 17772550/0x010F3006) Render.Flags0 and Render.Flags3 conditions are met
 35: 0x00FE [0x27] REQ_SET(priority=0x04, entity_id=Heimji-Keimji (ID: 17772550/0x010F3006), tag_num=0x04)
 36: 0x0105 [0x2B] Heimji-Keimji (ID: 17772550/0x010F3006) [10062*]:
    → "Thank you so much for braving the dangers and finding me. You have my thanks. Now, then...\u007F1\u0000\u0007"
 37: 0x010C [0x23] WAIT_FOR_DIALOG_INTERACTION
 38: 0x010D [0x29] REQ_SET_WAIT(priority=0x05, entity_id=Heimji-Keimji (ID: 17772550/0x010F3006), tag_num=0x08)
 39: 0x0114 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "cm22" with entities [LocalPlayer, LocalPlayer], work=[143*, 0*]
 40: 0x0125 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "cm22" with entities [LocalPlayer, LocalPlayer], work=143*
 41: 0x0134 [0x2B] Heimji-Keimji (ID: 17772550/0x010F3006) [10065*]:
    → "I hereby assign you, \u0008, to the post of attach\u0008i of the Embassy to Jeuno.\u007F1\u0000\u0007"
 42: 0x013B [0x23] WAIT_FOR_DIALOG_INTERACTION
 43: 0x013C [0x2B] Heimji-Keimji (ID: 17772550/0x010F3006) [10068*]:
    → "May you prove yourself useful to our homeland and her friendship with Jeuno.\u007F1\u0000\u0007"
 44: 0x0143 [0x23] WAIT_FOR_DIALOG_INTERACTION
 45: 0x0144 [0x27] REQ_SET(priority=0x04, entity_id=Heimji-Keimji (ID: 17772550/0x010F3006), tag_num=0x07)
 46: 0x014B [0x1C] WAIT(60* ticks)
 47: 0x014E [0x7D] LOAD_START_SCHEDULER_PLAYER: Load scheduler with animation_id 32781
 48: 0x0151 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "qstc" with entities [LocalPlayer, LocalPlayer], work=[201*, 0*]
 49: 0x0162 [0x1C] WAIT(210* ticks)
 50: 0x0165 [0x2B] Heimji-Keimji (ID: 17772550/0x010F3006) [10074*]:
    → "Do not stray far, as I may have need of you later. When that time comes, I hope you'll be just as helpful as you were before.\u007F1\u0000\u0007"
 51: 0x016C [0x23] WAIT_FOR_DIALOG_INTERACTION
 52: 0x016D [0x1C] WAIT(60* ticks)
 53: 0x0170 [0x7B] LocalPlayer stops talking
 54: 0x0175 [0x27] REQ_SET(priority=0x03, entity_id=LocalPlayer, tag_num=0x15)
 55: 0x017C [0x1C] WAIT(15* ticks)
 56: 0x017F [0x45] LOAD_SCHEDULED_TASK: Load scheduler "cm23" with entities [LocalPlayer, LocalPlayer], work=[143*, 0*]
 57: 0x0190 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "cm23" with entities [LocalPlayer, LocalPlayer], work=143*
 58: 0x019F [0x4C] EventEntity->StatusEvent = 8 // Open door
 59: 0x01A0 [0x1C] WAIT(90* ticks)
 60: 0x01A3 [0x4D] EventEntity->StatusEvent = 9 // Close door
 61: 0x01A4 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdo2" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 62: 0x01B5 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdo2" with entities [LocalPlayer, LocalPlayer], work=200*
 63: 0x01C4 [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 117*
 64: 0x01C8 [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 117*
 65: 0x01CC [0x46] CAMERA_CONTROL: Restore default settings
 66: 0x01CE [0x7B] Heimji-Keimji (ID: 17772550/0x010F3006) stops talking
 67: 0x01D3 [0x4E] SET_ENTITY_HIDE_FLAG: Hide Heimji-Keimji (ID: 17772550/0x010F3006)
 68: 0x01D9 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdi2" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 69: 0x01EA [0x21] END_EVENT
 70: 0x01EB [0x00] END_REQSTACK()
```
