# Event 521

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 5/5       |
| Offset          | 0x1DCD    |
| Data Size       | 618 bytes |
| Calculated Size | 618 bytes |
| Instructions    | 80        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
1DC0:                                         42 5D 01               B].
1DD0: 80 08 80 1A 64 00 46 01  38 09 80 94 01 D6 32 03  ....d.F.8.....2.
1DE0: 01 94 01 F0 FF FF 7F BA  D6 32 03 01 01 80 01 80  .........2......
1DF0: 01 80 01 80 BA F0 FF FF  7F 80 80 81 80 82 80 83  ................
1E00: 80 80 D6 32 03 01 80 F0  FF FF 7F 5B 84 80 D6 32  ...2.......[...2
1E10: 03 01 D6 32 03 01 70 61  72 30 53 D6 32 03 01 D6  ...2..par0S.2...
1E20: 32 03 01 70 61 72 30 BA  D6 32 03 01 85 80 86 80  2..par0..2......
1E30: 87 80 88 80 4A F0 FF FF  7F D6 32 03 01 6F 76 F0  ....J.....2..ov.
1E40: FF FF 7F 5C 00 89 80 5C  01 89 80 5C 02 89 80 5C  ...\...\...\...\
1E50: 03 89 80 9A 45 66 80 F8  FF FF 7F F8 FF FF 7F 73  ....Ef.........s
1E60: 30 30 30 01 80 1A 43 00  1C 15 80 AD 00 8A 80 F0  000...C.........
1E70: FF FF 7F D6 32 03 01 1C  8B 80 BB 8C 80 D6 32 03  ....2.........2.
1E80: 01 D6 32 03 01 6D 61 69  6E 01 80 45 66 80 F8 FF  ..2..main..Ef...
1E90: FF 7F F8 FF FF 7F 34 30  35 34 01 80 5B 8D 80 D6  ......4054..[...
1EA0: 32 03 01 D6 32 03 01 70  61 72 31 1C 46 80 45 66  2...2..par1.F.Ef
1EB0: 80 F8 FF FF 7F F8 FF FF  7F 34 30 35 34 01 80 6E  .........4054..n
1EC0: F0 FF FF 7F 8E 80 99 F0  FF FF 7F 1C 46 80 45 66  ............F.Ef
1ED0: 80 F8 FF FF 7F F8 FF FF  7F 34 30 35 34 01 80 1C  .........4054...
1EE0: 46 80 45 66 80 F8 FF FF  7F F8 FF FF 7F 34 30 35  F.Ef.........405
1EF0: 34 01 80 9F 13 80 F8 FF  FF 7F F8 FF FF 7F 73 74  4.............st
1F00: 72 30 01 80 1C 6A 80 52  66 80 F8 FF FF 7F F8 FF  r0...j.Rf.......
1F10: FF 7F 73 30 30 30 45 66  80 F8 FF FF 7F F8 FF FF  ..s000Ef........
1F20: 7F 73 30 30 31 01 80 1C  67 80 9F 13 80 F8 FF FF  .s001...g.......
1F30: 7F F8 FF FF 7F 6B 69 6C  6C 01 80 1C 15 80 52 66  .....kill.....Rf
1F40: 80 F8 FF FF 7F F8 FF FF  7F 73 30 30 31 45 66 80  .........s001Ef.
1F50: F8 FF FF 7F F8 FF FF 7F  73 30 30 32 01 80 1C 15  ........s002....
1F60: 80 45 66 80 F8 FF FF 7F  F8 FF FF 7F 33 30 30 31  .Ef.........3001
1F70: 01 80 1C 15 80 48 8F 80  53 D6 32 03 01 D6 32 03  .....H..S.2...2.
1F80: 01 70 61 72 31 48 90 80  5B 91 80 D6 32 03 01 D6  .par1H..[...2...
1F90: 32 03 01 70 61 72 32 1C  15 80 52 66 80 F8 FF FF  2..par2...Rf....
1FA0: 7F F8 FF FF 7F 73 30 30  32 45 66 80 F8 FF FF 7F  .....s002Ef.....
1FB0: F8 FF FF 7F 73 30 30 33  01 80 CD 92 80 F8 FF FF  ....s003........
1FC0: 7F F8 FF FF 7F 73 30 30  33 01 80 1C 51 80 4B F0  .....s003...Q.K.
1FD0: FF FF 7F 93 80 1C 6A 80  5D 01 80 08 80 1C 15 80  ......j.].......
1FE0: 1A 64 00 CD 92 80 F8 FF  FF 7F F8 FF FF 7F 73 74  .d............st
1FF0: 30 33 01 80 43 00 43 01  52 66 80 F8 FF FF 7F F8  03..C.C.Rf......
2000: FF FF 7F 73 30 30 33 5C  00 23 80 5C 01 23 80 5C  ...s003\.#.\.#.\
2010: 02 24 80 5C 03 25 80 9A  1C 22 80 AB 11 01 80 1C  .$.\.%..."......
2020: 03 80 46 00 45 00 80 F8  FF FF 7F F8 FF FF 7F 66  ..F.E..........f
2030: 64 69 32 01 80 21 00                              di2..!.         
```

## Opcodes

```
  0: 0x1DCD [0x42] SET_CLI_EVENT_CANCEL_DATA()
  1: 0x1DCE [0x5D] SET_MUSIC_VOLUME(volume=0*, fade_time=300*)
  2: 0x1DD3 [0x1A] CALL_SUBROUTINE(address=0x0064)
  3: 0x1DD6 [0x46] CAMERA_CONTROL: Disable user control
  4: 0x1DD8 [0x38] SET_CLIENT_EVENT_MODE(mode=147*)
  5: 0x1DDB [0x94] Marolith (ID: 16986838/0x010332D6)->Render.Flags3 ^= 0x01
  6: 0x1DE1 [0x94] LocalPlayer->Render.Flags3 ^= 0x01
  7: 0x1DE7 [0xBA] SET_ENTITY_POSITION(entity_id=Marolith (ID: 16986838/0x010332D6), pos_x=0.000*, pos_z=0.000*, pos_y=0.000*, direction=0.0°*)
  8: 0x1DF4 [0xBA] SET_ENTITY_POSITION(entity_id=LocalPlayer, pos_x=-265.161*, pos_z=-10.296*, pos_y=-23.500*, direction=377476175.3°*)
  9: 0x1E01 [0x80] LOAD_WAIT(entity=Marolith (ID: 16986838/0x010332D6))
 10: 0x1E06 [0x80] LOAD_WAIT(entity=LocalPlayer)
 11: 0x1E0B [0x5B] LOAD_EXT_SCHEDULER(work_offset=3390*, entity1=Marolith (ID: 16986838/0x010332D6), entity2=Marolith (ID: 16986838/0x010332D6), action="par0")
 12: 0x1E1A [0x53] WAIT_SCHEDULER_TASK(entity1=Marolith (ID: 16986838/0x010332D6), entity2=Marolith (ID: 16986838/0x010332D6), action_id="par0")
 13: 0x1E27 [0xBA] SET_ENTITY_POSITION(entity_id=Marolith (ID: 16986838/0x010332D6), pos_x=-260.092*, pos_z=-11.025*, pos_y=-23.884*, direction=189.5°*)
 14: 0x1E34 [0x4A] LocalPlayer looks at Marolith (ID: 16986838/0x010332D6)
 15: 0x1E3D [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 16: 0x1E3E [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until LocalPlayer Render.Flags0 and Render.Flags3 conditions are met
 17: 0x1E43 [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 31*
 18: 0x1E47 [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 31*
 19: 0x1E4B [0x5C] MUSIC_CONTROL: Set Combat (Solo) music to song 31*
 20: 0x1E4F [0x5C] MUSIC_CONTROL: Set Combat (Party) music to song 31*
 21: 0x1E53 [0x9A] WAIT_MUSIC_SERVER()
 22: 0x1E54 [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="s000", work_offset2=0*)
 23: 0x1E65 [0x1A] CALL_SUBROUTINE(address=0x0043)
 24: 0x1E68 [0x1C] WAIT(60* ticks)
 25: 0x1E6B [0xAD] DUAL_ENTITY_SCHEDULER: Execute sub-case 0 with entities [LocalPlayer, Marolith (ID: 16986838/0x010332D6)], param=94*
 26: 0x1E77 [0x1C] WAIT(270* ticks)
 27: 0x1E7A [0xBB] LOAD_EVENT_SCHEDULER_ALT: Load scheduler "main" with entities [Marolith (ID: 16986838/0x010332D6), Marolith (ID: 16986838/0x010332D6)], work=[16*, 0*]
 28: 0x1E8B [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="4054", work_offset2=0*)
 29: 0x1E9C [0x5B] LOAD_EXT_SCHEDULER(work_offset=3391*, entity1=Marolith (ID: 16986838/0x010332D6), entity2=Marolith (ID: 16986838/0x010332D6), action="par1")
 30: 0x1EAB [0x1C] WAIT(20* ticks)
 31: 0x1EAE [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="4054", work_offset2=0*)
 32: 0x1EBF [0x6E] LocalPlayer uses emote 29*
 33: 0x1EC6 [0x99] Wait for LocalPlayer animation to complete
 34: 0x1ECB [0x1C] WAIT(20* ticks)
 35: 0x1ECE [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="4054", work_offset2=0*)
 36: 0x1EDF [0x1C] WAIT(20* ticks)
 37: 0x1EE2 [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="4054", work_offset2=0*)
 38: 0x1EF3 [0x9F] LOAD_SCHEDULED_TASK_ALT: Load scheduler "str0" with entities [EventEntity, EventEntity], work=[127*, 0*]
 39: 0x1F04 [0x1C] WAIT(180* ticks)
 40: 0x1F07 [0x52] END_LOAD_SCHEDULER: End scheduler "s000" with entities [EventEntity, EventEntity], work=864*
 41: 0x1F16 [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="s001", work_offset2=0*)
 42: 0x1F27 [0x1C] WAIT(240* ticks)
 43: 0x1F2A [0x9F] LOAD_SCHEDULED_TASK_ALT: Load scheduler "kill" with entities [EventEntity, EventEntity], work=[127*, 0*]
 44: 0x1F3B [0x1C] WAIT(60* ticks)
 45: 0x1F3E [0x52] END_LOAD_SCHEDULER: End scheduler "s001" with entities [EventEntity, EventEntity], work=864*
 46: 0x1F4D [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="s002", work_offset2=0*)
 47: 0x1F5E [0x1C] WAIT(60* ticks)
 48: 0x1F61 [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="3001", work_offset2=0*)
 49: 0x1F72 [0x1C] WAIT(60* ticks)
 50: 0x1F75 [0x48] [System] [9783*]:
    → "You received the aeropearl!\u0000\u0007"
 51: 0x1F78 [0x53] WAIT_SCHEDULER_TASK(entity1=Marolith (ID: 16986838/0x010332D6), entity2=Marolith (ID: 16986838/0x010332D6), action_id="par1")
 52: 0x1F85 [0x48] [System] [9784*]:
    → "However, it appears to have been drained of its magical energy...\u0000\u0007"
 53: 0x1F88 [0x5B] LOAD_EXT_SCHEDULER(work_offset=3392*, entity1=Marolith (ID: 16986838/0x010332D6), entity2=Marolith (ID: 16986838/0x010332D6), action="par2")
 54: 0x1F97 [0x1C] WAIT(60* ticks)
 55: 0x1F9A [0x52] END_LOAD_SCHEDULER: End scheduler "s002" with entities [EventEntity, EventEntity], work=864*
 56: 0x1FA9 [0x45] LOAD_SCHEDULED_TASK(work_offset1=864*, entity1=EventEntity, entity2=EventEntity, scheduler_id="s003", work_offset2=0*)
 57: 0x1FBA [0xCD] LOAD_SCHEDULED_TASK_ALT4(work_offset=7*, entity1=EventEntity, entity2=EventEntity, action="s003", work_offset2=0*)
 58: 0x1FCB [0x1C] WAIT(120* ticks)
 59: 0x1FCE [0x4B] UPDATE_ENTITY_YAW(entity=LocalPlayer, yaw=4.02°*)
 60: 0x1FD5 [0x1C] WAIT(180* ticks)
 61: 0x1FD8 [0x5D] SET_MUSIC_VOLUME(volume=0*, fade_time=300*)
 62: 0x1FDD [0x1C] WAIT(60* ticks)
 63: 0x1FE0 [0x1A] CALL_SUBROUTINE(address=0x0064)
 64: 0x1FE3 [0xCD] LOAD_SCHEDULED_TASK_ALT4(work_offset=7*, entity1=EventEntity, entity2=EventEntity, action="st03", work_offset2=0*)
 65: 0x1FF4 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 66: 0x1FF6 [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 67: 0x1FF8 [0x52] END_LOAD_SCHEDULER: End scheduler "s003" with entities [EventEntity, EventEntity], work=864*
 68: 0x2007 [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 149*
 69: 0x200B [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 149*
 70: 0x200F [0x5C] MUSIC_CONTROL: Set Combat (Solo) music to song 101*
 71: 0x2013 [0x5C] MUSIC_CONTROL: Set Combat (Party) music to song 138*
 72: 0x2017 [0x9A] WAIT_MUSIC_SERVER()
 73: 0x2018 [0x1C] WAIT(15* ticks)
 74: 0x201B [0xAB] EventEntity->DespawnValue = 0* // Set despawn value
 75: 0x201F [0x1C] WAIT(1* ticks)
 76: 0x2022 [0x46] CAMERA_CONTROL: Restore default settings
 77: 0x2024 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=EventEntity, entity2=EventEntity, scheduler_id="fdi2", work_offset2=0*)
 78: 0x2035 [0x21] END_EVENT
 79: 0x2036 [0x00] END_REQSTACK()
```
