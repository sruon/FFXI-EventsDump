# Event 581

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 2/5       |
| Offset          | 0x0001    |
| Data Size       | 504 bytes |
| Calculated Size | 504 bytes |
| Instructions    | 110       |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0000:    03 00 00 02 10 03 01  00 03 10 03 02 00 04 10   ...............
0010: 03 03 00 05 10 03 04 00  06 10 41 00 80 01 80 07  ..........A.....
0020: 10 05 00 41 02 80 03 80  07 10 06 00 41 04 80 05  ...A........A...
0030: 80 07 10 07 00 03 0B 00  08 10 03 0A 00 09 10 20  ............... 
0040: 01 1E F0 FF FF 7F 02 05  00 06 00 00 E5 01 02 0B  ................
0050: 00 06 80 03 65 00 1A 5A  03 1D 07 80 23 03 01 10  ....e..Z....#...
0060: 08 80 01 E2 01 02 0A 00  09 80 00 7C 00 1A 5A 03  ...........|..Z.
0070: 1D 0A 80 23 03 01 10 08  80 01 E2 01 1D 0B 80 23  ...#...........#
0080: 03 01 10 08 80 24 0C 80  0D 80 0A 00 25 02 00 10  .....$......%...
0090: 0E 80 00 9B 00 1A 5A 03  01 E2 01 02 00 10 05 80  ......Z.........
00A0: 00 A6 00 01 E2 01 42 03  08 00 00 10 40 00 80 0F  ......B.....@...
00B0: 80 01 10 08 00 43 00 43  01 03 0D 00 02 10 03 0E  .....C.C........
00C0: 00 03 10 03 10 00 05 10  03 0F 00 06 10 06 01 10  ................
00D0: 06 11 00 02 0D 00 0E 00  04 E5 00 3C 11 00 00 80  ...........<....
00E0: 10 80 01 EC 00 3D 11 00  00 80 10 80 02 0F 00 10  .....=..........
00F0: 00 04 FE 00 3C 11 00 10  80 10 80 01 05 01 3D 11  ....<.........=.
0100: 00 10 80 10 80 02 05 00  00 80 80 15 01 03 0C 00  ................
0110: 00 00 01 35 01 02 05 00  10 80 80 25 01 03 0C 00  ...5.......%....
0120: 01 00 01 35 01 02 05 00  11 80 80 35 01 03 0C 00  ...5.......5....
0130: 02 00 01 35 01 06 04 10  3E 0C 00 08 00 42 01 05  ...5....>....B..
0140: 04 10 1D 12 80 23 24 13  80 14 80 10 80 25 02 00  .....#$......%..
0150: 10 10 80 00 8E 01 3E 11  00 00 80 82 01 40 00 80  ......>......@..
0160: 0F 80 01 10 08 00 3D 01  10 06 80 10 80 1D 15 80  ......=.........
0170: 23 73 16 80 F8 FF FF 7F  F0 FF FF 7F 1C 17 80 01  #s..............
0180: 8B 01 1D 18 80 23 03 01  10 08 80 01 E2 01 02 00  .....#..........
0190: 10 11 80 00 CE 01 3E 11  00 10 80 C2 01 40 00 80  ......>......@..
01A0: 0F 80 01 10 08 00 3C 01  10 06 80 10 80 1D 15 80  ......<.........
01B0: 23 73 16 80 F8 FF FF 7F  F0 FF FF 7F 1C 17 80 01  #s..............
01C0: CB 01 1D 19 80 23 03 01  10 08 80 01 E2 01 02 00  .....#..........
01D0: 10 14 80 00 E2 01 1D 1A  80 23 03 01 10 08 80 01  .........#......
01E0: E2 01 01 F7 01 1D 0B 80  23 03 02 10 06 00 1D 1B  ........#.......
01F0: 80 23 03 01 10 08 80 21  00                       .#.....!.       
```

## Opcodes

```
  0: 0x0001 [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[2]
  1: 0x0006 [0x03] ExtData[1]->WorkLocal[1] = Work_Zone[3]
  2: 0x000B [0x03] ExtData[1]->WorkLocal[2] = Work_Zone[4]
  3: 0x0010 [0x03] ExtData[1]->WorkLocal[3] = Work_Zone[5]
  4: 0x0015 [0x03] ExtData[1]->WorkLocal[4] = Work_Zone[6]
  5: 0x001A [0x41] ExtData[1]->WorkLocal[5] = Work_Zone[7] (bits 0*-7*)
  6: 0x0023 [0x41] ExtData[1]->WorkLocal[6] = Work_Zone[7] (bits 8*-15*)
  7: 0x002C [0x41] ExtData[1]->WorkLocal[7] = Work_Zone[7] (bits 16*-31*)
  8: 0x0035 [0x03] ExtData[1]->WorkLocal[11] = Work_Zone[8]
  9: 0x003A [0x03] ExtData[1]->WorkLocal[10] = Work_Zone[9]
 10: 0x003F [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
 11: 0x0041 [0x1E] EventEntity looks at LocalPlayer and starts talking
 12: 0x0046 [0x02] IF !(ExtData[1]->WorkLocal[5] == ExtData[1]->WorkLocal[6]) GOTO 0x01E5
 13: 0x004E [0x02] IF !(ExtData[1]->WorkLocal[11] >= 10*) GOTO 0x0065
 14: 0x0056 [0x1A] CALL_SUBROUTINE(address=0x035A)
 15: 0x0059 [0x1D] PRINT_EVENT_MESSAGE(message_id=15567*)
    → "You have not yet reached level 10. I am sorry, but for safety reasons, I am not authorized to teleport anyone under the current level cap.\u007F1\u0000\u0007"
 16: 0x005C [0x23] WAIT_FOR_DIALOG_INTERACTION
 17: 0x005D [0x03] Work_Zone[1] = 1073741824*
 18: 0x0062 [0x01] GOTO 0x01E2
 19: 0x0065 [0x02] IF !(ExtData[1]->WorkLocal[10] == 1073741823*) GOTO 0x007C
 20: 0x006D [0x1A] CALL_SUBROUTINE(address=0x035A)
 21: 0x0070 [0x1D] PRINT_EVENT_MESSAGE(message_id=15566*)
    → "Unfortunately, at this time there is nowhere I can teleport you. Please come again.\u007F1\u0000\u0007"
 22: 0x0073 [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x0074 [0x03] Work_Zone[1] = 1073741824*
 24: 0x0079 [0x01] GOTO 0x01E2
 25: 0x007C [0x1D] PRINT_EVENT_MESSAGE(message_id=15556*)
    → "Welcome to the Regional Teleportation Service!\u007F1\u0000\u0007"
 26: 0x007F [0x23] WAIT_FOR_DIALOG_INTERACTION
 27: 0x0080 [0x03] Work_Zone[1] = 1073741824*
 28: 0x0085 [0x24] CREATE_DIALOG(message_id=15550*, default_option=5*, option_flags=0x0A)
    → "Where would you like to teleport to?\u0007\u000B.\u0007.\u0007.\u0007.\u0007.\u0007The Ronfaure Region.\u0007The Zulkheim Region.\u0007The Norvallen Region.\u0007The Gustaberg Region.\u0007The Derfland Region.\u0007The Sarutabaruta Region.\u0007The Kolshushu Region.\u0007The Aragoneu Region.\u0007The Fauregandi Region.\u0007The Valdeaunia Region.\u0007Qufim Island.\u0007The Li'Telor Region.\u0007The Kuzotz Region.\u0007The Vollbow Region.\u0007The Elshimo Lowlands Region.\u0007The Elshimo Uplands Region.\u0007Tu'Lia.\u0007.\u0007The Tavnazian Archipelago.\u0007.\u0007.\u0007.\u0007.\u0007.\u0007.\u0007Teleport?\u0007Nowhere at the moment.\u007F1\u0000\u0007"
 29: 0x008C [0x25] WAIT_DIALOG_SELECT()
 30: 0x008D [0x02] IF !(Work_Zone[0] == 30*) GOTO 0x009B
 31: 0x0095 [0x1A] CALL_SUBROUTINE(address=0x035A)
 32: 0x0098 [0x01] GOTO 0x01E2
 33: 0x009B [0x02] IF !(Work_Zone[0] == 31*) GOTO 0x00A6
 34: 0x00A3 [0x01] GOTO 0x01E2
 35: 0x00A6 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 36: 0x00A7 [0x03] ExtData[1]->WorkLocal[8] = Work_Zone[0]
 37: 0x00AC [0x40] SET_BIT_WORK_RANGE(start_bit=0*, end_bit=9*, target=Work_Zone[1], source=ExtData[1]->WorkLocal[8])
 38: 0x00B5 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 39: 0x00B7 [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 40: 0x00B9 [0x03] ExtData[1]->WorkLocal[13] = Work_Zone[2]
 41: 0x00BE [0x03] ExtData[1]->WorkLocal[14] = Work_Zone[3]
 42: 0x00C3 [0x03] ExtData[1]->WorkLocal[16] = Work_Zone[5]
 43: 0x00C8 [0x03] ExtData[1]->WorkLocal[15] = Work_Zone[6]
 44: 0x00CD [0x06] Work_Zone[1] = 0
 45: 0x00D0 [0x06] ExtData[1]->WorkLocal[17] = 0
 46: 0x00D3 [0x02] IF !(ExtData[1]->WorkLocal[13] < ExtData[1]->WorkLocal[14]) GOTO 0x00E5
 47: 0x00DB [0x3C] SET_BIT_FLAG_CONDITIONAL(target_work_offset=0x11, bit_index_work_offset=0x8000, condition_work_offset=0x8010)
 48: 0x00E2 [0x01] GOTO 0x00EC
 49: 0x00E5 [0x3D] CLEAR_BIT_FLAG_CONDITIONAL(target_work_offset=0x11, bit_index_work_offset=0x8000, condition_work_offset=0x8010)
 50: 0x00EC [0x02] IF !(ExtData[1]->WorkLocal[15] < ExtData[1]->WorkLocal[16]) GOTO 0x00FE
 51: 0x00F4 [0x3C] SET_BIT_FLAG_CONDITIONAL(target_work_offset=0x11, bit_index_work_offset=0x8010, condition_work_offset=0x8010)
 52: 0x00FB [0x01] GOTO 0x0105
 53: 0x00FE [0x3D] CLEAR_BIT_FLAG_CONDITIONAL(target_work_offset=0x11, bit_index_work_offset=0x8010, condition_work_offset=0x8010)
 54: 0x0105 [0x02] IF !(ExtData[1]->WorkLocal[5] == 0*) GOTO 0x0115
 55: 0x010D [0x03] ExtData[1]->WorkLocal[12] = ExtData[1]->WorkLocal[0]
 56: 0x0112 [0x01] GOTO 0x0135
 57: 0x0115 [0x02] IF !(ExtData[1]->WorkLocal[5] == 1*) GOTO 0x0125
 58: 0x011D [0x03] ExtData[1]->WorkLocal[12] = ExtData[1]->WorkLocal[1]
 59: 0x0122 [0x01] GOTO 0x0135
 60: 0x0125 [0x02] IF !(ExtData[1]->WorkLocal[5] == 2*) GOTO 0x0135
 61: 0x012D [0x03] ExtData[1]->WorkLocal[12] = ExtData[1]->WorkLocal[2]
 62: 0x0132 [0x01] GOTO 0x0135

SUBROUTINE_0135:
 63: 0x0135 [0x06] Work_Zone[4] = 0
 64: 0x0138 [0x3E] IF !(ExtData[1]->WorkLocal[12] bit ExtData[1]->WorkLocal[8]) GOTO 0x0142
 65: 0x013F [0x05] Work_Zone[4] = 1
 66: 0x0142 [0x1D] PRINT_EVENT_MESSAGE(message_id=15562*)
    → "That region is \u000C\u0002[no longer under your home country's control./currently under your home country's control.] You will require 
\u0001 gil or 
\u0003 conquest \u007F\u0012\u0003[point/points] to teleport.\u007F1\u0000\u0007"
 67: 0x0145 [0x23] WAIT_FOR_DIALOG_INTERACTION
 68: 0x0146 [0x24] CREATE_DIALOG(message_id=15564*, default_option=3*, option_flags=1*)
    → "Teleport?\u0007\u000BYes.\u0007Teleport with gil.\u0007Teleport with conquest points.\u0007Later.\u007F1\u0000\u0007"
 69: 0x014D [0x25] WAIT_DIALOG_SELECT()
 70: 0x014E [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x018E
 71: 0x0156 [0x3E] IF !(ExtData[1]->WorkLocal[17] bit 0*) GOTO 0x0182
 72: 0x015D [0x40] SET_BIT_WORK_RANGE(start_bit=0*, end_bit=9*, target=Work_Zone[1], source=ExtData[1]->WorkLocal[8])
 73: 0x0166 [0x3D] CLEAR_BIT_FLAG_CONDITIONAL(target_work_offset=0x1001, bit_index_work_offset=0x8006, condition_work_offset=0x8010)
 74: 0x016D [0x1D] PRINT_EVENT_MESSAGE(message_id=15565*)
    → "Have a wonderful journey!\u007F1\u0000\u0007"
 75: 0x0170 [0x23] WAIT_FOR_DIALOG_INTERACTION
 76: 0x0171 [0x73] EventEntity casts magic 122* on LocalPlayer
 77: 0x017C [0x1C] WAIT(260* ticks)
 78: 0x017F [0x01] GOTO 0x018B
 79: 0x0182 [0x1D] PRINT_EVENT_MESSAGE(message_id=15568*)
    → "You do not have enough gil. Please come back again.\u007F1\u0000\u0007"
 80: 0x0185 [0x23] WAIT_FOR_DIALOG_INTERACTION
 81: 0x0186 [0x03] Work_Zone[1] = 1073741824*
 82: 0x018B [0x01] GOTO 0x01E2
 83: 0x018E [0x02] IF !(Work_Zone[0] == 2*) GOTO 0x01CE
 84: 0x0196 [0x3E] IF !(ExtData[1]->WorkLocal[17] bit 1*) GOTO 0x01C2
 85: 0x019D [0x40] SET_BIT_WORK_RANGE(start_bit=0*, end_bit=9*, target=Work_Zone[1], source=ExtData[1]->WorkLocal[8])
 86: 0x01A6 [0x3C] SET_BIT_FLAG_CONDITIONAL(target_work_offset=0x1001, bit_index_work_offset=0x8006, condition_work_offset=0x8010)
 87: 0x01AD [0x1D] PRINT_EVENT_MESSAGE(message_id=15565*)
    → "Have a wonderful journey!\u007F1\u0000\u0007"
 88: 0x01B0 [0x23] WAIT_FOR_DIALOG_INTERACTION
 89: 0x01B1 [0x73] EventEntity casts magic 122* on LocalPlayer
 90: 0x01BC [0x1C] WAIT(260* ticks)
 91: 0x01BF [0x01] GOTO 0x01CB
 92: 0x01C2 [0x1D] PRINT_EVENT_MESSAGE(message_id=15570*)
    → "You do not have enough conquest points. Please come back again.\u007F1\u0000\u0007"
 93: 0x01C5 [0x23] WAIT_FOR_DIALOG_INTERACTION
 94: 0x01C6 [0x03] Work_Zone[1] = 1073741824*
 95: 0x01CB [0x01] GOTO 0x01E2
 96: 0x01CE [0x02] IF !(Work_Zone[0] == 3*) GOTO 0x01E2
 97: 0x01D6 [0x1D] PRINT_EVENT_MESSAGE(message_id=15572*)
    → "We look forward to seeing you again!\u007F1\u0000\u0007"
 98: 0x01D9 [0x23] WAIT_FOR_DIALOG_INTERACTION
 99: 0x01DA [0x03] Work_Zone[1] = 1073741824*
100: 0x01DF [0x01] GOTO 0x01E2

SUBROUTINE_01E2:
101: 0x01E2 [0x01] GOTO 0x01F7
102: 0x01E5 [0x1D] PRINT_EVENT_MESSAGE(message_id=15556*)
    → "Welcome to the Regional Teleportation Service!\u007F1\u0000\u0007"
103: 0x01E8 [0x23] WAIT_FOR_DIALOG_INTERACTION
104: 0x01E9 [0x03] Work_Zone[2] = ExtData[1]->WorkLocal[6]
105: 0x01EE [0x1D] PRINT_EVENT_MESSAGE(message_id=15573*)
    → "However, at this time I am only authorized to teleport citizens of \u000C\u0000[San d'Oria/Bastok/Windurst].\u007F1\u0000\u0007"
106: 0x01F1 [0x23] WAIT_FOR_DIALOG_INTERACTION
107: 0x01F2 [0x03] Work_Zone[1] = 1073741824*
108: 0x01F7 [0x21] END_EVENT
109: 0x01F8 [0x00] END_REQSTACK()
```
