# Event 124

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 12/154    |
| Offset          | 0x2481    |
| Data Size       | 395 bytes |
| Calculated Size | 395 bytes |
| Instructions    | 62        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
2480:    06 07 00 82 65 36 73  30 90 24 03 07 00 06 80   ....e6s0.$.....
2490: 82 65 36 73 31 9C 24 03  07 00 07 80 02 07 00 03  .e6s1.$.........
24A0: 80 00 A7 24 01 0A 26 06  01 10 02 07 00 06 80 80  ...$..&.........
24B0: E4 25 03 08 00 02 10 03  09 00 03 10 48 CF 80 23  .%..........H..#
24C0: 1A 00 27 02 09 00 03 80  00 D2 24 48 D0 80 23 01  ..'.......$H..#.
24D0: E1 25 48 D1 80 23 06 01  10 24 D2 80 06 80 03 80  .%H..#...$......
24E0: 25 02 00 10 03 80 00 E1  25 20 01 46 01 42 45 18  %.......% .F.BE.
24F0: 80 F0 FF FF 7F F0 FF FF  7F 66 64 6F 31 03 80 55  .........fdo1..U
2500: 18 80 F0 FF FF 7F F0 FF  FF 7F 66 64 6F 31 03 01  ..........fdo1..
2510: 10 06 80 47 00 D3 80 D4  80 0F 80 D5 80 47 01 37  ...G.........G.7
2520: D6 80 D7 80 0F 80 D8 80  45 D9 80 F0 FF FF 7F F0  ........E.......
2530: FF FF 7F 63 6D 62 30 03  80 55 D9 80 F0 FF FF 7F  ...cmb0..U......
2540: F0 FF FF 7F 63 6D 62 30  45 18 80 F0 FF FF 7F F0  ....cmb0E.......
2550: FF FF 7F 66 64 69 31 03  80 55 18 80 F0 FF FF 7F  ...fdi1..U......
2560: F0 FF FF 7F 66 64 69 31  27 03 63 40 0F 01 03 45  ....fdi1'.c@...E
2570: D9 80 F0 FF FF 7F F0 FF  FF 7F 63 6D 62 31 03 80  ..........cmb1..
2580: 1F 00 DA 80 DB 80 0F 80  1F 01 27 03 63 40 0F 01  ..........'.c@..
2590: 04 45 18 80 F0 FF FF 7F  F0 FF FF 7F 66 64 6F 31  .E..........fdo1
25A0: 03 80 1C 21 80 55 18 80  F0 FF FF 7F F0 FF FF 7F  ...!.U..........
25B0: 66 64 6F 31 55 D9 80 F0  FF FF 7F F0 FF FF 7F 63  fdo1U..........c
25C0: 6D 62 31 46 00 1C 21 80  45 18 80 F0 FF FF 7F F0  mb1F..!.E.......
25D0: FF FF 7F 66 64 69 31 03  80 03 01 10 06 80 01 E1  ...fdi1.........
25E0: 25 01 0A 26 02 07 00 07  80 80 0A 26 24 DC 80 06  %..&.......&$...
25F0: 80 03 80 25 02 00 10 03  80 00 07 26 03 01 10 07  ...%.......&....
2600: 80 1A 11 26 01 07 26 01  0A 26 21 00              ...&..&..&!.    
```

## Opcodes

```
  0: 0x2481 [0x06] ExtData[1]->WorkLocal[7] = 0
  1: 0x2484 [0x82] RECT_HIT_TEST_BRANCH: If EventEntity is NOT in rectangle 0x30733665, GOTO 0x2490
  2: 0x248B [0x03] ExtData[1]->WorkLocal[7] = 1*
  3: 0x2490 [0x82] RECT_HIT_TEST_BRANCH: If EventEntity is NOT in rectangle 0x31733665, GOTO 0x249C
  4: 0x2497 [0x03] ExtData[1]->WorkLocal[7] = 2*
  5: 0x249C [0x02] IF !(ExtData[1]->WorkLocal[7] == 0*) GOTO 0x24A7
  6: 0x24A4 [0x01] GOTO 0x260A

SUBROUTINE_24A7:
  7: 0x24A7 [0x06] Work_Zone[1] = 0
  8: 0x24AA [0x02] IF !(ExtData[1]->WorkLocal[7] == 1*) GOTO 0x25E4
  9: 0x24B2 [0x03] ExtData[1]->WorkLocal[8] = Work_Zone[2]
 10: 0x24B7 [0x03] ExtData[1]->WorkLocal[9] = Work_Zone[3]
 11: 0x24BC [0x48] [System] [7487*]:
    → "Our valued customers:\u0007It's always a special day at our tavern.\u007F1\u0000\u0007"
 12: 0x24BF [0x23] WAIT_FOR_DIALOG_INTERACTION
 13: 0x24C0 [0x1A] CALL_SUBROUTINE(address=0x2700)
 14: 0x24C3 [0x02] IF !(ExtData[1]->WorkLocal[9] == 0*) GOTO 0x24D2
 15: 0x24CB [0x48] [System] [7488*]:
    → "It seems you're not welcome today.\u007F1\u0000\u0007"
 16: 0x24CE [0x23] WAIT_FOR_DIALOG_INTERACTION
 17: 0x24CF [0x01] GOTO 0x25E1

SUBROUTINE_24D2:
 18: 0x24D2 [0x48] [System] [7489*]:
    → "It seems you're welcome today.\u007F1\u0000\u0007"
 19: 0x24D5 [0x23] WAIT_FOR_DIALOG_INTERACTION
 20: 0x24D6 [0x06] Work_Zone[1] = 0
 21: 0x24D9 [0x24] CREATE_DIALOG(message_id=7490*, default_option=1*, option_flags=0*)
    → "Enter the tavern?\u0007\u000BYes.\u0007No, not now.\u007F1\u0000\u0007"
 22: 0x24E0 [0x25] WAIT_DIALOG_SELECT()
 23: 0x24E1 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x25E1
 24: 0x24E9 [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
 25: 0x24EB [0x46] CAMERA_CONTROL: Disable user control
 26: 0x24ED [0x42] SET_CLI_EVENT_CANCEL_DATA()
 27: 0x24EE [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
 28: 0x24FF [0x55] WAIT_LOAD_SCHEDULER(work_offset=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1")
 29: 0x250E [0x03] Work_Zone[1] = 1*
 30: 0x2513 [0x47] UPDATE_PLAYER_POS(-99.646*, 89.832*, -0.199*, yaw=152.1°*)
 31: 0x251D [0x47] WAIT_PLAYER_POS_UPDATE
 32: 0x251F [0x37] UPDATE_EVENT_POSITION_AND_DIR: x=-96.713*, z=91.482*, y=-0.199*, direction=144.4°*
 33: 0x2528 [0x45] LOAD_SCHEDULED_TASK(work_offset1=144*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="cmb0", work_offset2=0*)
 34: 0x2539 [0x55] WAIT_LOAD_SCHEDULER(work_offset=144*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="cmb0")
 35: 0x2548 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1", work_offset2=0*)
 36: 0x2559 [0x55] WAIT_LOAD_SCHEDULER(work_offset=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1")
 37: 0x2568 [0x27] REQ_SET(priority=0x03, entity_id=Door:"Marble Bridge" (ID: 17776739/0x010F4063), tag_num=0x03)
 38: 0x256F [0x45] LOAD_SCHEDULED_TASK(work_offset1=144*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="cmb1", work_offset2=0*)
 39: 0x2580 [0x1F] MOVE_ENTITY: EventEntity moves to X=-99.949*, Z=89.538*, Y=-0.199*
 40: 0x2588 [0x1F] MOVE_ENTITY: Update entity position (mode=1)
 41: 0x258A [0x27] REQ_SET(priority=0x03, entity_id=Door:"Marble Bridge" (ID: 17776739/0x010F4063), tag_num=0x04)
 42: 0x2591 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
 43: 0x25A2 [0x1C] WAIT(60* ticks)
 44: 0x25A5 [0x55] WAIT_LOAD_SCHEDULER(work_offset=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1")
 45: 0x25B4 [0x55] WAIT_LOAD_SCHEDULER(work_offset=144*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="cmb1")
 46: 0x25C3 [0x46] CAMERA_CONTROL: Restore default settings
 47: 0x25C5 [0x1C] WAIT(60* ticks)
 48: 0x25C8 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1", work_offset2=0*)
 49: 0x25D9 [0x03] Work_Zone[1] = 1*
 50: 0x25DE [0x01] GOTO 0x25E1

SUBROUTINE_25E1:
 51: 0x25E1 [0x01] GOTO 0x260A

SUBROUTINE_25E4:
 52: 0x25E4 [0x02] IF !(ExtData[1]->WorkLocal[7] == 2*) GOTO 0x260A
 53: 0x25EC [0x24] CREATE_DIALOG(message_id=7491*, default_option=1*, option_flags=0*)
    → "Exit the tavern?\u0007\u000BYes.\u0007Not quite yet.\u007F1\u0000\u0007"
 54: 0x25F3 [0x25] WAIT_DIALOG_SELECT()
 55: 0x25F4 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x2607
 56: 0x25FC [0x03] Work_Zone[1] = 2*
 57: 0x2601 [0x1A] CALL_SUBROUTINE(address=0x2611)
 58: 0x2604 [0x01] GOTO 0x2607

SUBROUTINE_2607:
 59: 0x2607 [0x01] GOTO 0x260A

SUBROUTINE_260A:
 60: 0x260A [0x21] END_EVENT
 61: 0x260B [0x00] END_REQSTACK()
```
