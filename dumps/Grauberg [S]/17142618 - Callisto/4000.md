# Event 4000

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 2/3       |
| Offset          | 0x0001    |
| Data Size       | 771 bytes |
| Calculated Size | 771 bytes |
| Instructions    | 95        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0000:    03 00 00 00 80 41 00  80 00 80 02 10 01 00 41   .....A........A
0010: 01 80 02 80 02 10 02 00  41 03 80 04 80 02 10 03  ........A.......
0020: 00 41 00 80 05 80 03 10  04 00 41 06 80 07 80 03  .A........A.....
0030: 10 06 00 41 02 80 08 80  03 10 05 00 41 04 80 09  ...A........A...
0040: 80 03 10 07 00 41 0A 80  0B 80 03 10 08 00 41 0C  .....A........A.
0050: 80 0D 80 03 10 09 00 41  0E 80 0F 80 03 10 0A 00  .......A........
0060: 41 10 80 11 80 03 10 0B  00 41 12 80 13 80 03 10  A........A......
0070: 0C 00 41 14 80 15 80 03  10 0D 00 41 00 80 05 80  ..A........A....
0080: 04 10 0E 00 41 06 80 07  80 04 10 0F 00 41 02 80  ....A........A..
0090: 08 80 04 10 10 00 41 04  80 09 80 04 10 11 00 41  ......A........A
00A0: 0A 80 0B 80 04 10 12 00  41 0C 80 0D 80 04 10 13  ........A.......
00B0: 00 41 0E 80 0F 80 04 10  14 00 41 10 80 11 80 04  .A........A.....
00C0: 10 15 00 41 12 80 13 80  04 10 16 00 41 14 80 15  ...A........A...
00D0: 80 04 10 17 00 03 18 00  05 10 20 01 1C 16 80 1E  .......... .....
00E0: F0 FF FF 7F 6F 70 02 01  00 00 80 00 FC 00 3C 00  ....op........<.
00F0: 00 01 80 01 80 1D 17 80  23 01 00 01 1D 18 80 23  ........#......#
0100: 24 19 80 00 80 00 00 25  02 00 10 00 80 00 18 01  $......%........
0110: 03 01 10 1A 80 01 01 03  02 00 10 01 80 00 B2 01  ................
0120: 02 03 00 07 80 03 65 01  1D 1B 80 23 1D 1C 80 23  ......e....#...#
0130: 1D 1D 80 23 24 1E 80 00  80 00 80 25 02 00 10 00  ...#$......%....
0140: 80 00 4E 01 1D 1F 80 23  01 00 01 01 62 01 02 00  ..N....#....b...
0150: 10 01 80 00 62 01 1D 20  80 23 03 01 10 21 80 01  ....b.. .#...!..
0160: 62 01 01 AF 01 1D 22 80  23 1D 23 80 23 1D 24 80  b.....".#.#.#.$.
0170: 23 03 02 10 18 00 1D 25  80 23 03 02 10 18 00 24  #......%.#.....$
0180: 26 80 00 80 00 80 25 02  00 10 00 80 00 9B 01 1D  &.....%.........
0190: 27 80 23 03 01 10 28 80  01 AF 01 02 00 10 01 80  '.#...(.........
01A0: 00 AF 01 1D 27 80 23 03  01 10 21 80 01 AF 01 01  ....'.#...!.....
01B0: 01 03 02 00 10 05 80 00  D4 01 1D 29 80 23 1D 2A  ...........).#.*
01C0: 80 23 1D 2B 80 23 1D 2C  80 23 1D 2D 80 23 01 00  .#.+.#.,.#.-.#..
01D0: 01 01 01 03 02 00 10 06  80 00 03 02 1D 2E 80 23  ...............#
01E0: 1D 2F 80 23 1D 30 80 23  1D 31 80 23 1D 32 80 23  ./.#.0.#.1.#.2.#
01F0: 03 02 10 07 80 1D 33 80  23 1D 34 80 23 01 00 01  ......3.#.4.#...
0200: 01 01 03 02 00 10 35 80  00 95 02 1D 36 80 23 03  ......5.....6.#.
0210: 02 10 37 80 03 03 10 38  80 03 04 10 39 80 03 05  ..7....8....9...
0220: 10 3A 80 48 3B 80 23 03  02 10 3C 80 03 03 10 3D  .:.H;.#...<....=
0230: 80 03 04 10 3E 80 03 05  10 3F 80 48 3B 80 23 03  ....>....?.H;.#.
0240: 02 10 40 80 03 03 10 41  80 03 04 10 42 80 03 05  ..@....A....B...
0250: 10 43 80 48 3B 80 23 03  02 10 44 80 03 03 10 45  .C.H;.#...D....E
0260: 80 03 04 10 46 80 03 05  10 47 80 48 3B 80 23 03  ....F....G.H;.#.
0270: 02 10 48 80 03 03 10 49  80 03 04 10 4A 80 03 05  ..H....I....J...
0280: 10 4B 80 48 3B 80 23 1D  4C 80 23 1D 4D 80 23 01  .K.H;.#.L.#.M.#.
0290: 00 01 01 01 03 02 00 10  07 80 00 01 03 1D 4E 80  ..............N.
02A0: 23 1D 4F 80 23 03 02 10  04 00 03 03 10 05 00 03  #.O.#...........
02B0: 04 10 06 00 03 05 10 07  00 48 50 80 23 03 02 10  .........HP.#...
02C0: 08 00 03 03 10 09 00 03  04 10 0A 00 03 05 10 0B  ................
02D0: 00 48 51 80 23 03 02 10  0C 00 03 03 10 0D 00 03  .HQ.#...........
02E0: 04 10 0E 00 03 05 10 0F  00 48 52 80 23 03 02 10  .........HR.#...
02F0: 10 00 03 03 10 11 00 48  53 80 23 01 00 01 01 01  .......HS.#.....
0300: 03 42 21 00                                       .B!.            
```

## Opcodes

```
  0: 0x0001 [0x03] ExtData[1]->WorkLocal[0] = 0*
  1: 0x0006 [0x41] ExtData[1]->WorkLocal[1] = Work_Zone[2] (bits 0*-0*)
  2: 0x000F [0x41] ExtData[1]->WorkLocal[2] = Work_Zone[2] (bits 1*-6*)
  3: 0x0018 [0x41] ExtData[1]->WorkLocal[3] = Work_Zone[2] (bits 7*-9*)
  4: 0x0021 [0x41] ExtData[1]->WorkLocal[4] = Work_Zone[3] (bits 0*-2*)
  5: 0x002A [0x41] ExtData[1]->WorkLocal[6] = Work_Zone[3] (bits 3*-5*)
  6: 0x0033 [0x41] ExtData[1]->WorkLocal[5] = Work_Zone[3] (bits 6*-8*)
  7: 0x003C [0x41] ExtData[1]->WorkLocal[7] = Work_Zone[3] (bits 9*-11*)
  8: 0x0045 [0x41] ExtData[1]->WorkLocal[8] = Work_Zone[3] (bits 12*-14*)
  9: 0x004E [0x41] ExtData[1]->WorkLocal[9] = Work_Zone[3] (bits 15*-17*)
 10: 0x0057 [0x41] ExtData[1]->WorkLocal[10] = Work_Zone[3] (bits 18*-20*)
 11: 0x0060 [0x41] ExtData[1]->WorkLocal[11] = Work_Zone[3] (bits 21*-23*)
 12: 0x0069 [0x41] ExtData[1]->WorkLocal[12] = Work_Zone[3] (bits 24*-26*)
 13: 0x0072 [0x41] ExtData[1]->WorkLocal[13] = Work_Zone[3] (bits 27*-29*)
 14: 0x007B [0x41] ExtData[1]->WorkLocal[14] = Work_Zone[4] (bits 0*-2*)
 15: 0x0084 [0x41] ExtData[1]->WorkLocal[15] = Work_Zone[4] (bits 3*-5*)
 16: 0x008D [0x41] ExtData[1]->WorkLocal[16] = Work_Zone[4] (bits 6*-8*)
 17: 0x0096 [0x41] ExtData[1]->WorkLocal[17] = Work_Zone[4] (bits 9*-11*)
 18: 0x009F [0x41] ExtData[1]->WorkLocal[18] = Work_Zone[4] (bits 12*-14*)
 19: 0x00A8 [0x41] ExtData[1]->WorkLocal[19] = Work_Zone[4] (bits 15*-17*)
 20: 0x00B1 [0x41] ExtData[1]->WorkLocal[20] = Work_Zone[4] (bits 18*-20*)
 21: 0x00BA [0x41] ExtData[1]->WorkLocal[21] = Work_Zone[4] (bits 21*-23*)
 22: 0x00C3 [0x41] ExtData[1]->WorkLocal[22] = Work_Zone[4] (bits 24*-26*)
 23: 0x00CC [0x41] ExtData[1]->WorkLocal[23] = Work_Zone[4] (bits 27*-29*)
 24: 0x00D5 [0x03] ExtData[1]->WorkLocal[24] = Work_Zone[5]
 25: 0x00DA [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
 26: 0x00DC [0x1C] WAIT(10* ticks)
 27: 0x00DF [0x1E] EventEntity looks at LocalPlayer and starts talking
 28: 0x00E4 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 29: 0x00E5 [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
 30: 0x00E6 [0x02] IF !(ExtData[1]->WorkLocal[1] == 0*) GOTO 0x00FC
 31: 0x00EE [0x3C] SET_BIT_FLAG_CONDITIONAL(target_work_offset=ExtData[1]->WorkLocal[0], bit_index_work_offset=1*, condition_work_offset=1*)
 32: 0x00F5 [0x1D] PRINT_EVENT_MESSAGE(message_id=8205*)
    → "Greetings, fair traveler.\u0007My sisters and I have a proposal for thee.\u0007Prithee lend us thine ear.\u007F1\u0000\u0007"
 33: 0x00F8 [0x23] WAIT_FOR_DIALOG_INTERACTION
 34: 0x00F9 [0x01] GOTO 0x0100
 35: 0x00FC [0x1D] PRINT_EVENT_MESSAGE(message_id=8206*)
    → "How dost thou fare in the task appointed thee, gentle wanderer?\u007F1\u0000\u0007"
 36: 0x00FF [0x23] WAIT_FOR_DIALOG_INTERACTION

SUBROUTINE_0100:
 37: 0x0100 [0x24] CREATE_DIALOG(message_id=8207*, default_option=0*, option_flags=ExtData[1]->WorkLocal[0])
    → "What will you do?\u0007\u000BMove on.\u0007Rescind the agreement.\u0007What sort of proposal?\u0007I shall offer my aid.\u0007Augmentable weapons.\u0007Enemy intelligence.\u007F1\u0000\u0007"
 38: 0x0107 [0x25] WAIT_DIALOG_SELECT()
 39: 0x0108 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x0118
 40: 0x0110 [0x03] Work_Zone[1] = 999*
 41: 0x0115 [0x01] GOTO 0x0301
 42: 0x0118 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x01B2
 43: 0x0120 [0x02] IF !(ExtData[1]->WorkLocal[3] >= 5*) GOTO 0x0165
 44: 0x0128 [0x1D] PRINT_EVENT_MESSAGE(message_id=8225*)
    → "...\u007F1\u0000\u0007"
 45: 0x012B [0x23] WAIT_FOR_DIALOG_INTERACTION
 46: 0x012C [0x1D] PRINT_EVENT_MESSAGE(message_id=8226*)
    → "I see... My apologies for imposing upon thy good nature.\u0007Fare thee well in thy travels.\u007F1\u0000\u0007"
 47: 0x012F [0x23] WAIT_FOR_DIALOG_INTERACTION
 48: 0x0130 [0x1D] PRINT_EVENT_MESSAGE(message_id=8227*)
    → "Remember always that we are unable to return to you items thou hast entrusted to our care.\u0007Once the preparations for the ensorcellment have been made, the process is, sadly, irreversible.\u007F1\u0000\u0007"
 49: 0x0133 [0x23] WAIT_FOR_DIALOG_INTERACTION
 50: 0x0134 [0x24] CREATE_DIALOG(message_id=8228*, default_option=0*, option_flags=0*)
    → "Wouldst thou still retire?\u0007\u000BNay, I shall fight on.\u0007Yea, I am afraid so.\u007F1\u0000\u0007"
 51: 0x013B [0x25] WAIT_DIALOG_SELECT()
 52: 0x013C [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x014E
 53: 0x0144 [0x1D] PRINT_EVENT_MESSAGE(message_id=8229*)
    → "Many thanks.\u0007My sisters and I await tidings of thy triumph.\u007F1\u0000\u0007"
 54: 0x0147 [0x23] WAIT_FOR_DIALOG_INTERACTION
 55: 0x0148 [0x01] GOTO 0x0100

SUBROUTINE_0162:
 56: 0x0162 [0x01] GOTO 0x01AF
 57: 0x0165 [0x1D] PRINT_EVENT_MESSAGE(message_id=8231*)
    → "It would seem our enchantments did not suit thy fancy.\u007F1\u0000\u0007"
 58: 0x0168 [0x23] WAIT_FOR_DIALOG_INTERACTION
 59: 0x0169 [0x1D] PRINT_EVENT_MESSAGE(message_id=8232*)
    → "Sadly, the failed ensorcellment hast rendered thy item useless.\u0007As agreed upon, we must needs dispose of it.\u007F1\u0000\u0007"
 60: 0x016C [0x23] WAIT_FOR_DIALOG_INTERACTION
 61: 0x016D [0x1D] PRINT_EVENT_MESSAGE(message_id=8233*)
    → "Nevertheless, we would fain offer thee a small token of our gratitude for thy aid.\u007F1\u0000\u0007"
 62: 0x0170 [0x23] WAIT_FOR_DIALOG_INTERACTION
 63: 0x0171 [0x03] Work_Zone[2] = ExtData[1]->WorkLocal[24]
 64: 0x0176 [0x1D] PRINT_EVENT_MESSAGE(message_id=8234*)
    → "Though you may deem it little recompense for the loss of your prized possession, please accept this \u0001\u0005#\u0002\u0000\u0000\u0000.\u007F1\u0000\u0007"
 65: 0x0179 [0x23] WAIT_FOR_DIALOG_INTERACTION
 66: 0x017A [0x03] Work_Zone[2] = ExtData[1]->WorkLocal[24]
 67: 0x017F [0x24] CREATE_DIALOG(message_id=8235*, default_option=0*, option_flags=0*)
    → "Accept the item?\u0007\u000BYes.\u0007No.\u007F1\u0000\u0007"
 68: 0x0186 [0x25] WAIT_DIALOG_SELECT()
 69: 0x0187 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x019B
 70: 0x018F [0x1D] PRINT_EVENT_MESSAGE(message_id=8236*)
    → "Our apologies for troubling thee.\u0007Shouldst thou have a change of heart, thou knowest where to find us...\u007F1\u0000\u0007"
 71: 0x0192 [0x23] WAIT_FOR_DIALOG_INTERACTION
 72: 0x0193 [0x03] Work_Zone[1] = 102*
 73: 0x0198 [0x01] GOTO 0x01AF
 74: 0x019B [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x01AF
 75: 0x01A3 [0x1D] PRINT_EVENT_MESSAGE(message_id=8236*)
    → "Our apologies for troubling thee.\u0007Shouldst thou have a change of heart, thou knowest where to find us...\u007F1\u0000\u0007"
 76: 0x01A6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 77: 0x01A7 [0x03] Work_Zone[1] = 101*
 78: 0x01AC [0x01] GOTO 0x01AF

SUBROUTINE_01AF:
 79: 0x01AF [0x01] GOTO 0x0301
 80: 0x01B2 [0x02] IF !(Work_Zone[0] == 2*) GOTO 0x01D4
 81: 0x01BA [0x1D] PRINT_EVENT_MESSAGE(message_id=8208*)
    → "Thy sympathies are appreciated, kind traveler.\u0007By thy leave, I shall share with thee our tale.\u007F1\u0000\u0007"
 82: 0x01BD [0x23] WAIT_FOR_DIALOG_INTERACTION
 83: 0x01BE [0x1D] PRINT_EVENT_MESSAGE(message_id=8209*)
    → "Alas for the plight of my people.\u0007Exiles are we. Our ancient home overrun by fell beasts with claws full covetous, the olden halls made--by our sisters' blood--incarnadine.\u007F1\u0000\u0007"
 84: 0x01C1 [0x23] WAIT_FOR_DIALOG_INTERACTION
 85: 0x01C2 [0x1D] PRINT_EVENT_MESSAGE(message_id=8210*)
    → "Sadly, we have not ourselves the strength to stand against this scourge.\u0007In these trying times, we can rely upon aught but the abiding bond of friendship we share with thee and thy kind.\u007F1\u0000\u0007"
 86: 0x01C5 [0x23] WAIT_FOR_DIALOG_INTERACTION
 87: 0x01C6 [0x1D] PRINT_EVENT_MESSAGE(message_id=8211*)
    → "Should thou be willing to lend us thine aid, trust that thou shall be rewarded in kind.\u0007The fey magick passed down from our mothers and grandmothers will bestow powers hitherto unknown to the arms thou bearest.\u007F1\u0000\u0007"
 88: 0x01C9 [0x23] WAIT_FOR_DIALOG_INTERACTION
 89: 0x01CA [0x1D] PRINT_EVENT_MESSAGE(message_id=8212*)
    → "A boon shall also be granted to any allies who assist thee in thy efforts.\u0007Pray consider our plea...\u007F1\u0000\u0007"
 90: 0x01CD [0x23] WAIT_FOR_DIALOG_INTERACTION
 91: 0x01CE [0x01] GOTO 0x0100

SUBROUTINE_0301:
 92: 0x0301 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 93: 0x0302 [0x21] END_EVENT
 94: 0x0303 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x014B [0x01] GOTO 0x0162
# Dead code (unreachable instructions):
     0x01D1 [0x01] GOTO 0x0301
     0x0200 [0x01] GOTO 0x0301
     0x0292 [0x01] GOTO 0x0301
     0x02FE [0x01] GOTO 0x0301
```