# Event 821

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 6/9       |
| Offset          | 0x15F8    |
| Data Size       | 548 bytes |
| Calculated Size | 548 bytes |
| Instructions    | 103       |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
15F0:                          03 04 00 09 10 1E F0 FF          ........
1600: FF 7F 6F 70 29 10 F0 FF  FF 7F 1D 2B 25 21 03 01  ..op)......+%!..
1610: 6D 80 23 66 0E 80 25 21  03 01 25 21 03 01 74 77  m.#f..%!..%!..tw
1620: 62 30 03 02 10 2D 80 2B  25 21 03 01 6E 80 23 66  b0...-.+%!..n.#f
1630: 0E 80 25 21 03 01 25 21  03 01 74 77 62 31 2B 25  ..%!..%!..twb1+%
1640: 21 03 01 6F 80 23 53 25  21 03 01 25 21 03 01 74  !..o.#S%!..%!..t
1650: 77 62 31 6E 25 21 03 01  41 80 99 25 21 03 01 99  wb1n%!..A..%!...
1660: 25 21 03 01 2B 25 21 03  01 70 80 23 02 04 00 06  %!..+%!..p.#....
1670: 80 00 1A 18 2B 25 21 03  01 71 80 23 03 03 10 35  ....+%!..q.#...5
1680: 80 24 72 80 03 80 03 80  25 02 00 10 06 80 00 1A  .$r.....%.......
1690: 18 42 66 0E 80 25 21 03  01 25 21 03 01 74 77 61  .Bf..%!..%!..twa
16A0: 30 03 03 10 35 80 2B 25  21 03 01 5F 80 23 29 10  0...5.+%!.._.#).
16B0: F0 FF FF 7F 1D 2B 25 21  03 01 60 80 23 66 0E 80  .....+%!..`.#f..
16C0: 25 21 03 01 25 21 03 01  74 77 61 31 03 01 10 4E  %!..%!..twa1...N
16D0: 80 43 00 43 01 29 10 F0  FF FF 7F 1D 03 03 10 35  .C.C.).........5
16E0: 80 93 35 80 2B 25 21 03  01 61 80 23 6E 25 21 03  ..5.+%!..a.#n%!.
16F0: 01 51 80 99 25 21 03 01  2B 25 21 03 01 62 80 23  .Q..%!..+%!..b.#
1700: 93 03 80 03 01 10 4E 80  43 00 43 01 02 04 10 63  ......N.C.C....c
1710: 80 04 1A 17 05 03 00 01  1D 17 06 03 00 48 64 80  .............Hd.
1720: 23 03 03 10 35 80 24 65  80 06 80 03 80 25 02 00  #...5.$e.....%..
1730: 10 06 80 00 62 17 66 0E  80 25 21 03 01 25 21 03  ....b.f..%!..%!.
1740: 01 74 77 62 30 2B 25 21  03 01 66 80 23 66 0E 80  .twb0+%!..f.#f..
1750: 25 21 03 01 25 21 03 01  74 77 62 31 01 1A 18 01  %!..%!..twb1....
1760: 62 17 24 67 80 06 80 03  80 25 02 00 10 03 80 00  b.$g.....%......
1770: E6 17 02 03 00 03 80 00  96 17 6E 25 21 03 01 68  ..........n%!..h
1780: 80 99 25 21 03 01 03 04  10 63 80 2B 25 21 03 01  ..%!.....c.+%!..
1790: 69 80 23 01 1A 18 03 01  10 08 80 43 00 43 01 02  i.#........C.C..
17A0: 02 10 39 80 00 BE 17 6E  25 21 03 01 51 80 99 25  ..9....n%!..Q..%
17B0: 21 03 01 2B 25 21 03 01  6A 80 23 01 1A 18 29 10  !..+%!..j.#...).
17C0: F0 FF FF 7F 1D 03 03 10  35 80 6E 25 21 03 01 17  ........5.n%!...
17D0: 80 99 25 21 03 01 2B 25  21 03 01 6B 80 23 03 01  ..%!..+%!..k.#..
17E0: 10 6C 80 01 17 18 02 00  10 06 80 00 17 18 66 0E  .l............f.
17F0: 80 25 21 03 01 25 21 03  01 74 77 62 30 2B 25 21  .%!..%!..twb0+%!
1800: 03 01 66 80 23 66 0E 80  25 21 03 01 25 21 03 01  ..f.#f..%!..%!..
1810: 74 77 62 31 01 17 18 01  1A 18 21 00              twb1......!.    
```

## Opcodes

```
  0: 0x15F8 [0x03] ExtData[1]->WorkLocal[4] = Work_Zone[9]
  1: 0x15FD [0x1E] EventEntity looks at LocalPlayer and starts talking
  2: 0x1602 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
  3: 0x1603 [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
  4: 0x1604 [0x29] REQ_SET_WAIT(priority=0x10, entity_id=LocalPlayer, tag_num=0x1D)
  5: 0x160B [0x2B] Zasshal (ID: 16982309/0x01032125) [11030*]:
    → "Wot's this?\u0007You fink I 'ave time to explain stuff again...?\u007F1\u0000\u0007"
  6: 0x1612 [0x23] WAIT_FOR_DIALOG_INTERACTION
  7: 0x1613 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb0" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
  8: 0x1622 [0x03] Work_Zone[2] = 854*
  9: 0x1627 [0x2B] Zasshal (ID: 16982309/0x01032125) [11031*]:
    → "Look, you've got a free ticket into the ruins as long as you 'ave the \u0001\u00053\u0002\u0000\u0000\u0000.\u0007It'll vanish once you're in, but at least that tells you it's for real, right?\u007F1\u0000\u0007"
 10: 0x162E [0x23] WAIT_FOR_DIALOG_INTERACTION
 11: 0x162F [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb1" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 12: 0x163E [0x2B] Zasshal (ID: 16982309/0x01032125) [11032*]:
    → "I can't give you more than one at a time, or the boys in blue will get suspicious.\u0007So don't even ask.\u007F1\u0000\u0007"
 13: 0x1645 [0x23] WAIT_FOR_DIALOG_INTERACTION
 14: 0x1646 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "twb1" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)]
 15: 0x1653 [0x6E] Zasshal (ID: 16982309/0x01032125) uses emote 4*
 16: 0x165A [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 17: 0x165F [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 18: 0x1664 [0x2B] Zasshal (ID: 16982309/0x01032125) [11033*]:
    → "I'll always be 'ere with more permits as long as you 'ave the points to spend.\u0007Now, you better go grab that treasure before some other lucky sod makes off wif it.\u007F1\u0000\u0007"
 19: 0x166B [0x23] WAIT_FOR_DIALOG_INTERACTION
 20: 0x166C [0x02] IF !(ExtData[1]->WorkLocal[4] == 1*) GOTO 0x181A
 21: 0x1674 [0x2B] Zasshal (ID: 16982309/0x01032125) [11065*]:
    → "Something else I can 'elp you wif?\u007F1\u0000\u0007"
 22: 0x167B [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x167C [0x03] Work_Zone[3] = 2489*
 24: 0x1681 [0x24] CREATE_DIALOG(message_id=11066*, default_option=0*, option_flags=0*)
    → "Is there something else?\u0007\u000BNot really.\u0007Trading for \u0001\u0001\u0001 \u0001\u0005$\u0002\u0001\u0000\u0000.\u007F1\u0000\u0007"
 25: 0x1688 [0x25] WAIT_DIALOG_SELECT()
 26: 0x1689 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x181A
 27: 0x1691 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 28: 0x1692 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twa0" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 29: 0x16A1 [0x03] Work_Zone[3] = 2489*
 30: 0x16A6 [0x2B] Zasshal (ID: 16982309/0x01032125) [11055*]:
    → "There's my favorite remnants romper!\u0007After a copy of \u0001\u0005#\u0002\u0001\u0000\u0000, are you? Truth be told, I already had me 'ands on one before I ever 'eard you were looking.\u0007Sometimes I swear I'm blessed with the gift of foresight.\u007F1\u0000\u0007"
 31: 0x16AD [0x23] WAIT_FOR_DIALOG_INTERACTION
 32: 0x16AE [0x29] REQ_SET_WAIT(priority=0x10, entity_id=LocalPlayer, tag_num=0x1D)
 33: 0x16B5 [0x2B] Zasshal (ID: 16982309/0x01032125) [11056*]:
    → "I would 'ave said something to you sooner, but it just seemed a bit uncouth of me to be rubbing your nose in it by pointing it out.\u0007Hehehe.\u007F1\u0000\u0007"
 34: 0x16BC [0x23] WAIT_FOR_DIALOG_INTERACTION
 35: 0x16BD [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twa1" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 36: 0x16CC [0x03] Work_Zone[1] = 5*
 37: 0x16D1 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 38: 0x16D3 [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 39: 0x16D5 [0x29] REQ_SET_WAIT(priority=0x10, entity_id=LocalPlayer, tag_num=0x1D)
 40: 0x16DC [0x03] Work_Zone[3] = 2489*
 41: 0x16E1 [0x93] DISPLAY_ITEM_INFO(item_id=2489*)
 42: 0x16E4 [0x2B] Zasshal (ID: 16982309/0x01032125) [11057*]:
    → "So, let's get down to brass tacks. You looking to trade your tokens for this 'ere copy of \u0001\u0005#\u0002\u0001\u0000\u0000?\u007F1\u0000\u0007"
 43: 0x16EB [0x23] WAIT_FOR_DIALOG_INTERACTION
 44: 0x16EC [0x6E] Zasshal (ID: 16982309/0x01032125) uses emote 26*
 45: 0x16F3 [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 46: 0x16F8 [0x2B] Zasshal (ID: 16982309/0x01032125) [11058*]:
    → "Make sure you know you're getting into 'ere, all right?\u0007No refunds from me, ya 'ear?\u007F1\u0000\u0007"
 47: 0x16FF [0x23] WAIT_FOR_DIALOG_INTERACTION
 48: 0x1700 [0x93] DISPLAY_ITEM_INFO(item_id=0*)
 49: 0x1703 [0x03] Work_Zone[1] = 5*
 50: 0x1708 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 51: 0x170A [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 52: 0x170C [0x02] IF !(Work_Zone[4] < 150000*) GOTO 0x171A
 53: 0x1714 [0x05] ExtData[1]->WorkLocal[3] = 1
 54: 0x1717 [0x01] GOTO 0x171D
 55: 0x171A [0x06] ExtData[1]->WorkLocal[3] = 0
 56: 0x171D [0x48] [System] [11064*]:
    → "Current number of tokens: 
\u0002.\u007F1\u0000\u0007"
 57: 0x1720 [0x23] WAIT_FOR_DIALOG_INTERACTION
 58: 0x1721 [0x03] Work_Zone[3] = 2489*
 59: 0x1726 [0x24] CREATE_DIALOG(message_id=11059*, default_option=1*, option_flags=0*)
    → "Trade for the \u0001\u0005#\u0002\u0001\u0000\u0000?\u0007\u000BYes, please.\u0007No, thank you.\u007F1\u0000\u0007"
 60: 0x172D [0x25] WAIT_DIALOG_SELECT()
 61: 0x172E [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x1762
 62: 0x1736 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb0" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 63: 0x1745 [0x2B] Zasshal (ID: 16982309/0x01032125) [11054*]:
    → "Well, if you really want one I reckon you'll be willin' to come up with 'em somehow.\u0007Stop on by anytime. I'll keep up my end.\u007F1\u0000\u0007"
 64: 0x174C [0x23] WAIT_FOR_DIALOG_INTERACTION
 65: 0x174D [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb1" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 66: 0x175C [0x01] GOTO 0x181A

SUBROUTINE_1762:
 67: 0x1762 [0x24] CREATE_DIALOG(message_id=11060*, default_option=1*, option_flags=0*)
    → "You're absolutely sure about this?\u0007\u000BDon't make me say it again.\u0007On second thought...\u007F1\u0000\u0007"
 68: 0x1769 [0x25] WAIT_DIALOG_SELECT()
 69: 0x176A [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x17E6
 70: 0x1772 [0x02] IF !(ExtData[1]->WorkLocal[3] == 0*) GOTO 0x1796
 71: 0x177A [0x6E] Zasshal (ID: 16982309/0x01032125) uses emote 16*
 72: 0x1781 [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 73: 0x1786 [0x03] Work_Zone[4] = 150000*
 74: 0x178B [0x2B] Zasshal (ID: 16982309/0x01032125) [11062*]:
    → "Hey, what's the big idea here?!?\u0007You don't even 'ave the number o' tokens we agreed upon. I 'ope you aren't expecting me to front you.\u0007No layaway plans here, \u0008.\u007F1\u0000\u0007"
 75: 0x1792 [0x23] WAIT_FOR_DIALOG_INTERACTION
 76: 0x1793 [0x01] GOTO 0x181A
 77: 0x1796 [0x03] Work_Zone[1] = 15*
 78: 0x179B [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 79: 0x179D [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 80: 0x179F [0x02] IF !(Work_Zone[2] == 99*) GOTO 0x17BE
 81: 0x17A7 [0x6E] Zasshal (ID: 16982309/0x01032125) uses emote 26*
 82: 0x17AE [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 83: 0x17B3 [0x2B] Zasshal (ID: 16982309/0x01032125) [11063*]:
    → "Oh, you gotta be kidding me.\u0007Look at 'em bags, for Altana's sake. You couldn't fit a 'unk o' rock salt in there, let alone 'is.\u0007Go get your act together and come back. Then maybe we can deal.\u007F1\u0000\u0007"
 84: 0x17BA [0x23] WAIT_FOR_DIALOG_INTERACTION
 85: 0x17BB [0x01] GOTO 0x181A
 86: 0x17BE [0x29] REQ_SET_WAIT(priority=0x10, entity_id=LocalPlayer, tag_num=0x1D)
 87: 0x17C5 [0x03] Work_Zone[3] = 2489*
 88: 0x17CA [0x6E] Zasshal (ID: 16982309/0x01032125) uses emote 36*
 89: 0x17D1 [0x99] Wait for Zasshal (ID: 16982309/0x01032125) animation to complete
 90: 0x17D6 [0x2B] Zasshal (ID: 16982309/0x01032125) [11061*]:
    → "Deal! That settles it then. 'Em there tokens for this 'ere copy of \u0001\u0005#\u0002\u0001\u0000\u0000.\u0007No turning back now!\u007F1\u0000\u0007"
 91: 0x17DD [0x23] WAIT_FOR_DIALOG_INTERACTION
 92: 0x17DE [0x03] Work_Zone[1] = 101*
 93: 0x17E3 [0x01] GOTO 0x1817
 94: 0x17E6 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x1817
 95: 0x17EE [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb0" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 96: 0x17FD [0x2B] Zasshal (ID: 16982309/0x01032125) [11054*]:
    → "Well, if you really want one I reckon you'll be willin' to come up with 'em somehow.\u0007Stop on by anytime. I'll keep up my end.\u007F1\u0000\u0007"
 97: 0x1804 [0x23] WAIT_FOR_DIALOG_INTERACTION
 98: 0x1805 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "twb1" with entities [Zasshal (ID: 16982309/0x01032125), Zasshal (ID: 16982309/0x01032125)], work=9*
 99: 0x1814 [0x01] GOTO 0x1817

SUBROUTINE_1817:
100: 0x1817 [0x01] GOTO 0x181A

SUBROUTINE_181A:
101: 0x181A [0x21] END_EVENT
102: 0x181B [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x175F [0x01] GOTO 0x1762
```