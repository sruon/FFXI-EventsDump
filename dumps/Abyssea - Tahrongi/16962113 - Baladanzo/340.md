# Event 340

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 8/11      |
| Offset          | 0x00B3    |
| Data Size       | 279 bytes |
| Calculated Size | 279 bytes |
| Instructions    | 48        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
00B0:          42 1A 30 02 2F  00 42 D2 02 01 4E 00 42     B.0./.B...N.B
00C0: D2 02 01 BA 42 D2 02 01  0C 80 0D 80 0E 80 0F 80  ....B...........
00D0: 80 42 D2 02 01 1E F0 FF  FF 7F 6F 70 02 05 10 0F  .B........op....
00E0: 80 00 0B 01 1D 06 80 23  5B 08 80 F8 FF FF 7F F8  .......#[.......
00F0: FF FF 7F 70 61 73 30 1D  09 80 23 53 F8 FF FF 7F  ...pas0...#S....
0100: F8 FF FF 7F 70 61 73 30  01 2B 01 5B 08 80 F8 FF  ....pas0.+.[....
0110: FF 7F F8 FF FF 7F 70 61  73 30 1D 0A 80 23 53 F8  ......pas0...#S.
0120: FF FF 7F F8 FF FF 7F 70  61 73 30 1D 10 80 23 03  .......pas0...#.
0130: 01 10 11 80 43 00 43 01  4A F0 FF FF 7F 42 D2 02  ....C.C.J....B..
0140: 01 1E 42 D2 02 01 45 12  80 F0 FF FF 7F F0 FF FF  ..B...E.........
0150: 7F 66 64 6F 31 0F 80 55  12 80 F0 FF FF 7F F0 FF  .fdo1..U........
0160: FF 7F 66 64 6F 31 2C 42  D2 02 01 42 D2 02 01 62  ..fdo1,B...B...b
0170: 6F 6D 31 1C 13 80 45 12  80 F0 FF FF 7F F0 FF FF  om1...E.........
0180: 7F 66 64 69 30 0F 80 55  12 80 F0 FF FF 7F F0 FF  .fdi0..U........
0190: FF 7F 66 64 69 30 03 01  10 14 80 43 00 43 01 1D  ..fdi0.....C.C..
01A0: 15 80 23 1E F0 FF FF 7F  6F 70 4A F0 FF FF 7F 41  ..#.....opJ....A
01B0: D2 02 01 1D 16 80 23 45  17 80 F0 FF FF 7F F0 FF  ......#E........
01C0: FF 7F 71 73 74 63 0F 80  21 00                    ..qstc..!.      
```

## Opcodes

```
  0: 0x00B3 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  1: 0x00B4 [0x1A] CALL_SUBROUTINE(address=0x0230)
  2: 0x00B7 [0x2F] Unnamed NPC (ID: 16962114/0x0102D242)->Render.Flags0 &= ~0x80000 // Bit 19
  3: 0x00BD [0x4E] SET_ENTITY_HIDE_FLAG: Show Unnamed NPC (ID: 16962114/0x0102D242)
  4: 0x00C3 [0xBA] SET_ENTITY_POSITION(entity_id=References[16929346], pos_x=290.000*, pos_z=-79.329*, pos_y=-16.890*, direction=0.0°*)
  5: 0x00D0 [0x80] LOAD_WAIT(entity=Unnamed NPC (ID: 16962114/0x0102D242))
  6: 0x00D5 [0x1E] EventEntity looks at LocalPlayer and starts talking
  7: 0x00DA [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
  8: 0x00DB [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
  9: 0x00DC [0x02] IF !(Work_Zone[5] == 0*) GOTO 0x010B
 10: 0x00E4 [0x1D] PRINT_EVENT_MESSAGE(message_id=7937*)
    → "Fall! Fall, I say!!! Graaaaaaaaa--\u0007Hm? \u007F\u0000\u0001\u0001\u0001\u0001 \u0001\u0005$\u0002\u0000\u0000\u0000?\u007F1\u0000\u0007"
 11: 0x00E7 [0x23] WAIT_FOR_DIALOG_INTERACTION
 12: 0x00E8 [0x5B] LOAD_EXT_SCHEDULER: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=55*
 13: 0x00F7 [0x1D] PRINT_EVENT_MESSAGE(message_id=7942*)
    → "In the meantime, take this.\u0007It is the least this old Galka can do for a friend.\u007F1\u0000\u0007"
 14: 0x00FA [0x23] WAIT_FOR_DIALOG_INTERACTION
 15: 0x00FB [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 16: 0x0108 [0x01] GOTO 0x012B
 17: 0x010B [0x5B] LOAD_EXT_SCHEDULER: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=55*
 18: 0x011A [0x1D] PRINT_EVENT_MESSAGE(message_id=7939*)
    → "This makes 
\u0001 \u0001	)\u0002\u0001\u0000\u0000\u0002\u0000\u0000\u0000 you have brought me.\u0007You are kind.\u007F1\u0000\u0007"
 19: 0x011D [0x23] WAIT_FOR_DIALOG_INTERACTION
 20: 0x011E [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 21: 0x012B [0x1D] PRINT_EVENT_MESSAGE(message_id=7943*)
    → "This is it, friend.\u0007The day we have long waited for. Today is the day we consign this demon of stone to the fiery netherworld whence it came!\u0007Crumble and fall, monster! You don't belong in this world! Graaahahahahaaa!!!\u007F1\u0000\u0007"
 22: 0x012E [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x012F [0x03] Work_Zone[1] = 1*
 24: 0x0134 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 25: 0x0136 [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 26: 0x0138 [0x4A] LocalPlayer looks at Unnamed NPC (ID: 16962114/0x0102D242)
 27: 0x0141 [0x1E] EventEntity looks at Unnamed NPC (ID: 16962114/0x0102D242) and starts talking
 28: 0x0146 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdo1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 29: 0x0157 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdo1" with entities [LocalPlayer, LocalPlayer], work=200*
 30: 0x0166 [0x2C] CREATE_SCHEDULER_TASK: Create scheduler "bom1" with entities [Unnamed NPC (ID: 16962114/0x0102D242), Unnamed NPC (ID: 16962114/0x0102D242)]
 31: 0x0173 [0x1C] WAIT(240* ticks)
 32: 0x0176 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdi0" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 33: 0x0187 [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdi0" with entities [LocalPlayer, LocalPlayer], work=200*
 34: 0x0196 [0x03] Work_Zone[1] = 2*
 35: 0x019B [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 36: 0x019D [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 37: 0x019F [0x1D] PRINT_EVENT_MESSAGE(message_id=7944*)
    → "No...it cannot be! The wall still stands before me?\u0007Vile demon! Why do you mock me so!?\u0007But I must be strong. I must not falter... For Diegai...!\u007F1\u0000\u0007"
 38: 0x01A2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 39: 0x01A3 [0x1E] EventEntity looks at LocalPlayer and starts talking
 40: 0x01A8 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 41: 0x01A9 [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
 42: 0x01AA [0x4A] LocalPlayer looks at Baladanzo (ID: 16962113/0x0102D241)
 43: 0x01B3 [0x1D] PRINT_EVENT_MESSAGE(message_id=7945*)
    → "You will fall, you demonic heap of rubble!\u0007Even if I must throw myself against you until my last bone shatters to so much dust, you...will...fall!\u0007Graaaaaaaaaaaaaaa...<sob>...\u007F1\u0000\u0007"
 44: 0x01B6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 45: 0x01B7 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "qstc" with entities [LocalPlayer, LocalPlayer], work=[201*, 0*]
 46: 0x01C8 [0x21] END_EVENT
 47: 0x01C9 [0x00] END_REQSTACK()
```
