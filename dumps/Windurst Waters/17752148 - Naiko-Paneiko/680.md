# Event 680

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 49/58     |
| Offset          | 0x0468    |
| Data Size       | 582 bytes |
| Calculated Size | 582 bytes |
| Instructions    | 78        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0460:                          20 01 42 46 01 45 24 80           .BF.E$.
0470: F0 FF FF 7F F0 FF FF 7F  66 64 6F 31 0E 80 5D 0E  ........fdo1..].
0480: 80 25 80 1C 25 80 75 00  26 80 75 01 5C 00 27 80  .%..%.u.&.u.\.'.
0490: 5C 01 27 80 5D 28 80 25  80 38 29 80 29 0B F0 FF  \.'.](.%.8).)...
04A0: FF 7F 3D 1E F0 FF FF 7F  6F 70 45 2A 80 F0 FF FF  ..=.....opE*....
04B0: 7F F0 FF FF 7F 73 30 37  30 0E 80 45 24 80 F0 FF  .....s070..E$...
04C0: FF 7F F0 FF FF 7F 66 64  69 31 0E 80 29 0B 54 E0  ......fdi1..).T.
04D0: 0E 01 31 45 24 80 F0 FF  FF 7F F0 FF FF 7F 66 64  ..1E$.........fd
04E0: 6F 31 0E 80 1C 2B 80 4B  54 E0 0E 01 2C 80 6F 76  o1...+.KT...,.ov
04F0: 54 E0 0E 01 66 02 80 F8  FF FF 7F F8 FF FF 7F 77  T...f..........w
0500: 6F 6E 32 29 08 54 E0 0E  01 19 29 08 54 E0 0E 01  on2).T....).T...
0510: 1A 45 2A 80 F8 FF FF 7F  F8 FF FF 7F 73 30 37 31  .E*.........s071
0520: 0E 80 4E 01 F0 FF FF 7F  45 24 80 F8 FF FF 7F F8  ..N.....E$......
0530: FF FF 7F 66 64 69 31 0E  80 29 0B 54 E0 0E 01 32  ...fdi1..).T...2
0540: 29 0B 54 E0 0E 01 33 52  2A 80 F8 FF FF 7F F8 FF  ).T...3R*.......
0550: FF 7F 73 30 37 31 4E 00  F0 FF FF 7F 45 2A 80 F0  ..s071N.....E*..
0560: FF FF 7F F0 FF FF 7F 73  30 37 36 0E 80 29 0B 54  .......s076..).T
0570: E0 0E 01 34 29 08 54 E0  0E 01 1B 2B 56 E0 0E 01  ...4).T....+V...
0580: 2D 80 23 29 08 54 E0 0E  01 1C 29 0B 54 E0 0E 01  -.#).T....).T...
0590: 35 29 08 54 E0 0E 01 1B  2B 56 E0 0E 01 2E 80 23  5).T....+V.....#
05A0: 29 08 54 E0 0E 01 1C 45  24 80 F0 FF FF 7F F0 FF  ).T....E$.......
05B0: FF 7F 66 64 6F 31 0E 80  1C 25 80 29 08 54 E0 0E  ..fdo1...%.).T..
05C0: 01 1D 66 02 80 54 E0 0E  01 54 E0 0E 01 77 6F 66  ..f..T...T...wof
05D0: 32 29 08 54 E0 0E 01 17  1C 2B 80 45 2A 80 F0 FF  2).T.....+.E*...
05E0: FF 7F F0 FF FF 7F 73 30  37 32 0E 80 45 24 80 F0  ......s072..E$..
05F0: FF FF 7F F0 FF FF 7F 66  64 69 31 0E 80 29 0B 54  .......fdi1..).T
0600: E0 0E 01 36 52 2A 80 F0  FF FF 7F F0 FF FF 7F 73  ...6R*.........s
0610: 30 37 32 45 2A 80 F0 FF  FF 7F F0 FF FF 7F 73 30  072E*.........s0
0620: 37 33 0E 80 29 08 54 E0  0E 01 18 29 0B 54 E0 0E  73..).T....).T..
0630: 01 37 4A 54 E0 0E 01 F0  FF FF 7F 6F 76 F8 FF FF  .7JT.......ov...
0640: 7F 6F 76 54 E0 0E 01 29  0B 54 E0 0E 01 38 5D 0E  .ovT...).T...8].
0650: 80 25 80 45 24 80 F0 FF  FF 7F F0 FF FF 7F 66 64  .%.E$.........fd
0660: 6F 31 0E 80 1C 2F 80 66  02 80 F8 FF FF 7F F8 FF  o1.../.f........
0670: FF 7F 77 6F 66 32 46 00  5C 00 30 80 5C 01 30 80  ..wof2F.\.0.\.0.
0680: 5D 28 80 31 80 1C 24 80  45 24 80 F0 FF FF 7F F0  ](.1..$.E$......
0690: FF FF 7F 66 64 69 31 0E  80 45 0D 80 F0 FF FF 7F  ...fdi1..E......
06A0: F0 FF FF 7F 71 73 74 63  0E 80 20 00 21 00        ....qstc.. .!.  
```

## Opcodes

```
  0: 0x0468 [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
  1: 0x046A [0x42] SET_CLI_EVENT_CANCEL_DATA()
  2: 0x046B [0x46] CAMERA_CONTROL: Disable user control
  3: 0x046D [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
  4: 0x047E [0x5D] SET_MUSIC_VOLUME(volume=0*, fade_time=100*)
  5: 0x0483 [0x1C] WAIT(100* ticks)
  6: 0x0486 [0x75] LOAD_ROOM(Load indoor room, room=389*)
  7: 0x048A [0x75] LOAD_ROOM(No action)
  8: 0x048C [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 123*
  9: 0x0490 [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 123*
 10: 0x0494 [0x5D] SET_MUSIC_VOLUME(volume=127*, fade_time=100*)
 11: 0x0499 [0x38] SET_CLIENT_EVENT_MODE(mode=3*)
 12: 0x049C [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=LocalPlayer, tag_num=0x3D)
 13: 0x04A3 [0x1E] EventEntity looks at LocalPlayer and starts talking
 14: 0x04A8 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 15: 0x04A9 [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
 16: 0x04AA [0x45] LOAD_SCHEDULED_TASK(work_offset1=138*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="s070", work_offset2=0*)
 17: 0x04BB [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1", work_offset2=0*)
 18: 0x04CC [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x31)
 19: 0x04D3 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
 20: 0x04E4 [0x1C] WAIT(60* ticks)
 21: 0x04E7 [0x4B] UPDATE_ENTITY_YAW(entity=Naiko-Paneiko (ID: 17752148/0x010EE054), yaw=21.48°*)
 22: 0x04EE [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 23: 0x04EF [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until Naiko-Paneiko (ID: 17752148/0x010EE054) Render.Flags0 and Render.Flags3 conditions are met
 24: 0x04F4 [0x66] LOAD_EXT_SCHEDULER_MAIN(work_offset=42*, entity1=EventEntity, entity2=EventEntity, action="won2")
 25: 0x0503 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x19)
 26: 0x050A [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1A)
 27: 0x0511 [0x45] LOAD_SCHEDULED_TASK(work_offset1=138*, entity1=EventEntity, entity2=EventEntity, scheduler_id="s071", work_offset2=0*)
 28: 0x0522 [0x4E] SET_ENTITY_HIDE_FLAG: Hide LocalPlayer
 29: 0x0528 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=EventEntity, entity2=EventEntity, scheduler_id="fdi1", work_offset2=0*)
 30: 0x0539 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x32)
 31: 0x0540 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x33)
 32: 0x0547 [0x52] END_LOAD_SCHEDULER: End scheduler "s071" with entities [EventEntity, EventEntity], work=138*
 33: 0x0556 [0x4E] SET_ENTITY_HIDE_FLAG: Show LocalPlayer
 34: 0x055C [0x45] LOAD_SCHEDULED_TASK(work_offset1=138*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="s076", work_offset2=0*)
 35: 0x056D [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x34)
 36: 0x0574 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1B)
 37: 0x057B [0x2B] Talking Doll (ID: 17752150/0x010EE056) [9129*]:
    → "THE...KEY...IS...IN...THE...CAR-DI-AN'S...STOM-ACH...\u007F1\u0000\u0007"
 38: 0x0582 [0x23] WAIT_FOR_DIALOG_INTERACTION
 39: 0x0583 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1C)
 40: 0x058A [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x35)
 41: 0x0591 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1B)
 42: 0x0598 [0x2B] Talking Doll (ID: 17752150/0x010EE056) [9131*]:
    → "THE...KEY...IS...IN...THE...CAR-DI-AN'S...STOM-ACH...\u007F1\u0000\u0007"
 43: 0x059F [0x23] WAIT_FOR_DIALOG_INTERACTION
 44: 0x05A0 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1C)
 45: 0x05A7 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
 46: 0x05B8 [0x1C] WAIT(100* ticks)
 47: 0x05BB [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x1D)
 48: 0x05C2 [0x66] LOAD_EXT_SCHEDULER_MAIN(work_offset=42*, entity1=Naiko-Paneiko (ID: 17752148/0x010EE054), entity2=Naiko-Paneiko (ID: 17752148/0x010EE054), action="wof2")
 49: 0x05D1 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x17)
 50: 0x05D8 [0x1C] WAIT(60* ticks)
 51: 0x05DB [0x45] LOAD_SCHEDULED_TASK(work_offset1=138*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="s072", work_offset2=0*)
 52: 0x05EC [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1", work_offset2=0*)
 53: 0x05FD [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x36)
 54: 0x0604 [0x52] END_LOAD_SCHEDULER: End scheduler "s072" with entities [LocalPlayer, LocalPlayer], work=138*
 55: 0x0613 [0x45] LOAD_SCHEDULED_TASK(work_offset1=138*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="s073", work_offset2=0*)
 56: 0x0624 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x18)
 57: 0x062B [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x37)
 58: 0x0632 [0x4A] Naiko-Paneiko (ID: 17752148/0x010EE054) looks at LocalPlayer
 59: 0x063B [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 60: 0x063C [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until EventEntity Render.Flags0 and Render.Flags3 conditions are met
 61: 0x0641 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 62: 0x0642 [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until Naiko-Paneiko (ID: 17752148/0x010EE054) Render.Flags0 and Render.Flags3 conditions are met
 63: 0x0647 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Naiko-Paneiko (ID: 17752148/0x010EE054), tag_num=0x38)
 64: 0x064E [0x5D] SET_MUSIC_VOLUME(volume=0*, fade_time=100*)
 65: 0x0653 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo1", work_offset2=0*)
 66: 0x0664 [0x1C] WAIT(300* ticks)
 67: 0x0667 [0x66] LOAD_EXT_SCHEDULER_MAIN(work_offset=42*, entity1=EventEntity, entity2=EventEntity, action="wof2")
 68: 0x0676 [0x46] CAMERA_CONTROL: Restore default settings
 69: 0x0678 [0x5C] MUSIC_CONTROL: Set Idle (Day) music to song 151*
 70: 0x067C [0x5C] MUSIC_CONTROL: Set Idle (Night) music to song 151*
 71: 0x0680 [0x5D] SET_MUSIC_VOLUME(volume=127*, fade_time=1*)
 72: 0x0685 [0x1C] WAIT(200* ticks)
 73: 0x0688 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi1", work_offset2=0*)
 74: 0x0699 [0x45] LOAD_SCHEDULED_TASK(work_offset1=201*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="qstc", work_offset2=0*)
 75: 0x06AA [0x20] SET_CLI_EVENT_UC_FLAG: Unlock player control
 76: 0x06AC [0x21] END_EVENT
 77: 0x06AD [0x00] END_REQSTACK()
```
