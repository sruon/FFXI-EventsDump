# Event 52

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 47/86     |
| Offset          | 0x0399    |
| Data Size       | 248 bytes |
| Calculated Size | 248 bytes |
| Instructions    | 48        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0390:                             1E F0 FF FF 7F 6F 70           .....op
03A0: 29 08 44 E0 0E 01 01 1D  19 80 23 1D 1A 80 23 29  ).D.......#...#)
03B0: 08 44 E0 0E 01 1D 24 1B  80 0C 80 0C 80 25 02 00  .D....$......%..
03C0: 10 0C 80 00 CE 03 03 01  10 0C 80 01 8D 04 02 00  ................
03D0: 10 0D 80 00 8D 04 20 01  42 29 0B 44 E0 0E 01 2F  ...... .B).D.../
03E0: 45 1C 80 F0 FF FF 7F F0  FF FF 7F 66 64 6F 30 0C  E..........fdo0.
03F0: 80 1C 1D 80 45 1C 80 F0  FF FF 7F F0 FF FF 7F 66  ....E..........f
0400: 64 69 30 0C 80 02 02 10  1E 80 03 20 04 03 01 10  di0........ ....
0410: 0D 80 29 0B 44 E0 0E 01  30 20 00 21 00 01 79 04  ..).D...0 .!..y.
0420: 02 02 10 01 80 03 37 04  03 01 10 0E 80 29 0B 44  ......7......).D
0430: E0 0E 01 31 01 79 04 02  02 10 00 80 03 4E 04 03  ...1.y.......N..
0440: 01 10 1F 80 29 0B 44 E0  0E 01 32 01 79 04 02 02  ....).D...2.y...
0450: 10 20 80 03 65 04 03 01  10 21 80 29 0B 44 E0 0E  . ..e....!.).D..
0460: 01 33 01 79 04 02 02 10  20 80 04 79 04 03 01 10  .3.y.... ..y....
0470: 22 80 29 0B 44 E0 0E 01  34 45 23 80 F0 FF FF 7F  ".).D...4E#.....
0480: F0 FF FF 7F 71 73 74 63  0C 80 01 8D 04 20 00 21  ....qstc..... .!
0490: 00                                                .               
```

## Opcodes

```
  0: 0x0399 [0x1E] EventEntity looks at LocalPlayer and starts talking
  1: 0x039E [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
  2: 0x039F [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
  3: 0x03A0 [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x01)
  4: 0x03A7 [0x1D] PRINT_EVENT_MESSAGE(message_id=7386*)
    → "Take that hat and walk around Windurst Waters with it. Try and attract as much attention as possible by talking to people.\u007F1\u0000\u0007"
  5: 0x03AA [0x23] WAIT_FOR_DIALOG_INTERACTION
  6: 0x03AB [0x1D] PRINT_EVENT_MESSAGE(message_id=7387*)
    → "Fashion tastes change, so each style of hat has a limited time and area of appeal. It's better if you stay in Windurst Waters and focus your efforts here. You got it?\u007F1\u0000\u0007"
  7: 0x03AE [0x23] WAIT_FOR_DIALOG_INTERACTION
  8: 0x03AF [0x29] REQ_SET_WAIT(priority=0x08, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x1D)
  9: 0x03B6 [0x24] CREATE_DIALOG(message_id=7408*, default_option=0*, option_flags=0*)
    → "Hang your hat up?\u0007\u000BNot yet.\u0007Yes. Done.\u007F1\u0000\u0007"
 10: 0x03BD [0x25] WAIT_DIALOG_SELECT()
 11: 0x03BE [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x03CE
 12: 0x03C6 [0x03] Work_Zone[1] = 0*
 13: 0x03CB [0x01] GOTO 0x048D

SUBROUTINE_03CE:
 14: 0x03CE [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x048D
 15: 0x03D6 [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
 16: 0x03D8 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 17: 0x03D9 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x2F)
 18: 0x03E0 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdo0", work_offset2=0*)
 19: 0x03F1 [0x1C] WAIT(120* ticks)
 20: 0x03F4 [0x45] LOAD_SCHEDULED_TASK(work_offset1=200*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="fdi0", work_offset2=0*)
 21: 0x0405 [0x02] IF !(Work_Zone[2] >= 20*) GOTO 0x0420
 22: 0x040D [0x03] Work_Zone[1] = 1*
 23: 0x0412 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x30)
 24: 0x0419 [0x20] SET_CLI_EVENT_UC_FLAG: Unlock player control
 25: 0x041B [0x21] END_EVENT
 26: 0x041C [0x00] END_REQSTACK()

SUBROUTINE_0420:
 27: 0x0420 [0x02] IF !(Work_Zone[2] >= 30*) GOTO 0x0437
 28: 0x0428 [0x03] Work_Zone[1] = 2*
 29: 0x042D [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x31)
 30: 0x0434 [0x01] GOTO 0x0479

SUBROUTINE_0437:
 31: 0x0437 [0x02] IF !(Work_Zone[2] >= 40*) GOTO 0x044E
 32: 0x043F [0x03] Work_Zone[1] = 3*
 33: 0x0444 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x32)
 34: 0x044B [0x01] GOTO 0x0479

SUBROUTINE_044E:
 35: 0x044E [0x02] IF !(Work_Zone[2] >= 80*) GOTO 0x0465
 36: 0x0456 [0x03] Work_Zone[1] = 4*
 37: 0x045B [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x33)
 38: 0x0462 [0x01] GOTO 0x0479

SUBROUTINE_0465:
 39: 0x0465 [0x02] IF !(Work_Zone[2] < 80*) GOTO 0x0479
 40: 0x046D [0x03] Work_Zone[1] = 5*
 41: 0x0472 [0x29] REQ_SET_WAIT(priority=0x0B, entity_id=Baren-Moren (ID: 17752132/0x010EE044), tag_num=0x34)
 42: 0x0479 [0x45] LOAD_SCHEDULED_TASK(work_offset1=201*, entity1=LocalPlayer, entity2=LocalPlayer, scheduler_id="qstc", work_offset2=0*)
 43: 0x048A [0x01] GOTO 0x048D

SUBROUTINE_048D:
 44: 0x048D [0x20] SET_CLI_EVENT_UC_FLAG: Unlock player control
 45: 0x048F [0x21] END_EVENT
 46: 0x0490 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x041D [0x01] GOTO 0x0479
```