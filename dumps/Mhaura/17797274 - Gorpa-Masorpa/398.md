# Event 398

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 13/15     |
| Offset          | 0x489D    |
| Data Size       | 716 bytes |
| Calculated Size | 716 bytes |
| Instructions    | 114       |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
4890:                                         03 49 00               .I.
48A0: 02 10 03 4A 00 03 10 42  1E F0 FF FF 7F 1C 00 80  ...J...B........
48B0: 03 1E 00 23 80 1D F8 80  23 02 49 00 23 80 80 2B  ...#....#.I.#..+
48C0: 49 66 01 80 F8 FF FF 7F  F8 FF FF 7F 74 6C 6B 30  If..........tlk0
48D0: 1D F9 80 23 71 32 00 80  31 80 71 31 00 00 53 F8  ...#q2..1.q1..S.
48E0: FF FF 7F F8 FF FF 7F 74  6C 6B 30 9D 08 00 00 00  .......tlk0.....
48F0: 41 4D 41 4E 00 00 00 00  00 00 00 00 00 00 00 00  AMAN............
4900: 08 49 1A 69 5F 01 28 49  9D 08 00 00 00 61 6D 61  .I.i_.(I.....ama
4910: 6E 00 00 00 00 00 00 00  00 00 00 00 00 25 49 1A  n............%I.
4920: 69 5F 01 28 49 1A 8A 5F  01 E1 49 02 49 00 00 80  i_.(I.._..I.I...
4930: 80 6F 49 66 01 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  .oIf..........tl
4940: 6B 30 1D FA 80 23 71 10  00 80 71 11 1E 00 53 F8  k0...#q...q...S.
4950: FF FF 7F F8 FF FF 7F 74  6C 6B 30 02 4A 00 1E 00  .......tlk0.J...
4960: 00 69 49 1A 69 5F 01 6C  49 1A 8A 5F 01 E1 49 02  .iI.i_.lI.._..I.
4970: 49 00 32 80 80 E1 49 66  01 80 F8 FF FF 7F F8 FF  I.2...If........
4980: FF 7F 74 6C 6B 30 1D FB  80 23 71 32 00 80 31 80  ..tlk0...#q2..1.
4990: 71 31 00 00 53 F8 FF FF  7F F8 FF FF 7F 74 6C 6B  q1..S........tlk
49A0: 30 9D 08 00 00 00 52 79  63 68 61 72 64 65 00 00  0.....Rycharde..
49B0: 00 00 00 00 00 00 BE 49  1A 69 5F 01 DE 49 9D 08  .......I.i_..I..
49C0: 00 00 00 72 79 63 68 61  72 64 65 00 00 00 00 00  ...rycharde.....
49D0: 00 00 00 DB 49 1A 69 5F  01 DE 49 1A 8A 5F 01 E1  ....I.i_..I.._..
49E0: 49 1C FC 80 66 0B 80 F8  FF FF 7F F8 FF FF 7F 67  I...f..........g
49F0: 68 6E 31 1D EF 80 23 53  F8 FF FF 7F F8 FF FF 7F  hn1...#S........
4A00: 67 68 6E 31 66 01 80 F8  FF FF 7F F8 FF FF 7F 74  ghn1f..........t
4A10: 6C 6B 30 1D F0 80 23 1D  F1 80 23 53 F8 FF FF 7F  lk0...#...#S....
4A20: F8 FF FF 7F 74 6C 6B 30  66 01 80 F8 FF FF 7F F8  ....tlk0f.......
4A30: FF FF 7F 74 6C 6B 31 53  F8 FF FF 7F F8 FF FF 7F  ...tlk1S........
4A40: 74 6C 6B 31 66 01 80 F8  FF FF 7F F8 FF FF 7F 70  tlk1f..........p
4A50: 61 73 30 53 F8 FF FF 7F  F8 FF FF 7F 70 61 73 30  as0S........pas0
4A60: 13 1E 00 45 80 02 1E 00  35 80 05 F7 4A 48 56 80  ...E....5...JHV.
4A70: 23 48 8A 80 23 13 1E 00  45 80 02 1E 00 58 80 05  #H..#...E....X..
4A80: BB 4A 03 02 10 8B 80 03  03 10 8C 80 03 04 10 8D  .J..............
4A90: 80 48 8E 80 23 13 1E 00  45 80 02 1E 00 58 80 05  .H..#...E....X..
4AA0: BB 4A 48 8F 80 23 13 1E  00 45 80 02 1E 00 58 80  .JH..#...E....X.
4AB0: 05 BB 4A 48 90 80 23 48  56 80 23 66 01 80 F8 FF  ..JH..#HV.#f....
4AC0: FF 7F F8 FF FF 7F 7A 69  74 30 1D 5D 80 23 53 F8  ......zit0.].#S.
4AD0: FF FF 7F F8 FF FF 7F 7A  69 74 30 66 01 80 F8 FF  .......zit0f....
4AE0: FF 7F F8 FF FF 7F 70 61  73 30 53 F8 FF FF 7F F8  ......pas0S.....
4AF0: FF FF 7F 70 61 73 30 48  56 80 23 48 91 80 23 03  ...pas0HV.#H..#.
4B00: 02 10 92 80 03 03 10 2D  80 48 93 80 23 03 02 10  .......-.H..#...
4B10: 92 80 48 94 80 23 48 95  80 23 48 75 80 23 03 02  ..H..#H..#Hu.#..
4B20: 10 2D 80 48 89 80 23 48  56 80 23 66 01 80 F8 FF  .-.H..#HV.#f....
4B30: FF 7F F8 FF FF 7F 74 6C  6B 30 1D F2 80 23 53 F8  ......tlk0...#S.
4B40: FF FF 7F F8 FF FF 7F 74  6C 6B 30 66 01 80 F8 FF  .......tlk0f....
4B50: FF 7F F8 FF FF 7F 74 6C  6B 31 53 F8 FF FF 7F F8  ......tlk1S.....
4B60: FF FF 7F 74 6C 6B 31 21  00                       ...tlk1!.       
```

## Opcodes

```
  0: 0x489D [0x03] ExtData[1]->WorkLocal[73] = Work_Zone[2]
  1: 0x48A2 [0x03] ExtData[1]->WorkLocal[74] = Work_Zone[3]
  2: 0x48A7 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  3: 0x48A8 [0x1E] EventEntity looks at LocalPlayer and starts talking
  4: 0x48AD [0x1C] WAIT(1* ticks)
  5: 0x48B0 [0x03] ExtData[1]->WorkLocal[30] = 0*
  6: 0x48B5 [0x1D] PRINT_EVENT_MESSAGE(message_id=8275*)
    → "Ambuscade quiz time!\u007F1\u0000\u0007"
  7: 0x48B8 [0x23] WAIT_FOR_DIALOG_INTERACTION
  8: 0x48B9 [0x02] IF !(ExtData[1]->WorkLocal[73] == 0*) GOTO 0x492B
  9: 0x48C1 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 10: 0x48D0 [0x1D] PRINT_EVENT_MESSAGE(message_id=8276*)
    → "Which organization is in charge of Ambuscade?\u007F1\u0000\u0007"
 11: 0x48D3 [0x23] WAIT_FOR_DIALOG_INTERACTION
 12: 0x48D4 [0x71] USER_INPUT_HANDLER: Menu operation with params (params=[0x8000, 0x8031])
 13: 0x48DA [0x71] USER_INPUT_HANDLER: Menu operation B (param=0x0000)
 14: 0x48DE [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 15: 0x48EB [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 4d414e00000000000000000000000008) != 0) GOTO 0x49 // Also sets 0x4100
 16: 0x4902 [0x1A] CALL_SUBROUTINE(address=0x5F69)
 17: 0x4905 [0x01] GOTO 0x4928

SUBROUTINE_4928:
 18: 0x4928 [0x01] GOTO 0x49E1
 19: 0x492B [0x02] IF !(ExtData[1]->WorkLocal[73] == 1*) GOTO 0x496F
 20: 0x4933 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 21: 0x4942 [0x1D] PRINT_EVENT_MESSAGE(message_id=8277*)
    → "What is the total number of hallmarks earned by all adventurers from September 11, 2018 to October 10, 2018?\u007F1\u0000\u0007"
 22: 0x4945 [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x4946 [0x71] USER_INPUT_HANDLER: Open numerical input dialog (work=1*)
 24: 0x494A [0x71] USER_INPUT_HANDLER: Process numerical input A (work=ExtData[1]->WorkLocal[30])
 25: 0x494E [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 26: 0x495B [0x02] IF !(ExtData[1]->WorkLocal[74] == ExtData[1]->WorkLocal[30]) GOTO 0x4969
 27: 0x4963 [0x1A] CALL_SUBROUTINE(address=0x5F69)
 28: 0x4966 [0x01] GOTO 0x496C
 29: 0x4969 [0x1A] CALL_SUBROUTINE(address=0x5F8A)

SUBROUTINE_496C:
 30: 0x496C [0x01] GOTO 0x49E1
 31: 0x496F [0x02] IF !(ExtData[1]->WorkLocal[73] == 2*) GOTO 0x49E1
 32: 0x4977 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 33: 0x4986 [0x1D] PRINT_EVENT_MESSAGE(message_id=8278*)
    → "Who is the cooking maestro responsible for Mhauran couscous?\u007F1\u0000\u0007"
 34: 0x4989 [0x23] WAIT_FOR_DIALOG_INTERACTION
 35: 0x498A [0x71] USER_INPUT_HANDLER: Menu operation with params (params=[0x8000, 0x8031])
 36: 0x4990 [0x71] USER_INPUT_HANDLER: Menu operation B (param=0x0000)
 37: 0x4994 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 38: 0x49A1 [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 796368617264650000000000000000be) != 0) GOTO 0x49 // Also sets 0x5200
 39: 0x49B8 [0x1A] CALL_SUBROUTINE(address=0x5F69)
 40: 0x49BB [0x01] GOTO 0x49DE

SUBROUTINE_49DE:
 41: 0x49DE [0x01] GOTO 0x49E1

SUBROUTINE_49E1:
 42: 0x49E1 [0x1C] WAIT(60* ticks)
 43: 0x49E4 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "ghn1" with entities [EventEntity, EventEntity], work=41*
 44: 0x49F3 [0x1D] PRINT_EVENT_MESSAGE(message_id=8237*)
    → "Um, you see...\u007F1\u0000\u0007"
 45: 0x49F6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 46: 0x49F7 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "ghn1" with entities [EventEntity, EventEntity]
 47: 0x4A04 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 48: 0x4A13 [0x1D] PRINT_EVENT_MESSAGE(message_id=8238*)
    → "This letter comes from the greataru mage Abdhaljs himself.\u007F1\u0000\u0007"
 49: 0x4A16 [0x23] WAIT_FOR_DIALOG_INTERACTION
 50: 0x4A17 [0x1D] PRINT_EVENT_MESSAGE(message_id=8239*)
    → "Here, you may feel free to give it a read-wead.\u007F1\u0000\u0007"
 51: 0x4A1A [0x23] WAIT_FOR_DIALOG_INTERACTION
 52: 0x4A1B [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 53: 0x4A28 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=40*
 54: 0x4A37 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk1" with entities [EventEntity, EventEntity]
 55: 0x4A44 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=40*
 56: 0x4A53 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 57: 0x4A60 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 58: 0x4A65 [0x02] IF !(ExtData[1]->WorkLocal[30] > 4*) GOTO 0x4AF7
 59: 0x4A6D [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 60: 0x4A70 [0x23] WAIT_FOR_DIALOG_INTERACTION
 61: 0x4A71 [0x48] [System] [8285*]:
    → "\u00072Mommy Dearest,\u0007How have you been? I have been doing quite well.\u007F1\u0000\u0007"
 62: 0x4A74 [0x23] WAIT_FOR_DIALOG_INTERACTION
 63: 0x4A75 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 64: 0x4A7A [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4ABB
 65: 0x4A82 [0x03] Work_Zone[2] = 620*
 66: 0x4A87 [0x03] Work_Zone[3] = 624*
 67: 0x4A8C [0x03] Work_Zone[4] = 4405*
 68: 0x4A91 [0x48] [System] [8286*]:
    → "\u00072If you have a spare moment, could you please send me some \u0001\u0005%\u0002\u0000\u0000\u0000? I have taken quite the liking to fishing, and am hankering to make some \u0001\u0005%\u0002\u0002\u0000\u0000 with all the \u0001\u0005%\u0002\u0001\u0000\u0000 I've caught.\u007F1\u0000\u0007"
 69: 0x4A94 [0x23] WAIT_FOR_DIALOG_INTERACTION
 70: 0x4A95 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 71: 0x4A9A [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4ABB
 72: 0x4AA2 [0x48] [System] [8287*]:
    → "\u00072I think I've come quite far as a cook. Perhaps that lovely Rycharde fellow will teach me a thing or two if I butter him up.\u007F1\u0000\u0007"
 73: 0x4AA5 [0x23] WAIT_FOR_DIALOG_INTERACTION
 74: 0x4AA6 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 75: 0x4AAB [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4ABB
 76: 0x4AB3 [0x48] [System] [8288*]:
    → "\u00072P.S.\u0007\u00072One day, I hope to be able to fully pass the Orastery's Vana'diel Exam.\u00073\u007F1\u0000\u0007"
 77: 0x4AB6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 78: 0x4AB7 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 79: 0x4ABA [0x23] WAIT_FOR_DIALOG_INTERACTION
 80: 0x4ABB [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "zit0" with entities [EventEntity, EventEntity], work=40*
 81: 0x4ACA [0x1D] PRINT_EVENT_MESSAGE(message_id=8215*)
    → "Wh-wh-what!? G-give that back!\u007F6\u0001\u0007Here! Here's the right one!\u007F1\u0000\u0007"
 82: 0x4ACD [0x23] WAIT_FOR_DIALOG_INTERACTION
 83: 0x4ACE [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "zit0" with entities [EventEntity, EventEntity]
 84: 0x4ADB [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=40*
 85: 0x4AEA [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 86: 0x4AF7 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 87: 0x4AFA [0x23] WAIT_FOR_DIALOG_INTERACTION
 88: 0x4AFB [0x48] [System] [8281*]:
    → "\u00072Dearest adventurers,\u0007\u00072Permit me to dispense with the pleasantries and get right down to business.\u007F1\u0000\u0007"
 89: 0x4AFE [0x23] WAIT_FOR_DIALOG_INTERACTION
 90: 0x4AFF [0x03] Work_Zone[2] = 21516*
 91: 0x4B04 [0x03] Work_Zone[3] = 9783*
 92: 0x4B09 [0x48] [System] [8282*]:
    → "\u00072The \u0001\u0005%\u0002\u0000\u0000\u0000 and similar items I mentioned in a previous communique are finally able to be reforged. I have invented a new type of material, dubbed \u00072\u0001\u0005%\u0002\u0001\u0000\u0000,\u00073 specifically for this purpose.\u007F1\u0000\u0007"
 93: 0x4B0C [0x23] WAIT_FOR_DIALOG_INTERACTION
 94: 0x4B0D [0x03] Work_Zone[2] = 21516*
 95: 0x4B12 [0x48] [System] [8283*]:
    → "\u00072I am loath to admit that the exact workings of this new material are a trade secret, but I hope you will indulge me and content yourself in knowing that they serve as excellent catalysts for improving \u0001\u0005%\u0002\u0000\u0000\u0000 and similar items. I say \u00072catalysts\u00073 in the plural because more than one is needed.\u007F1\u0000\u0007"
 96: 0x4B15 [0x23] WAIT_FOR_DIALOG_INTERACTION
 97: 0x4B16 [0x48] [System] [8284*]:
    → "\u00072I bid you not to fret--this is not the final shape that these weapons will take, but I need more detailed data before I am able to complete my research.\u007F1\u0000\u0007"
 98: 0x4B19 [0x23] WAIT_FOR_DIALOG_INTERACTION
 99: 0x4B1A [0x48] [System] [8244*]:
    → "\u00072I have left the details with my representative at the A.M.A.N. Please check with him for more information.\u007F1\u0000\u0007"
100: 0x4B1D [0x23] WAIT_FOR_DIALOG_INTERACTION
101: 0x4B1E [0x03] Work_Zone[2] = 9783*
102: 0x4B23 [0x48] [System] [8268*]:
    → "\u00072Simply deliver the requisite quantity of \u0001\u0005%\u0002\u0000\u0000\u0000 and your weapon of choice to my compatriot at the A.M.A.N., and he will perform the necessary procedure to help unlock the item's latent powers. Do be sure to try it out, and evaluate for yourself its true potential.\u00073\u007F1\u0000\u0007"
103: 0x4B26 [0x23] WAIT_FOR_DIALOG_INTERACTION
104: 0x4B27 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
105: 0x4B2A [0x23] WAIT_FOR_DIALOG_INTERACTION
106: 0x4B2B [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
107: 0x4B3A [0x1D] PRINT_EVENT_MESSAGE(message_id=8240*)
    → "I look forward to helping you with all of your equipment needs!\u007F1\u0000\u0007"
108: 0x4B3D [0x23] WAIT_FOR_DIALOG_INTERACTION
109: 0x4B3E [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
110: 0x4B4B [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=40*
111: 0x4B5A [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk1" with entities [EventEntity, EventEntity]
112: 0x4B67 [0x21] END_EVENT
113: 0x4B68 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x4908 [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 6d616e00000000000000000000000025) != 0) GOTO 0x49 // Also sets 0x6100
     0x491F [0x1A] CALL_SUBROUTINE(address=0x5F69)
     0x4922 [0x01] GOTO 0x4928
     0x4925 [0x1A] CALL_SUBROUTINE(address=0x5F8A)
# Dead code (unreachable instructions):
     0x49BE [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 796368617264650000000000000000db) != 0) GOTO 0x49 // Also sets 0x7200
     0x49D5 [0x1A] CALL_SUBROUTINE(address=0x5F69)
     0x49D8 [0x01] GOTO 0x49DE
     0x49DB [0x1A] CALL_SUBROUTINE(address=0x5F8A)
```