# Event 399

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 14/15     |
| Offset          | 0x4B69    |
| Data Size       | 706 bytes |
| Calculated Size | 706 bytes |
| Instructions    | 112       |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
4B60:                             03 49 00 02 10 03 4A           .I....J
4B70: 00 03 10 42 1E F0 FF FF  7F 1C 00 80 03 1E 00 23  ...B...........#
4B80: 80 1D FD 80 23 02 49 00  23 80 80 F7 4B 66 01 80  ....#.I.#...Kf..
4B90: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 30 1D FE 80 23  ........tlk0...#
4BA0: 71 32 00 80 31 80 71 31  00 00 53 F8 FF FF 7F F8  q2..1.q1..S.....
4BB0: FF FF 7F 74 6C 6B 30 9D  08 00 00 00 41 62 64 68  ...tlk0.....Abdh
4BC0: 61 6C 6A 73 00 00 00 00  00 00 00 00 D4 4B 1A 69  aljs.........K.i
4BD0: 5F 01 F4 4B 9D 08 00 00  00 61 62 64 68 61 6C 6A  _..K.....abdhalj
4BE0: 73 00 00 00 00 00 00 00  00 F1 4B 1A 69 5F 01 F4  s.........K.i_..
4BF0: 4B 1A 8A 5F 01 AD 4C 02  49 00 00 80 80 3B 4C 66  K.._..L.I....;Lf
4C00: 01 80 F8 FF FF 7F F8 FF  FF 7F 74 6C 6B 30 1D FF  ..........tlk0..
4C10: 80 23 71 10 00 80 71 11  1E 00 53 F8 FF FF 7F F8  .#q...q...S.....
4C20: FF FF 7F 74 6C 6B 30 02  4A 00 1E 00 00 35 4C 1A  ...tlk0.J....5L.
4C30: 69 5F 01 38 4C 1A 8A 5F  01 AD 4C 02 49 00 32 80  i_.8L.._..L.I.2.
4C40: 80 AD 4C 66 01 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  ..Lf..........tl
4C50: 6B 30 1D 00 81 23 71 32  00 80 31 80 71 31 00 00  k0...#q2..1.q1..
4C60: 53 F8 FF FF 7F F8 FF FF  7F 74 6C 6B 30 9D 08 00  S........tlk0...
4C70: 00 00 4A 65 75 6E 6F 00  00 00 00 00 00 00 00 00  ..Jeuno.........
4C80: 00 00 8A 4C 1A 69 5F 01  AA 4C 9D 08 00 00 00 6A  ...L.i_..L.....j
4C90: 65 75 6E 6F 00 00 00 00  00 00 00 00 00 00 00 A7  euno............
4CA0: 4C 1A 69 5F 01 AA 4C 1A  8A 5F 01 AD 4C 1C FC 80  L.i_..L.._..L...
4CB0: 66 0B 80 F8 FF FF 7F F8  FF FF 7F 67 68 6E 31 1D  f..........ghn1.
4CC0: EF 80 23 53 F8 FF FF 7F  F8 FF FF 7F 67 68 6E 31  ..#S........ghn1
4CD0: 66 01 80 F8 FF FF 7F F8  FF FF 7F 74 6C 6B 30 1D  f..........tlk0.
4CE0: F0 80 23 1D F1 80 23 53  F8 FF FF 7F F8 FF FF 7F  ..#...#S........
4CF0: 74 6C 6B 30 66 01 80 F8  FF FF 7F F8 FF FF 7F 74  tlk0f..........t
4D00: 6C 6B 31 53 F8 FF FF 7F  F8 FF FF 7F 74 6C 6B 31  lk1S........tlk1
4D10: 66 01 80 F8 FF FF 7F F8  FF FF 7F 70 61 73 30 53  f..........pas0S
4D20: F8 FF FF 7F F8 FF FF 7F  70 61 73 30 13 1E 00 45  ........pas0...E
4D30: 80 02 1E 00 35 80 05 B9  4D 48 56 80 23 48 96 80  ....5...MHV.#H..
4D40: 23 13 1E 00 45 80 02 1E  00 58 80 05 7D 4D 03 02  #...E....X..}M..
4D50: 10 97 80 48 98 80 23 13  1E 00 45 80 02 1E 00 58  ...H..#...E....X
4D60: 80 05 7D 4D 48 99 80 23  13 1E 00 45 80 02 1E 00  ..}MH..#...E....
4D70: 58 80 05 7D 4D 48 9A 80  23 48 56 80 23 66 01 80  X..}MH..#HV.#f..
4D80: F8 FF FF 7F F8 FF FF 7F  7A 69 74 30 1D 5D 80 23  ........zit0.].#
4D90: 53 F8 FF FF 7F F8 FF FF  7F 7A 69 74 30 66 01 80  S........zit0f..
4DA0: F8 FF FF 7F F8 FF FF 7F  70 61 73 30 53 F8 FF FF  ........pas0S...
4DB0: 7F F8 FF FF 7F 70 61 73  30 48 56 80 23 48 9B 80  .....pas0HV.#H..
4DC0: 23 03 02 10 9C 80 03 03  10 2E 80 48 9D 80 23 03  #..........H..#.
4DD0: 02 10 9C 80 48 94 80 23  48 95 80 23 48 75 80 23  ....H..#H..#Hu.#
4DE0: 03 02 10 2E 80 48 89 80  23 48 56 80 23 66 01 80  .....H..#HV.#f..
4DF0: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 30 1D F2 80 23  ........tlk0...#
4E00: 53 F8 FF FF 7F F8 FF FF  7F 74 6C 6B 30 66 01 80  S........tlk0f..
4E10: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 31 53 F8 FF FF  ........tlk1S...
4E20: 7F F8 FF FF 7F 74 6C 6B  31 21 00                 .....tlk1!.     
```

## Opcodes

```
  0: 0x4B69 [0x03] ExtData[1]->WorkLocal[73] = Work_Zone[2]
  1: 0x4B6E [0x03] ExtData[1]->WorkLocal[74] = Work_Zone[3]
  2: 0x4B73 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  3: 0x4B74 [0x1E] EventEntity looks at LocalPlayer and starts talking
  4: 0x4B79 [0x1C] WAIT(1* ticks)
  5: 0x4B7C [0x03] ExtData[1]->WorkLocal[30] = 0*
  6: 0x4B81 [0x1D] PRINT_EVENT_MESSAGE(message_id=8289*)
    → "Ambuscade Quiz Time, Part Two!\u007F1\u0000\u0007"
  7: 0x4B84 [0x23] WAIT_FOR_DIALOG_INTERACTION
  8: 0x4B85 [0x02] IF !(ExtData[1]->WorkLocal[73] == 0*) GOTO 0x4BF7
  9: 0x4B8D [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 10: 0x4B9C [0x1D] PRINT_EVENT_MESSAGE(message_id=8290*)
    → "Who is the famous personage supporting adventurers in their romps through Ambuscade?\u007F1\u0000\u0007"
 11: 0x4B9F [0x23] WAIT_FOR_DIALOG_INTERACTION
 12: 0x4BA0 [0x71] USER_INPUT_HANDLER: Menu operation with params (params=[0x8000, 0x8031])
 13: 0x4BA6 [0x71] USER_INPUT_HANDLER: Menu operation B (param=0x0000)
 14: 0x4BAA [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 15: 0x4BB7 [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 626468616c6a730000000000000000d4) != 0) GOTO 0x4B // Also sets 0x4100
 16: 0x4BCE [0x1A] CALL_SUBROUTINE(address=0x5F69)
 17: 0x4BD1 [0x01] GOTO 0x4BF4

SUBROUTINE_4BF4:
 18: 0x4BF4 [0x01] GOTO 0x4CAD
 19: 0x4BF7 [0x02] IF !(ExtData[1]->WorkLocal[73] == 1*) GOTO 0x4C3B
 20: 0x4BFF [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 21: 0x4C0E [0x1D] PRINT_EVENT_MESSAGE(message_id=8291*)
    → "What was the average winning percentage for adventurers in the previous Ambuscade (November 10, 2018, to December 11, 2018, Earth time) across all difficulty levels (including Intense)?\u007F1\u0000\u0007"
 22: 0x4C11 [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x4C12 [0x71] USER_INPUT_HANDLER: Open numerical input dialog (work=1*)
 24: 0x4C16 [0x71] USER_INPUT_HANDLER: Process numerical input A (work=ExtData[1]->WorkLocal[30])
 25: 0x4C1A [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 26: 0x4C27 [0x02] IF !(ExtData[1]->WorkLocal[74] == ExtData[1]->WorkLocal[30]) GOTO 0x4C35
 27: 0x4C2F [0x1A] CALL_SUBROUTINE(address=0x5F69)
 28: 0x4C32 [0x01] GOTO 0x4C38
 29: 0x4C35 [0x1A] CALL_SUBROUTINE(address=0x5F8A)

SUBROUTINE_4C38:
 30: 0x4C38 [0x01] GOTO 0x4CAD
 31: 0x4C3B [0x02] IF !(ExtData[1]->WorkLocal[73] == 2*) GOTO 0x4CAD
 32: 0x4C43 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 33: 0x4C52 [0x1D] PRINT_EVENT_MESSAGE(message_id=8292*)
    → "Where did I wish to be dispatched to?\u007F1\u0000\u0007"
 34: 0x4C55 [0x23] WAIT_FOR_DIALOG_INTERACTION
 35: 0x4C56 [0x71] USER_INPUT_HANDLER: Menu operation with params (params=[0x8000, 0x8031])
 36: 0x4C5C [0x71] USER_INPUT_HANDLER: Menu operation B (param=0x0000)
 37: 0x4C60 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 38: 0x4C6D [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 65756e6f00000000000000000000008a) != 0) GOTO 0x4C // Also sets 0x4A00
 39: 0x4C84 [0x1A] CALL_SUBROUTINE(address=0x5F69)
 40: 0x4C87 [0x01] GOTO 0x4CAA

SUBROUTINE_4CAA:
 41: 0x4CAA [0x01] GOTO 0x4CAD

SUBROUTINE_4CAD:
 42: 0x4CAD [0x1C] WAIT(60* ticks)
 43: 0x4CB0 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "ghn1" with entities [EventEntity, EventEntity], work=41*
 44: 0x4CBF [0x1D] PRINT_EVENT_MESSAGE(message_id=8237*)
    → "Um, you see...\u007F1\u0000\u0007"
 45: 0x4CC2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 46: 0x4CC3 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "ghn1" with entities [EventEntity, EventEntity]
 47: 0x4CD0 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
 48: 0x4CDF [0x1D] PRINT_EVENT_MESSAGE(message_id=8238*)
    → "This letter comes from the greataru mage Abdhaljs himself.\u007F1\u0000\u0007"
 49: 0x4CE2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 50: 0x4CE3 [0x1D] PRINT_EVENT_MESSAGE(message_id=8239*)
    → "Here, you may feel free to give it a read-wead.\u007F1\u0000\u0007"
 51: 0x4CE6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 52: 0x4CE7 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
 53: 0x4CF4 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=40*
 54: 0x4D03 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk1" with entities [EventEntity, EventEntity]
 55: 0x4D10 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=40*
 56: 0x4D1F [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 57: 0x4D2C [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 58: 0x4D31 [0x02] IF !(ExtData[1]->WorkLocal[30] > 4*) GOTO 0x4DB9
 59: 0x4D39 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 60: 0x4D3C [0x23] WAIT_FOR_DIALOG_INTERACTION
 61: 0x4D3D [0x48] [System] [8295*]:
    → "\u00072Mommy Dearest,\u0007How have you been? I have been doing quite well.\u007F1\u0000\u0007"
 62: 0x4D40 [0x23] WAIT_FOR_DIALOG_INTERACTION
 63: 0x4D41 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 64: 0x4D46 [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4D7D
 65: 0x4D4E [0x03] Work_Zone[2] = 6458*
 66: 0x4D53 [0x48] [System] [8296*]:
    → "\u00072Have you ever heard of \u001E\u0005soy ramen\u001E\u0001? An adventurer in the Ambuscade was eating it. I asked Rycharde and apparently it's a dish from the Far East.\u007F1\u0000\u0007"
 67: 0x4D56 [0x23] WAIT_FOR_DIALOG_INTERACTION
 68: 0x4D57 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 69: 0x4D5C [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4D7D
 70: 0x4D64 [0x48] [System] [8297*]:
    → "\u00072I've become a pretty good cook-wook, so it's got my interest piqued. I'll make it for you if I can get all of the ingredients together.\u007F1\u0000\u0007"
 71: 0x4D67 [0x23] WAIT_FOR_DIALOG_INTERACTION
 72: 0x4D68 [0x13] ExtData[1]->WorkLocal[30] = rand() % 99*
 73: 0x4D6D [0x02] IF !(ExtData[1]->WorkLocal[30] > 49*) GOTO 0x4D7D
 74: 0x4D75 [0x48] [System] [8298*]:
    → "\u00072P.S.\u0007While it's fun answering quiz questions-wuestions, I also like thinking up new ones!\u00073\u007F1\u0000\u0007"
 75: 0x4D78 [0x23] WAIT_FOR_DIALOG_INTERACTION
 76: 0x4D79 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 77: 0x4D7C [0x23] WAIT_FOR_DIALOG_INTERACTION
 78: 0x4D7D [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "zit0" with entities [EventEntity, EventEntity], work=40*
 79: 0x4D8C [0x1D] PRINT_EVENT_MESSAGE(message_id=8215*)
    → "Wh-wh-what!? G-give that back!\u007F6\u0001\u0007Here! Here's the right one!\u007F1\u0000\u0007"
 80: 0x4D8F [0x23] WAIT_FOR_DIALOG_INTERACTION
 81: 0x4D90 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "zit0" with entities [EventEntity, EventEntity]
 82: 0x4D9D [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "pas0" with entities [EventEntity, EventEntity], work=40*
 83: 0x4DAC [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "pas0" with entities [EventEntity, EventEntity]
 84: 0x4DB9 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
 85: 0x4DBC [0x23] WAIT_FOR_DIALOG_INTERACTION
 86: 0x4DBD [0x48] [System] [8293*]:
    → "\u00072Dearest adventurer,\u0007Once again, allow me to get straight to the point.\u007F1\u0000\u0007"
 87: 0x4DC0 [0x23] WAIT_FOR_DIALOG_INTERACTION
 88: 0x4DC1 [0x03] Work_Zone[2] = 21517*
 89: 0x4DC6 [0x03] Work_Zone[3] = 9784*
 90: 0x4DCB [0x48] [System] [8294*]:
    → "\u00072The \u0001\u0005%\u0002\u0000\u0000\u0000 and similar items I mentioned in a previous communique are finally able to be reforged. I have invented a new type of material, dubbed \u00072\u0001\u0005%\u0002\u0001\u0000\u0000,\u00073 specifically for this purpose.\u007F1\u0000\u0007"
 91: 0x4DCE [0x23] WAIT_FOR_DIALOG_INTERACTION
 92: 0x4DCF [0x03] Work_Zone[2] = 21517*
 93: 0x4DD4 [0x48] [System] [8283*]:
    → "\u00072I am loath to admit that the exact workings of this new material are a trade secret, but I hope you will indulge me and content yourself in knowing that they serve as excellent catalysts for improving \u0001\u0005%\u0002\u0000\u0000\u0000 and similar items. I say \u00072catalysts\u00073 in the plural because more than one is needed.\u007F1\u0000\u0007"
 94: 0x4DD7 [0x23] WAIT_FOR_DIALOG_INTERACTION
 95: 0x4DD8 [0x48] [System] [8284*]:
    → "\u00072I bid you not to fret--this is not the final shape that these weapons will take, but I need more detailed data before I am able to complete my research.\u007F1\u0000\u0007"
 96: 0x4DDB [0x23] WAIT_FOR_DIALOG_INTERACTION
 97: 0x4DDC [0x48] [System] [8244*]:
    → "\u00072I have left the details with my representative at the A.M.A.N. Please check with him for more information.\u007F1\u0000\u0007"
 98: 0x4DDF [0x23] WAIT_FOR_DIALOG_INTERACTION
 99: 0x4DE0 [0x03] Work_Zone[2] = 9784*
100: 0x4DE5 [0x48] [System] [8268*]:
    → "\u00072Simply deliver the requisite quantity of \u0001\u0005%\u0002\u0000\u0000\u0000 and your weapon of choice to my compatriot at the A.M.A.N., and he will perform the necessary procedure to help unlock the item's latent powers. Do be sure to try it out, and evaluate for yourself its true potential.\u00073\u007F1\u0000\u0007"
101: 0x4DE8 [0x23] WAIT_FOR_DIALOG_INTERACTION
102: 0x4DE9 [0x48] [System] [8216*]:
    → "\u007F6\u0001\u007F1\u0000\u0007"
103: 0x4DEC [0x23] WAIT_FOR_DIALOG_INTERACTION
104: 0x4DED [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=40*
105: 0x4DFC [0x1D] PRINT_EVENT_MESSAGE(message_id=8240*)
    → "I look forward to helping you with all of your equipment needs!\u007F1\u0000\u0007"
106: 0x4DFF [0x23] WAIT_FOR_DIALOG_INTERACTION
107: 0x4E00 [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk0" with entities [EventEntity, EventEntity]
108: 0x4E0D [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=40*
109: 0x4E1C [0x53] WAIT_SCHEDULER_TASK: Wait for scheduler "tlk1" with entities [EventEntity, EventEntity]
110: 0x4E29 [0x21] END_EVENT
111: 0x4E2A [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x4BD4 [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 626468616c6a730000000000000000f1) != 0) GOTO 0x4B // Also sets 0x6100
     0x4BEB [0x1A] CALL_SUBROUTINE(address=0x5F69)
     0x4BEE [0x01] GOTO 0x4BF4
     0x4BF1 [0x1A] CALL_SUBROUTINE(address=0x5F8A)
# Dead code (unreachable instructions):
     0x4C8A [0x9D] IF (strcmp(ExtData[1]->WorkLocal[0], 65756e6f0000000000000000000000a7) != 0) GOTO 0x4C // Also sets 0x6A00
     0x4CA1 [0x1A] CALL_SUBROUTINE(address=0x5F69)
     0x4CA4 [0x01] GOTO 0x4CAA
     0x4CA7 [0x1A] CALL_SUBROUTINE(address=0x5F8A)
```