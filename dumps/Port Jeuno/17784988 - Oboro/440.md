# Event 440

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 38/40     |
| Offset          | 0x1761    |
| Data Size       | 521 bytes |
| Calculated Size | 521 bytes |
| Instructions    | 49        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
1760:    03 1C 00 02 10 03 1D  00 03 10 03 1E 00 04 10   ...............
1770: 03 0C 00 05 10 03 0A 00  06 10 03 1F 00 07 10 03  ................
1780: 20 00 03 80 42 1E F0 FF  FF 7F 1C 00 80 03 01 00   ...B...........
1790: 03 80 03 0D 00 03 80 02  1F 00 03 80 00 DF 17 1D  ................
17A0: E7 80 23 1D E8 80 23 24  E9 80 03 80 03 80 25 02  ..#...#$......%.
17B0: 00 10 03 80 00 C3 17 1D  EA 80 23 03 20 00 00 80  ..........#. ...
17C0: 01 DC 17 02 00 10 00 80  00 DC 17 03 20 00 03 80  ............ ...
17D0: 1D 27 80 23 03 01 10 03  80 01 DC 17 01 E4 17 03  .'.#............
17E0: 20 00 00 80 02 20 00 03  80 00 F2 17 2E 21 00 01   .... .......!..
17F0: 67 19 03 02 10 0C 00 03  03 10 1F 00 1D EB 80 23  g..............#
1800: 02 0A 00 03 80 00 0F 18  1D EC 80 23 01 1D 18 3C  ...........#...<
1810: 0D 00 00 80 00 80 3C 0D  00 1B 80 00 80 02 0A 00  ......<.........
1820: 03 80 00 67 18 03 01 10  00 80 43 00 43 01 D4 05  ...g......C.C...
1830: 03 80 05 10 02 10 03 10  04 10 03 01 10 1B 80 43  ...............C
1840: 00 43 01 D4 05 00 80 05  10 02 10 03 10 04 10 03  .C..............
1850: 01 10 26 80 43 00 43 01  D4 05 1B 80 05 10 02 10  ..&.C.C.........
1860: 03 10 04 10 01 7C 18 03  01 10 00 80 43 00 43 01  .....|......C.C.
1870: D4 04 03 80 05 10 02 10  03 10 04 10 48 ED 80 D4  ............H...
1880: 02 EE 80 01 00 0D 00 25  02 00 10 03 80 00 CD 18  .......%........
1890: 03 01 00 00 10 48 EF 80  24 F0 80 00 80 03 80 25  .....H..$......%
18A0: 02 00 10 03 80 00 BC 18  1D A0 80 23 1D A1 80 23  ...........#...#
18B0: 1D A2 80 23 03 01 10 1B  80 01 CA 18 02 00 10 00  ...#............
18C0: 80 00 CA 18 01 1D 18 01  CA 18 01 67 19 02 00 10  ...........g....
18D0: 00 80 00 12 19 03 01 00  00 10 48 EF 80 24 F0 80  ..........H..$..
18E0: 00 80 03 80 25 02 00 10  03 80 00 01 19 1D A0 80  ....%...........
18F0: 23 1D A1 80 23 1D A2 80  23 03 01 10 26 80 01 0F  #...#...#...&...
1900: 19 02 00 10 00 80 00 0F  19 01 1D 18 01 0F 19 01  ................
1910: 67 19 02 00 10 1B 80 00  57 19 03 01 00 00 10 48  g.......W......H
1920: EF 80 24 F0 80 00 80 03  80 25 02 00 10 03 80 00  ..$......%......
1930: 46 19 1D A0 80 23 1D A1  80 23 1D A2 80 23 03 01  F....#...#...#..
1940: 10 2C 80 01 54 19 02 00  10 00 80 00 54 19 01 1D  .,..T.......T...
1950: 18 01 54 19 01 67 19 02  00 10 26 80 00 67 19 03  ..T..g....&..g..
1960: 01 10 00 80 01 67 19 2E  21 00                    .....g..!.      
```

## Opcodes

```
  0: 0x1761 [0x03] ExtData[1]->WorkLocal[28] = Work_Zone[2]
  1: 0x1766 [0x03] ExtData[1]->WorkLocal[29] = Work_Zone[3]
  2: 0x176B [0x03] ExtData[1]->WorkLocal[30] = Work_Zone[4]
  3: 0x1770 [0x03] ExtData[1]->WorkLocal[12] = Work_Zone[5]
  4: 0x1775 [0x03] ExtData[1]->WorkLocal[10] = Work_Zone[6]
  5: 0x177A [0x03] ExtData[1]->WorkLocal[31] = Work_Zone[7]
  6: 0x177F [0x03] ExtData[1]->WorkLocal[32] = 0*
  7: 0x1784 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  8: 0x1785 [0x1E] EventEntity looks at LocalPlayer and starts talking
  9: 0x178A [0x1C] WAIT(1* ticks)
 10: 0x178D [0x03] ExtData[1]->WorkLocal[1] = 0*
 11: 0x1792 [0x03] ExtData[1]->WorkLocal[13] = 0*
 12: 0x1797 [0x02] IF !(ExtData[1]->WorkLocal[31] == 0*) GOTO 0x17DF
 13: 0x179F [0x1D] PRINT_EVENT_MESSAGE(message_id=8978*)
    → "Hm? What's that? Did you do that yourself? It looks like it's been altered somehow...\u007F1\u0000\u0007"
 14: 0x17A2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 15: 0x17A3 [0x1D] PRINT_EVENT_MESSAGE(message_id=8979*)
    → "If I only knew more about it, I might be able to help... Would you mind telling me what you did?\u007F1\u0000\u0007"
 16: 0x17A6 [0x23] WAIT_FOR_DIALOG_INTERACTION
 17: 0x17A7 [0x24] CREATE_DIALOG(message_id=8980*, default_option=0*, option_flags=0*)
    → "What will you do?\u0007\u000BTell him about the shrouded world.\u0007Stay quiet.\u007F1\u0000\u0007"
 18: 0x17AE [0x25] WAIT_DIALOG_SELECT()
 19: 0x17AF [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x17C3
 20: 0x17B7 [0x1D] PRINT_EVENT_MESSAGE(message_id=8981*)
    → "An hourglass? A dreamlike world shrouded in fog? Hmm... I might be able to do something with this, but not in its current state...\u007F1\u0000\u0007"
 21: 0x17BA [0x23] WAIT_FOR_DIALOG_INTERACTION
 22: 0x17BB [0x03] ExtData[1]->WorkLocal[32] = 1*
 23: 0x17C0 [0x01] GOTO 0x17DC
 24: 0x17C3 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x17DC
 25: 0x17CB [0x03] ExtData[1]->WorkLocal[32] = 0*
 26: 0x17D0 [0x1D] PRINT_EVENT_MESSAGE(message_id=8874*)
    → "...Hmph.\u0007Be that as it may, you will come crawling back for my services sooner or later.\u007F1\u0000\u0007"
 27: 0x17D3 [0x23] WAIT_FOR_DIALOG_INTERACTION
 28: 0x17D4 [0x03] Work_Zone[1] = 0*
 29: 0x17D9 [0x01] GOTO 0x17DC

SUBROUTINE_17DC:
 30: 0x17DC [0x01] GOTO 0x17E4
 31: 0x17DF [0x03] ExtData[1]->WorkLocal[32] = 1*

SUBROUTINE_17E4:
 32: 0x17E4 [0x02] IF !(ExtData[1]->WorkLocal[32] == 0*) GOTO 0x17F2
 33: 0x17EC [0x2E] SET_CLI_EVENT_CANCEL_FLAGS()
 34: 0x17ED [0x21] END_EVENT
 35: 0x17EE [0x00] END_REQSTACK()

SUBROUTINE_181D:
 36: 0x181D [0x02] IF !(ExtData[1]->WorkLocal[10] == 0*) GOTO 0x1867
 37: 0x1825 [0x03] Work_Zone[1] = 1*
 38: 0x182A [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 39: 0x182C [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 40: 0x182E [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration B (buffer=[03 80 05 10 02 10 03 10...])
 41: 0x184C [0x10] Work_Zone[4] <<= 0x0103
 42: 0x1851 [0x10] 3* <<= ExtData[1]->WorkLocal[67]
 43: 0x1856 [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 44: 0x1858 [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration B (buffer=[1B 80 05 10 02 10 03 10...])
 45: 0x1876 [0x02] IF !(0x0310 == 0x0410) GOTO 0xED48
 46: 0x187E [0x80] LOAD_WAIT(entity=Unknown NPC (ID: 2163081940/0x80EE02D4))
 47: 0x1883 [0x01] GOTO 0x0D00
 48: 0x1886 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x17EF [0x01] GOTO 0x1967
# Dead code (unreachable instructions):
     0x1887 [0x25] WAIT_DIALOG_SELECT()
     0x1888 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x18CD
     0x1890 [0x03] ExtData[1]->WorkLocal[1] = Work_Zone[0]
     0x1895 [0x48] [System] [9001*]:
    → "\u001F{You will be unable to auction this equipment if you augment it!\u0000\u0007"
     0x1898 [0x24] CREATE_DIALOG(message_id=8985*, default_option=1*, option_flags=0*)
    → "Are you sure?\u0007\u000BYes.\u0007On second thought...\u007F1\u0000\u0007"
     0x189F [0x25] WAIT_DIALOG_SELECT()
     0x18A0 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x18BC
     0x18A8 [0x1D] PRINT_EVENT_MESSAGE(message_id=8986*)
    → "It may be a strange way of phrasing it, but it feels as if it's \u00072alive\u00073 somehow...\u007F1\u0000\u0007"
     0x18AB [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18AC [0x1D] PRINT_EVENT_MESSAGE(message_id=8987*)
    → "If you equip it in that world, I daresay it should give things a nice boost.\u007F1\u0000\u0007"
     0x18AF [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18B0 [0x1D] PRINT_EVENT_MESSAGE(message_id=8988*)
    → "Of course, you can upgrade your equipment in this world, too...provided you have a certain something. Should you find that something, pray bring it to me.\u007F1\u0000\u0007"
     0x18B3 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18B4 [0x03] Work_Zone[1] = 2*
     0x18B9 [0x01] GOTO 0x18CA
     0x18BC [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x18CA
     0x18C4 [0x01] GOTO 0x181D
     0x18C7 [0x01] GOTO 0x18CA
     0x18CA [0x01] GOTO 0x1967
     0x18CD [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x1912
     0x18D5 [0x03] ExtData[1]->WorkLocal[1] = Work_Zone[0]
     0x18DA [0x48] [System] [9001*]:
    → "\u001F{You will be unable to auction this equipment if you augment it!\u0000\u0007"
     0x18DD [0x24] CREATE_DIALOG(message_id=8985*, default_option=1*, option_flags=0*)
    → "Are you sure?\u0007\u000BYes.\u0007On second thought...\u007F1\u0000\u0007"
     0x18E4 [0x25] WAIT_DIALOG_SELECT()
     0x18E5 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x1901
     0x18ED [0x1D] PRINT_EVENT_MESSAGE(message_id=8986*)
    → "It may be a strange way of phrasing it, but it feels as if it's \u00072alive\u00073 somehow...\u007F1\u0000\u0007"
     0x18F0 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18F1 [0x1D] PRINT_EVENT_MESSAGE(message_id=8987*)
    → "If you equip it in that world, I daresay it should give things a nice boost.\u007F1\u0000\u0007"
     0x18F4 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18F5 [0x1D] PRINT_EVENT_MESSAGE(message_id=8988*)
    → "Of course, you can upgrade your equipment in this world, too...provided you have a certain something. Should you find that something, pray bring it to me.\u007F1\u0000\u0007"
     0x18F8 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x18F9 [0x03] Work_Zone[1] = 3*
     0x18FE [0x01] GOTO 0x190F
     0x1901 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x190F
     0x1909 [0x01] GOTO 0x181D
     0x190C [0x01] GOTO 0x190F
     0x190F [0x01] GOTO 0x1967
     0x1912 [0x02] IF !(Work_Zone[0] == 2*) GOTO 0x1957
     0x191A [0x03] ExtData[1]->WorkLocal[1] = Work_Zone[0]
     0x191F [0x48] [System] [9001*]:
    → "\u001F{You will be unable to auction this equipment if you augment it!\u0000\u0007"
     0x1922 [0x24] CREATE_DIALOG(message_id=8985*, default_option=1*, option_flags=0*)
    → "Are you sure?\u0007\u000BYes.\u0007On second thought...\u007F1\u0000\u0007"
     0x1929 [0x25] WAIT_DIALOG_SELECT()
     0x192A [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x1946
     0x1932 [0x1D] PRINT_EVENT_MESSAGE(message_id=8986*)
    → "It may be a strange way of phrasing it, but it feels as if it's \u00072alive\u00073 somehow...\u007F1\u0000\u0007"
     0x1935 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x1936 [0x1D] PRINT_EVENT_MESSAGE(message_id=8987*)
    → "If you equip it in that world, I daresay it should give things a nice boost.\u007F1\u0000\u0007"
     0x1939 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x193A [0x1D] PRINT_EVENT_MESSAGE(message_id=8988*)
    → "Of course, you can upgrade your equipment in this world, too...provided you have a certain something. Should you find that something, pray bring it to me.\u007F1\u0000\u0007"
     0x193D [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x193E [0x03] Work_Zone[1] = 4*
     0x1943 [0x01] GOTO 0x1954
     0x1946 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x1954
     0x194E [0x01] GOTO 0x181D
     0x1951 [0x01] GOTO 0x1954
     0x1954 [0x01] GOTO 0x1967
     0x1957 [0x02] IF !(Work_Zone[0] == 3*) GOTO 0x1967
     0x195F [0x03] Work_Zone[1] = 1*
     0x1964 [0x01] GOTO 0x1967
     0x1967 [0x2E] SET_CLI_EVENT_CANCEL_FLAGS()
     0x1968 [0x21] END_EVENT
     0x1969 [0x00] END_REQSTACK()
```