# Event 4

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 7/7       |
| Offset          | 0x003A    |
| Data Size       | 100 bytes |
| Calculated Size | 100 bytes |
| Instructions    | 28        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0030:                                42 1E F0 FF FF 7F            B.....
0040: 6F 76 F8 FF FF 7F 1D 02  80 23 1D 04 80 23 48 05  ov.......#...#H.
0050: 80 1C 06 80 03 01 10 07  80 43 00 43 01 48 08 80  .........C.C.H..
0060: 23 24 09 80 07 80 0A 80  25 02 00 10 07 80 00 7C  #$......%......|
0070: 00 03 01 10 0B 80 01 9C  00 01 7C 00 24 0C 80 07  ..........|.$...
0080: 80 0A 80 25 02 00 10 07  80 00 97 00 03 01 10 0B  ...%............
0090: 80 01 9C 00 01 97 00 03  01 10 07 80 21 00        ............!.  
```

## Opcodes

```
  0: 0x003A [0x42] SET_CLI_EVENT_CANCEL_DATA()
  1: 0x003B [0x1E] EventEntity looks at LocalPlayer and starts talking
  2: 0x0040 [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
  3: 0x0041 [0x76] CHECK_ENTITY_RENDER_FLAGS: Wait until EventEntity Render.Flags0 and Render.Flags3 conditions are met
  4: 0x0046 [0x1D] PRINT_EVENT_MESSAGE(message_id=12029*)
    → "I see you're working for another nation.\u007F1\u0000\u0007"
  5: 0x0049 [0x23] WAIT_FOR_DIALOG_INTERACTION
  6: 0x004A [0x1D] PRINT_EVENT_MESSAGE(message_id=12035*)
    → "Though if you want to rejoin the fourth, I think something can be worked out. You have some Allied Notes, don't you?\u007F1\u0000\u0007"
  7: 0x004D [0x23] WAIT_FOR_DIALOG_INTERACTION
  8: 0x004E [0x48] [System] [12037*]:
    → "\u001FyPlease note that upon changing allegiance, you will be required to return the two most prestigious campaign medals you possess. There is no penalty if you have yet to earn any medals.\u007F1\u0000\u0007"
  9: 0x0051 [0x1C] WAIT(120* ticks)
 10: 0x0054 [0x03] Work_Zone[1] = 1*
 11: 0x0059 [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 12: 0x005B [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 13: 0x005D [0x48] [System] [12039*]:
    → "Exchange 
\u0002 Allied \u007F\u0012\u0002[Note/Notes] to transfer from \u000C\u0000[/the Knights of the Iron Ram/the Fourth Division/the Cobra Unit] to \u000C\u0001[/the Knights of the Iron Ram/the Fourth Division/the Cobra Unit]? You currently possess 
\u0003 \u007F\u0012\u0003[Allied Note/Allied Notes].\u007F1\u0000\u0007"
 14: 0x0060 [0x23] WAIT_FOR_DIALOG_INTERACTION
 15: 0x0061 [0x24] CREATE_DIALOG(message_id=12040*, default_option=1*, option_flags=0*)
    → "Proceed with the transaction?\u0007\u000BYes.\u0007No.\u007F1\u0000\u0007"
 16: 0x0068 [0x25] WAIT_DIALOG_SELECT()
 17: 0x0069 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x007C
 18: 0x0071 [0x03] Work_Zone[1] = 1073741824*
 19: 0x0076 [0x01] GOTO 0x009C

SUBROUTINE_007C:
 20: 0x007C [0x24] CREATE_DIALOG(message_id=12041*, default_option=1*, option_flags=0*)
    → "Are you absolutely sure?\u0007\u000BYes.\u0007No.\u007F1\u0000\u0007"
 21: 0x0083 [0x25] WAIT_DIALOG_SELECT()
 22: 0x0084 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x0097
 23: 0x008C [0x03] Work_Zone[1] = 1073741824*
 24: 0x0091 [0x01] GOTO 0x009C

SUBROUTINE_0097:
 25: 0x0097 [0x03] Work_Zone[1] = 1*

SUBROUTINE_009C:
 26: 0x009C [0x21] END_EVENT
 27: 0x009D [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x0079 [0x01] GOTO 0x007C
# Dead code (unreachable instructions):
     0x0094 [0x01] GOTO 0x0097
```