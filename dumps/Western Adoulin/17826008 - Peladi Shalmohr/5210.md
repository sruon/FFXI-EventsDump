# Event 5210

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 20/25     |
| Offset          | 0x16C7    |
| Data Size       | 851 bytes |
| Calculated Size | 851 bytes |
| Instructions    | 83        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
16C0:                      03  03 00 02 10 02 03 00 97         .........
16D0: 80 00 DD 16 42 03 04 00  03 10 01 E0 16 06 04 00  ....B...........
16E0: 03 05 00 04 10 03 06 00  05 10 1E F0 FF FF 7F 6F  ...............o
16F0: 70 02 02 10 01 80 80 46  19 66 27 80 F8 FF FF 7F  p......F.f'.....
1700: F8 FF FF 7F 74 6C 6B 30  1D 98 80 23 03 02 10 99  ....tlk0...#....
1710: 80 1D 9A 80 23 1D 9B 80  23 66 27 80 F8 FF FF 7F  ....#...#f'.....
1720: F8 FF FF 7F 74 6C 6B 31  06 02 00 03 02 10 9C 80  ....tlk1........
1730: 03 03 10 9D 80 03 04 10  9E 80 03 05 10 9F 80 D4  ................
1740: 03 03 80 02 10 D4 03 37  80 03 10 D4 03 A0 80 04  .......7........
1750: 10 D4 03 97 80 05 10 D4  02 A1 80 02 00 04 00 25  ...............%
1760: 02 00 10 01 80 00 72 17  03 01 10 00 10 21 00 01  ......r......!..
1770: B2 17 02 00 10 03 80 00  82 17 03 02 10 9C 80 01  ................
1780: B2 17 02 00 10 37 80 00  92 17 03 02 10 9D 80 01  .....7..........
1790: B2 17 02 00 10 A0 80 00  A2 17 03 02 10 9E 80 01  ................
17A0: B2 17 02 00 10 97 80 00  B2 17 03 02 10 9F 80 01  ................
17B0: B2 17 03 01 10 00 10 03  02 00 00 10 02 03 00 01  ................
17C0: 80 80 40 18 D4 03 01 80  02 10 D4 03 03 80 02 10  ..@.............
17D0: 66 27 80 F8 FF FF 7F F8  FF FF 7F 74 6C 6B 30 1D  f'.........tlk0.
17E0: A2 80 23 66 27 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  ..#f'.........tl
17F0: 6B 31 D4 02 A3 80 03 80  01 80 25 02 00 10 01 80  k1........%.....
1800: 00 2C 18 93 01 80 42 66  27 80 F8 FF FF 7F F8 FF  .,....Bf'.......
1810: FF 7F 74 6C 6B 30 1D A4  80 23 66 27 80 F8 FF FF  ..tlk0...#f'....
1820: 7F F8 FF FF 7F 74 6C 6B  31 01 3D 18 02 00 10 03  .....tlk1.=.....
1830: 80 00 3D 18 93 01 80 01  2B 17 01 3D 18 01 43 19  ..=.....+..=..C.
1840: 02 03 00 A0 80 80 AE 18  D4 03 01 80 02 10 D4 03  ................
1850: 03 80 02 10 D4 02 A3 80  03 80 01 80 25 02 00 10  ............%...
1860: 01 80 00 9A 18 93 01 80  02 05 00 A5 80 03 97 18  ................
1870: 66 27 80 F8 FF FF 7F F8  FF FF 7F 74 6C 6B 30 1D  f'.........tlk0.
1880: A6 80 23 66 27 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  ..#f'.........tl
1890: 6B 31 03 01 10 01 80 01  AB 18 02 00 10 03 80 00  k1..............
18A0: AB 18 93 01 80 01 2B 17  01 AB 18 01 43 19 02 03  ......+.....C...
18B0: 00 97 80 80 43 19 D4 03  01 80 02 10 D4 03 03 80  ....C...........
18C0: 02 10 03 03 10 99 80 66  27 80 F8 FF FF 7F F8 FF  .......f'.......
18D0: FF 7F 74 6C 6B 30 1D A7  80 23 66 27 80 F8 FF FF  ..tlk0...#f'....
18E0: 7F F8 FF FF 7F 74 6C 6B  31 D4 02 A3 80 03 80 01  .....tlk1.......
18F0: 80 25 02 00 10 01 80 00  2F 19 93 01 80 02 05 00  .%....../.......
1900: 99 80 03 2C 19 66 27 80  F8 FF FF 7F F8 FF FF 7F  ...,.f'.........
1910: 74 6C 6B 30 1D A6 80 23  66 27 80 F8 FF FF 7F F8  tlk0...#f'......
1920: FF FF 7F 74 6C 6B 31 03  01 10 01 80 01 40 19 02  ...tlk1......@..
1930: 00 10 03 80 00 40 19 93  01 80 01 2B 17 01 40 19  .....@.....+..@.
1940: 01 43 19 01 18 1A 02 02  10 03 80 80 78 19 03 02  .C..........x...
1950: 10 06 00 66 27 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  ...f'.........tl
1960: 6B 30 1D A8 80 23 66 27  80 F8 FF FF 7F F8 FF FF  k0...#f'........
1970: 7F 74 6C 6B 31 01 18 1A  02 02 10 37 80 80 A5 19  .tlk1......7....
1980: 66 27 80 F8 FF FF 7F F8  FF FF 7F 74 6C 6B 30 1D  f'.........tlk0.
1990: A9 80 23 66 27 80 F8 FF  FF 7F F8 FF FF 7F 74 6C  ..#f'.........tl
19A0: 6B 31 01 18 1A 02 02 10  A0 80 80 E5 19 66 27 80  k1...........f'.
19B0: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 30 1D AA 80 23  ........tlk0...#
19C0: 1D AB 80 23 03 02 10 A5  80 1D AC 80 23 66 27 80  ...#........#f'.
19D0: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 31 06 02 00 01  ........tlk1....
19E0: 2B 17 01 18 1A 02 02 10  97 80 80 18 1A 66 27 80  +............f'.
19F0: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 30 1D AD 80 23  ........tlk0...#
1A00: 66 27 80 F8 FF FF 7F F8  FF FF 7F 74 6C 6B 31 06  f'.........tlk1.
1A10: 02 00 01 2B 17 01 18 1A  21 00                    ...+....!.      
```

## Opcodes

```
  0: 0x16C7 [0x03] ExtData[1]->WorkLocal[3] = Work_Zone[2]
  1: 0x16CC [0x02] IF !(ExtData[1]->WorkLocal[3] == 4*) GOTO 0x16DD
  2: 0x16D4 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  3: 0x16D5 [0x03] ExtData[1]->WorkLocal[4] = Work_Zone[3]
  4: 0x16DA [0x01] GOTO 0x16E0
  5: 0x16DD [0x06] ExtData[1]->WorkLocal[4] = 0
  6: 0x16E0 [0x03] ExtData[1]->WorkLocal[5] = Work_Zone[4]
  7: 0x16E5 [0x03] ExtData[1]->WorkLocal[6] = Work_Zone[5]
  8: 0x16EA [0x1E] EventEntity looks at LocalPlayer and starts talking
  9: 0x16EF [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
 10: 0x16F0 [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
 11: 0x16F1 [0x02] IF !(Work_Zone[2] == 0*) GOTO 0x1946
 12: 0x16F9 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=59*
 13: 0x1708 [0x1D] PRINT_EVENT_MESSAGE(message_id=10713*)
    → "<Sigh> You're undoubtedly herrre for your Mummers' Coalition signet, so I'll give you a choice of four.\u007F1\u0000\u0007"
 14: 0x170B [0x23] WAIT_FOR_DIALOG_INTERACTION
 15: 0x170C [0x03] Work_Zone[2] = 10000*
 16: 0x1711 [0x1D] PRINT_EVENT_MESSAGE(message_id=10714*)
    → "Choose wisely, as if you want anotherrr one I'll charge you a handling fee of 
\u0000 bayld.\u007F1\u0000\u0007"
 17: 0x1714 [0x23] WAIT_FOR_DIALOG_INTERACTION
 18: 0x1715 [0x1D] PRINT_EVENT_MESSAGE(message_id=10715*)
    → "But such precious signets take a fair bit of time to fashion, so you may need to wait a tad in between trrransactions.\u007F1\u0000\u0007"
 19: 0x1718 [0x23] WAIT_FOR_DIALOG_INTERACTION
 20: 0x1719 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 21: 0x1728 [0x06] ExtData[1]->WorkLocal[2] = 0
 22: 0x172B [0x03] Work_Zone[2] = 27527*
 23: 0x1730 [0x03] Work_Zone[3] = 27528*
 24: 0x1735 [0x03] Work_Zone[4] = 27529*
 25: 0x173A [0x03] Work_Zone[5] = 27530*
 26: 0x173F [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration A (buffer=[03 80 02 10 D4 03 37 80...])
 27: 0x175D [0x04] DEPRECATED_NOP(unused=0x2500)
 28: 0x1760 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x1772
 29: 0x1768 [0x03] Work_Zone[1] = Work_Zone[0]
 30: 0x176D [0x21] END_EVENT
 31: 0x176E [0x00] END_REQSTACK()

SUBROUTINE_17B2:
 32: 0x17B2 [0x03] Work_Zone[1] = Work_Zone[0]
 33: 0x17B7 [0x03] ExtData[1]->WorkLocal[2] = Work_Zone[0]
 34: 0x17BC [0x02] IF !(ExtData[1]->WorkLocal[3] == 0*) GOTO 0x1840
 35: 0x17C4 [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration A (buffer=[01 80 02 10 D4 03 03 80...])
 36: 0x17E2 [0x23] WAIT_FOR_DIALOG_INTERACTION
 37: 0x17E3 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 38: 0x17F2 [0xD4] MAP_QUERY_WINDOW: Test and open query window (flag=0xA3, work=[0x0380, 0x0180, 0x2580])
 39: 0x17FB [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x182C
 40: 0x1803 [0x93] DISPLAY_ITEM_INFO(item_id=0*)
 41: 0x1806 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 42: 0x1807 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=59*
 43: 0x1816 [0x1D] PRINT_EVENT_MESSAGE(message_id=10719*)
    → "Listen carefully. This is a prrrized artifact of the Order of Thurandaut. Losing it could be considered a grievous breach of contract.\u007F1\u0000\u0007"
 44: 0x1819 [0x23] WAIT_FOR_DIALOG_INTERACTION
 45: 0x181A [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 46: 0x1829 [0x01] GOTO 0x183D
 47: 0x182C [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x183D
 48: 0x1834 [0x93] DISPLAY_ITEM_INFO(item_id=0*)
 49: 0x1837 [0x01] GOTO 0x172B

SUBROUTINE_183D:
 50: 0x183D [0x01] GOTO 0x1943
 51: 0x1840 [0x02] IF !(ExtData[1]->WorkLocal[3] == 3*) GOTO 0x18AE
 52: 0x1848 [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration A (buffer=[01 80 02 10 D4 03 03 80...])
 53: 0x1866 [0x01] GOTO 0x0280

SUBROUTINE_1940:
 54: 0x1940 [0x01] GOTO 0x1943

SUBROUTINE_1943:
 55: 0x1943 [0x01] GOTO 0x1A18
 56: 0x1946 [0x02] IF !(Work_Zone[2] == 1*) GOTO 0x1978
 57: 0x194E [0x03] Work_Zone[2] = ExtData[1]->WorkLocal[6]
 58: 0x1953 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=59*
 59: 0x1962 [0x1D] PRINT_EVENT_MESSAGE(message_id=10727*)
    → "And what do you want? You've gotta wait a little while to exchange your signet.\u000C\u0000[/ And don't tell me you've lost the old one!]\u007F1\u0000\u0007"
 60: 0x1965 [0x23] WAIT_FOR_DIALOG_INTERACTION
 61: 0x1966 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 62: 0x1975 [0x01] GOTO 0x1A18
 63: 0x1978 [0x02] IF !(Work_Zone[2] == 2*) GOTO 0x19A5
 64: 0x1980 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=59*
 65: 0x198F [0x1D] PRINT_EVENT_MESSAGE(message_id=10720*)
    → "Here for a new signet? Well...you'll need to trrrade the old one to me.\u007F1\u0000\u0007"
 66: 0x1992 [0x23] WAIT_FOR_DIALOG_INTERACTION
 67: 0x1993 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 68: 0x19A2 [0x01] GOTO 0x1A18
 69: 0x19A5 [0x02] IF !(Work_Zone[2] == 3*) GOTO 0x19E5
 70: 0x19AD [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=59*
 71: 0x19BC [0x1D] PRINT_EVENT_MESSAGE(message_id=10724*)
    → "Ugh! How could you go about losing your signet!? You're lucky I don't brrring Maester Flaviria out here to give you a tongue-lashing!\u007F1\u0000\u0007"
 72: 0x19BF [0x23] WAIT_FOR_DIALOG_INTERACTION
 73: 0x19C0 [0x1D] PRINT_EVENT_MESSAGE(message_id=10725*)
    → "Normally it would spell the end of your dead-on-the-vine careerrr...\u0007But I'll let it pass--this time.\u007F1\u0000\u0007"
 74: 0x19C3 [0x23] WAIT_FOR_DIALOG_INTERACTION
 75: 0x19C4 [0x03] Work_Zone[2] = 50000*
 76: 0x19C9 [0x1D] PRINT_EVENT_MESSAGE(message_id=10726*)
    → "Don't think I'll give it away for a song and a dance. I'll need a fee of 
\u0000 bayld.\u007F1\u0000\u0007"
 77: 0x19CC [0x23] WAIT_FOR_DIALOG_INTERACTION
 78: 0x19CD [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk1" with entities [EventEntity, EventEntity], work=59*
 79: 0x19DC [0x06] ExtData[1]->WorkLocal[2] = 0
 80: 0x19DF [0x01] GOTO 0x172B

SUBROUTINE_1A18:
 81: 0x1A18 [0x21] END_EVENT
 82: 0x1A19 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x176F [0x01] GOTO 0x17B2
# Dead code (unreachable instructions):
     0x183A [0x01] GOTO 0x183D
# Dead code (unreachable instructions):
     0x1869 [0x05] 0xA500 = 1
     0x186C [0x80] LOAD_WAIT(entity=Unknown NPC (ID: 1712887555/0x66189703))
     0x1871 [0x27] REQ_SET(priority=0x80, entity_id=EventEntity, tag_num=0xF8)
     0x1878 [0xFF] UNKNOWN_0xFF
     0x1879 [0xFF] UNKNOWN_0xFF
     0x187A [0x7F] WAIT_DIALOG_SELECT_ALT()
     0x187B [0x74] EventEntity->Render.Flags1 |= 0x6C
     0x187D [0x6B] STOP_AND_IDLE: Unknown NPC (ID: 2150065699/0x80276623) stops current action and resets to idle (animation=0x80A61D30)
     0x1886 [0xF8] UNKNOWN_0xF8
     0x1887 [0xFF] UNKNOWN_0xFF
     0x1888 [0xFF] UNKNOWN_0xFF
     0x1889 [0x7F] WAIT_DIALOG_SELECT_ALT()
     0x188A [0xF8] UNKNOWN_0xF8
     0x188B [0xFF] UNKNOWN_0xFF
     0x188C [0xFF] UNKNOWN_0xFF
     0x188D [0x7F] WAIT_DIALOG_SELECT_ALT()
     0x188E [0x74] EventEntity->Render.Flags1 |= 0x6C
     0x1890 [0x6B] STOP_AND_IDLE: Unknown NPC (ID: 2869002241/0xAB018001) stops current action and resets to idle (animation=0x10010331)
     0x1899 [0x18] ExtData[1]->WorkLocal[2] = atan2(0x0310, 0x80)
     0x18A0 [0xAB] CallHelperFunction5(0x0193) // Helper function 5
     0x18A4 [0x80] LOAD_WAIT(entity=Unknown NPC (ID: 18295553/0x01172B01))
     0x18A9 [0xAB] CallHelperFunction5(0x4301) // Helper function 5
     0x18AD [0x19] SWAP(0x0302, 0x9700)
     0x192F [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x1940
     0x1937 [0x93] DISPLAY_ITEM_INFO(item_id=0*)
     0x193A [0x01] GOTO 0x172B
     0x193D [0x01] GOTO 0x1940
# Dead code (unreachable instructions):
     0x19E2 [0x01] GOTO 0x1A18
     0x1A15 [0x01] GOTO 0x1A18
```