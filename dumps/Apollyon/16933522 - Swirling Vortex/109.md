# Event 109

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 2/2       |
| Offset          | 0x0001    |
| Data Size       | 470 bytes |
| Calculated Size | 470 bytes |
| Instructions    | 72        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0000:    20 01 03 00 00 00 80  03 01 00 00 80 03 00 00    ..............
0010: 03 10 08 00 00 01 80 3C  01 00 02 80 03 80 24 04  .......<......$.
0020: 80 00 00 01 00 25 02 00  10 00 80 00 36 00 03 01  .....%......6...
0030: 10 01 80 01 A6 00 02 00  10 03 80 00 46 00 03 01  ............F...
0040: 10 05 80 01 A6 00 02 00  10 06 80 00 56 00 03 01  ............V...
0050: 10 07 80 01 A6 00 02 00  10 08 80 00 66 00 03 01  ............f...
0060: 10 09 80 01 A6 00 02 00  10 02 80 00 76 00 03 01  ............v...
0070: 10 0A 80 01 A6 00 02 00  10 0B 80 00 86 00 03 01  ................
0080: 10 03 80 01 A6 00 02 00  10 0C 80 00 96 00 03 01  ................
0090: 10 06 80 01 A6 00 02 00  10 0D 80 00 A6 00 03 01  ................
00A0: 10 00 80 01 A6 00 02 00  10 00 00 00 B6 00 03 01  ................
00B0: 10 0E 80 01 6D 01 02 01  10 00 80 00 C1 00 01 6D  ....m..........m
00C0: 01 42 03 02 00 01 10 03  01 10 0F 80 43 00 43 01  .B..........C.C.
00D0: 03 01 10 02 00 29 01 F0  FF FF 7F 02 02 01 10 03  .....)..........
00E0: 80 80 F3 00 47 00 10 80  11 80 00 80 12 80 47 01  ....G.........G.
00F0: 01 66 01 02 01 10 06 80  80 0A 01 47 00 13 80 11  .f.........G....
0100: 80 00 80 00 80 47 01 01  66 01 02 01 10 01 80 80  .....G..f.......
0110: 21 01 47 00 14 80 15 80  00 80 16 80 47 01 01 66  !.G.........G..f
0120: 01 02 01 10 05 80 80 38  01 47 00 17 80 18 80 00  .......8.G......
0130: 80 19 80 47 01 01 66 01  02 01 10 07 80 80 4F 01  ...G..f.......O.
0140: 47 00 18 80 1A 80 00 80  16 80 47 01 01 66 01 02  G.........G..f..
0150: 01 10 09 80 80 66 01 47  00 1B 80 1C 80 00 80 19  .....f.G........
0160: 80 47 01 01 66 01 29 01  F0 FF FF 7F 03 20 00 21  .G..f.)...... .!
0170: 00 9F 1D 80 F0 FF FF 7F  F0 FF FF 7F 6D 61 69 6E  ............main
0180: 00 80 03 02 00 01 10 03  01 10 0F 80 43 00 43 01  ............C.C.
0190: 03 01 10 02 00 1C 1E 80  45 1F 80 F0 FF FF 7F F0  ........E.......
01A0: FF FF 7F 66 64 6F 31 00  80 1C 20 80 46 01 1B 45  ...fdo1... .F..E
01B0: 1F 80 F0 FF FF 7F F0 FF  FF 7F 66 64 69 31 00 80  ..........fdi1..
01C0: 9F 21 80 F0 FF FF 7F F0  FF FF 7F 6D 61 69 6E 00  .!.........main.
01D0: 80 1C 22 80 46 00 1B                              ..".F..         
```

## Opcodes

```
  0: 0x0001 [0x20] SET_CLI_EVENT_UC_FLAG: Lock player control
  1: 0x0003 [0x03] ExtData[1]->WorkLocal[0] = 0*
  2: 0x0008 [0x03] ExtData[1]->WorkLocal[1] = 0*
  3: 0x000D [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[3]
  4: 0x0012 [0x08] ExtData[1]->WorkLocal[0] -= 21*
  5: 0x0017 [0x3C] SET_BIT_FLAG_CONDITIONAL(target_work_offset=0x01, bit_index_work_offset=0x8002, condition_work_offset=0x8003)
  6: 0x001E [0x24] CREATE_DIALOG(message_id=7241*, default_option=0x0000, option_flags=0x01)
    → "Select a destination.\u0007\u000B\u000C\u0000[/NW/SW/NE/SE] #1.\u0007\u000C\u0000[/NW/SW/NE/SE] #2.\u0007\u000C\u0000[/NW/SW/NE/SE] #3.\u0007\u000C\u0000[/NW/SW/NE/SE] #4.\u0007\u000C\u0000[/NW//NE] #5.\u0007Entrance #1.\u0007Entrance #2.\u0007Never mind.\u007F1\u0000\u0007"
  7: 0x0025 [0x25] WAIT_DIALOG_SELECT()
  8: 0x0026 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x0036
  9: 0x002E [0x03] Work_Zone[1] = 21*
 10: 0x0033 [0x01] GOTO 0x00A6
 11: 0x0036 [0x02] IF !(Work_Zone[0] == 1*) GOTO 0x0046
 12: 0x003E [0x03] Work_Zone[1] = 22*
 13: 0x0043 [0x01] GOTO 0x00A6
 14: 0x0046 [0x02] IF !(Work_Zone[0] == 2*) GOTO 0x0056
 15: 0x004E [0x03] Work_Zone[1] = 23*
 16: 0x0053 [0x01] GOTO 0x00A6
 17: 0x0056 [0x02] IF !(Work_Zone[0] == 3*) GOTO 0x0066
 18: 0x005E [0x03] Work_Zone[1] = 24*
 19: 0x0063 [0x01] GOTO 0x00A6
 20: 0x0066 [0x02] IF !(Work_Zone[0] == 4*) GOTO 0x0076
 21: 0x006E [0x03] Work_Zone[1] = 25*
 22: 0x0073 [0x01] GOTO 0x00A6
 23: 0x0076 [0x02] IF !(Work_Zone[0] == 5*) GOTO 0x0086
 24: 0x007E [0x03] Work_Zone[1] = 1*
 25: 0x0083 [0x01] GOTO 0x00A6
 26: 0x0086 [0x02] IF !(Work_Zone[0] == 6*) GOTO 0x0096
 27: 0x008E [0x03] Work_Zone[1] = 2*
 28: 0x0093 [0x01] GOTO 0x00A6
 29: 0x0096 [0x02] IF !(Work_Zone[0] == 7*) GOTO 0x00A6
 30: 0x009E [0x03] Work_Zone[1] = 0*
 31: 0x00A3 [0x01] GOTO 0x00A6

SUBROUTINE_00A6:
 32: 0x00A6 [0x02] IF !(Work_Zone[0] == ExtData[1]->WorkLocal[0]) GOTO 0x00B6
 33: 0x00AE [0x03] Work_Zone[1] = 255*
 34: 0x00B3 [0x01] GOTO 0x016D
 35: 0x00B6 [0x02] IF !(Work_Zone[1] == 0*) GOTO 0x00C1
 36: 0x00BE [0x01] GOTO 0x016D
 37: 0x00C1 [0x42] SET_CLI_EVENT_CANCEL_DATA()
 38: 0x00C2 [0x03] ExtData[1]->WorkLocal[2] = Work_Zone[1]
 39: 0x00C7 [0x03] Work_Zone[1] = 100*
 40: 0x00CC [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 41: 0x00CE [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 42: 0x00D0 [0x03] Work_Zone[1] = ExtData[1]->WorkLocal[2]
 43: 0x00D5 [0x29] REQ_SET_WAIT(priority=0x01, entity_id=LocalPlayer, tag_num=0x02)
 44: 0x00DC [0x02] IF !(Work_Zone[1] == 1*) GOTO 0x00F3
 45: 0x00E4 [0x47] UPDATE_PLAYER_POS(-608.000*, -600.000*, 0.000*, yaw=177.9°*)
 46: 0x00EE [0x47] WAIT_PLAYER_POS_UPDATE
 47: 0x00F0 [0x01] GOTO 0x0166
 48: 0x00F3 [0x02] IF !(Work_Zone[1] == 2*) GOTO 0x010A
 49: 0x00FB [0x47] UPDATE_PLAYER_POS(608.000*, -600.000*, 0.000*, yaw=0.0°*)
 50: 0x0105 [0x47] WAIT_PLAYER_POS_UPDATE
 51: 0x0107 [0x01] GOTO 0x0166
 52: 0x010A [0x02] IF !(Work_Zone[1] == 21*) GOTO 0x0121
 53: 0x0112 [0x47] UPDATE_PLAYER_POS(-468.000*, -625.000*, 0.000*, yaw=315.0°*)
 54: 0x011C [0x47] WAIT_PLAYER_POS_UPDATE
 55: 0x011E [0x01] GOTO 0x0166
 56: 0x0121 [0x02] IF !(Work_Zone[1] == 22*) GOTO 0x0138
 57: 0x0129 [0x47] UPDATE_PLAYER_POS(-576.000*, -428.000*, 0.000*, yaw=225.0°*)
 58: 0x0133 [0x47] WAIT_PLAYER_POS_UPDATE
 59: 0x0135 [0x01] GOTO 0x0166
 60: 0x0138 [0x02] IF !(Work_Zone[1] == 23*) GOTO 0x014F
 61: 0x0140 [0x47] UPDATE_PLAYER_POS(-428.000*, -385.000*, 0.000*, yaw=315.0°*)
 62: 0x014A [0x47] WAIT_PLAYER_POS_UPDATE
 63: 0x014C [0x01] GOTO 0x0166
 64: 0x014F [0x02] IF !(Work_Zone[1] == 24*) GOTO 0x0166
 65: 0x0157 [0x47] UPDATE_PLAYER_POS(-176.000*, -628.000*, 0.000*, yaw=225.0°*)
 66: 0x0161 [0x47] WAIT_PLAYER_POS_UPDATE
 67: 0x0163 [0x01] GOTO 0x0166

SUBROUTINE_0166:
 68: 0x0166 [0x29] REQ_SET_WAIT(priority=0x01, entity_id=LocalPlayer, tag_num=0x03)
 69: 0x016D [0x20] SET_CLI_EVENT_UC_FLAG: Unlock player control
 70: 0x016F [0x21] END_EVENT
 71: 0x0170 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x0171 [0x9F] LOAD_SCHEDULED_TASK_ALT: Load scheduler "main" with entities [LocalPlayer, LocalPlayer], work=[73*, 0*]
     0x0182 [0x03] ExtData[1]->WorkLocal[2] = Work_Zone[1]
     0x0187 [0x03] Work_Zone[1] = 100*
     0x018C [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
     0x018E [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
     0x0190 [0x03] Work_Zone[1] = ExtData[1]->WorkLocal[2]
     0x0195 [0x1C] WAIT(140* ticks)
     0x0198 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdo1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
     0x01A9 [0x1C] WAIT(60* ticks)
     0x01AC [0x46] CAMERA_CONTROL: Disable user control
     0x01AE [0x1B] RETURN
     0x01AF [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdi1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
     0x01C0 [0x9F] LOAD_SCHEDULED_TASK_ALT: Load scheduler "main" with entities [LocalPlayer, LocalPlayer], work=[74*, 0*]
     0x01D1 [0x1C] WAIT(170* ticks)
     0x01D4 [0x46] CAMERA_CONTROL: Restore default settings
     0x01D6 [0x1B] RETURN
```