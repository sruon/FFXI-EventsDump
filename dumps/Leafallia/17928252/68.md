# Event 68

## Metadata

| Field           | Value      |
|-----------------|------------|
| Event Index     | 6/6        |
| Offset          | 0x3930     |
| Data Size       | 1108 bytes |
| Calculated Size | 1108 bytes |
| Instructions    | 67         |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
3930: 42 1A 64 00 46 01 38 08  80 AB 09 2F 00 29 90 11  B.d.F.8..../.)..
3940: 01 4E 00 29 90 11 01 4E  00 F0 FF FF 7F 94 01 29  .N.)...N.......)
3950: 90 11 01 94 01 F0 FF FF  7F 59 05 29 90 11 01 01  .........Y.)....
3960: 59 05 F0 FF FF 7F 01 BA  29 90 11 01 55 80 56 80  Y.......)...U.V.
3970: 57 80 13 80 BA F0 FF FF  7F 58 80 59 80 5A 80 5B  W........X.Y.Z.[
3980: 80 80 29 90 11 01 80 F0  FF FF 7F 4A F0 FF FF 7F  ..)........J....
3990: 29 90 11 01 6C 29 90 11  01 01 80 03 80 81 00 29  )...l).........)
39A0: 90 11 01 7C 00 29 90 11  01 1C 06 80 45 C8 80 F8  ...|.)......E...
39B0: FF FF 7F F8 FF FF 7F 73  30 30 30 01 80 45 00 80  .......s000..E..
39C0: F0 FF FF 7F F0 FF FF 7F  66 64 69 31 01 80 1C 1D  ........fdi1....
39D0: 80 73 B2 80 29 90 11 01  29 90 11 01 55 00 80 F0  .s..)...)...U...
39E0: FF FF 7F F0 FF FF 7F 66  64 69 31 1C 28 80 52 C8  .......fdi1.(.R.
39F0: 80 F8 FF FF 7F F8 FF FF  7F 73 30 30 30 45 C8 80  .........s000E..
3A00: F8 FF FF 7F F8 FF FF 7F  73 30 30 31 01 80 1C 06  ........s001....
3A10: 80 2B 29 90 11 01 C9 80  23 1C 28 80 52 C8 80 F8  .+).....#.(.R...
3A20: FF FF 7F F8 FF FF 7F 73  30 30 31 02 87 7F 65 80  .......s001...e.
3A30: 80 47 3A 45 C8 80 F8 FF  FF 7F F8 FF FF 7F 73 67  .G:E..........sg
3A40: 30 32 01 80 01 C8 3A 02  87 7F 68 80 80 63 3A 45  02....:...h..c:E
3A50: C8 80 F8 FF FF 7F F8 FF  FF 7F 73 67 30 32 01 80  ..........sg02..
3A60: 01 C8 3A 02 87 7F 1D 80  80 7F 3A 45 C8 80 F8 FF  ..:.......:E....
3A70: FF 7F F8 FF FF 7F 73 74  30 32 01 80 01 C8 3A 02  ......st02....:.
3A80: 87 7F 1E 80 80 9B 3A 45  C8 80 F8 FF FF 7F F8 FF  ......:E........
3A90: FF 7F 73 74 30 32 01 80  01 C8 3A 02 87 7F 6E 80  ..st02....:...n.
3AA0: 80 B7 3A 45 C8 80 F8 FF  FF 7F F8 FF FF 7F 73 67  ..:E..........sg
3AB0: 30 32 01 80 01 C8 3A 45  C8 80 F8 FF FF 7F F8 FF  02....:E........
3AC0: FF 7F 73 30 30 32 01 80  2B 29 90 11 01 0A 81 23  ..s002..+).....#
3AD0: 2B 29 90 11 01 CD 80 23  03 01 10 03 80 43 00 43  +).....#.....C.C
3AE0: 01 03 01 00 09 10 03 01  10 01 80 03 02 00 01 80  ................
3AF0: 02 02 00 01 80 00 02 3C  03 04 00 01 80 9D 0A 9A  .......<........
3B00: 37 02 10 03 80 68 80 9D  0A 9A 37 03 10 05 80 68  7....h....7....h
3B10: 80 9D 0A 9A 37 04 10 65  80 68 80 D4 03 01 80 02  ....7..e.h......
3B20: 10 D4 03 03 80 03 10 D4  03 05 80 04 10 03 05 10  ................
3B30: CE 80 D4 02 CF 80 00 00  01 00 25 02 00 10 65 80  ..........%...e.
3B40: 00 50 3B 03 00 00 00 10  03 04 00 03 80 01 6F 3B  .P;...........o;
3B50: 02 00 10 68 80 00 65 3B  03 00 00 00 10 03 04 00  ...h..e;........
3B60: 05 80 01 6F 3B 03 00 00  00 10 03 04 00 01 80 2B  ...o;..........+
3B70: 29 90 11 01 D0 80 23 02  04 00 01 80 80 B9 3B 03  ).....#.......;.
3B80: 03 00 00 00 0B 03 00 9D  0A 9A 37 06 10 03 00 68  ..........7....h
3B90: 80 D4 03 01 80 06 10 D4  03 03 80 06 10 D4 02 D1  ................
3BA0: 80 03 80 01 80 25 02 00  10 01 80 00 B6 3B 03 02  .....%.......;..
3BB0: 00 03 80 01 B6 3B 01 FF  3B 02 04 00 03 80 80 DC  .....;..;.......
3BC0: 3B 24 D2 80 03 80 01 80  25 02 00 10 01 80 00 D9  ;$......%.......
3BD0: 3B 03 02 00 03 80 01 D9  3B 01 FF 3B 02 04 00 05  ;.......;..;....
3BE0: 80 80 FF 3B 24 D3 80 03  80 01 80 25 02 00 10 01  ...;$......%....
3BF0: 80 00 FC 3B 03 02 00 03  80 01 FC 3B 01 FF 3B 01  ...;.......;..;.
3C00: F0 3A 0B 00 00 03 01 10  00 00 02 87 7F 65 80 80  .:...........e..
3C10: 24 3C 52 C8 80 F8 FF FF  7F F8 FF FF 7F 73 67 30  $<R..........sg0
3C20: 32 01 9B 3C 02 87 7F 68  80 80 3E 3C 52 C8 80 F8  2..<...h..><R...
3C30: FF FF 7F F8 FF FF 7F 73  67 30 32 01 9B 3C 02 87  .......sg02..<..
3C40: 7F 1D 80 80 58 3C 52 C8  80 F8 FF FF 7F F8 FF FF  ....X<R.........
3C50: 7F 73 74 30 32 01 9B 3C  02 87 7F 1E 80 80 72 3C  .st02..<......r<
3C60: 52 C8 80 F8 FF FF 7F F8  FF FF 7F 73 74 30 32 01  R..........st02.
3C70: 9B 3C 02 87 7F 6E 80 80  8C 3C 52 C8 80 F8 FF FF  .<...n...<R.....
3C80: 7F F8 FF FF 7F 73 67 30  32 01 9B 3C 52 C8 80 F8  .....sg02..<R...
3C90: FF FF 7F F8 FF FF 7F 73  30 30 32 45 C8 80 F8 FF  .......s002E....
3CA0: FF 7F F8 FF FF 7F 73 30  30 33 01 80 22 00 C4 02  ......s003.."...
3CB0: D4 80 29 90 11 01 F8 FF  FF 7F 1C 9F 80 22 01 2B  ..)..........".+
3CC0: 29 90 11 01 D5 80 1C 27  80 23 45 00 80 F8 FF FF  )......'.#E.....
3CD0: 7F F8 FF FF 7F 6F 76 6C  31 01 80 52 C8 80 F8 FF  .....ovl1..R....
3CE0: FF 7F F8 FF FF 7F 73 30  30 33 45 C8 80 F8 FF FF  ......s003E.....
3CF0: 7F F8 FF FF 7F 73 30 30  35 01 80 03 02 10 D7 80  .....s005.......
3D00: 2B 29 90 11 01 D8 80 23  52 C8 80 F8 FF FF 7F F8  +).....#R.......
3D10: FF FF 7F 73 30 30 35 45  C8 80 F8 FF FF 7F F8 FF  ...s005E........
3D20: FF 7F 73 30 30 36 01 80  73 D9 80 29 90 11 01 29  ..s006..s..)...)
3D30: 90 11 01 1C 1F 80 1A 64  00 1C 06 80 52 C8 80 F8  .......d....R...
3D40: FF FF 7F F8 FF FF 7F 73  30 30 36 27 0F 29 90 11  .......s006'.)..
3D50: 01 04 1C 49 80 AB 11 01  80 1C 03 80 AB 0A 46 00  ...I..........F.
3D60: 45 00 80 F0 FF FF 7F F0  FF FF 7F 66 64 69 32 01  E..........fdi2.
3D70: 80 45 02 80 F8 FF FF 7F  F8 FF FF 7F 71 73 74 63  .E..........qstc
3D80: 01 80 21 00                                       ..!.            
```

## Opcodes

```
  0: 0x3930 [0x42] SET_CLI_EVENT_CANCEL_DATA()
  1: 0x3931 [0x1A] CALL_SUBROUTINE(address=0x0064)
  2: 0x3934 [0x46] CAMERA_CONTROL: Disable user control
  3: 0x3936 [0x38] SET_CLIENT_EVENT_MODE(mode=147*)
  4: 0x3939 [0xAB] EventEntity->UnknownFlag = 1 // Enable unknown flag
  5: 0x393B [0x2F] Unnamed NPC (ID: 17928233/0x01119029)->Render.Flags0 &= ~0x80000 // Bit 19
  6: 0x3941 [0x4E] SET_ENTITY_HIDE_FLAG: Show Unnamed NPC (ID: 17928233/0x01119029)
  7: 0x3947 [0x4E] SET_ENTITY_HIDE_FLAG: Show LocalPlayer
  8: 0x394D [0x94] Unnamed NPC (ID: 17928233/0x01119029)->Render.Flags3 ^= 0x01
  9: 0x3953 [0x94] LocalPlayer->Render.Flags3 ^= 0x01
 10: 0x3959 [0x59] UPDATE_ENTITY_DATA: Unnamed NPC (ID: 17928233/0x01119029)->Render.Flags0 |= 0x200000
 11: 0x3960 [0x59] UPDATE_ENTITY_DATA: LocalPlayer->Render.Flags0 |= 0x200000
 12: 0x3967 [0xBA] SET_ENTITY_POSITION(entity_id=References[17895465], pos_x=-19.070*, pos_z=114.440*, pos_y=-15.000*, direction=87.9°*)
 13: 0x3974 [0xBA] SET_ENTITY_POSITION(entity_id=LocalPlayer, pos_x=-20.300*, pos_z=91.980*, pos_y=-12.000*, direction=272.5°*)
 14: 0x3981 [0x80] LOAD_WAIT(entity=Unnamed NPC (ID: 17928233/0x01119029))
 15: 0x3986 [0x80] LOAD_WAIT(entity=LocalPlayer)
 16: 0x398B [0x4A] LocalPlayer looks at Unnamed NPC (ID: 17928233/0x01119029)
 17: 0x3994 [0x6C] FADE_ENTITY_COLOR(entity_id=Unnamed NPC (ID: 17928233/0x01119029), end_alpha=0*, fade_time=1*)
 18: 0x399D [0x81] SET_ENTITY_BLINKING(blink_flag=0x00, entity=Unnamed NPC (ID: 17928233/0x01119029))
 19: 0x39A3 [0x7C] Unnamed NPC (ID: 17928233/0x01119029)->Render.Flags2 |= 0x00
 20: 0x39A9 [0x1C] WAIT(30* ticks)
 21: 0x39AC [0x45] LOAD_SCHEDULED_TASK: Load scheduler "s000" with entities [EventEntity, EventEntity], work=[815*, 0*]
 22: 0x39BD [0x45] LOAD_SCHEDULED_TASK: Load scheduler "fdi1" with entities [LocalPlayer, LocalPlayer], work=[200*, 0*]
 23: 0x39CE [0x1C] WAIT(5* ticks)
 24: 0x39D1 [0x73] Unnamed NPC (ID: 17928233/0x01119029) casts magic 620* on Unnamed NPC (ID: 17928233/0x01119029)
 25: 0x39DC [0x55] WAIT_LOAD_SCHEDULER: Wait for scheduler "fdi1" with entities [LocalPlayer, LocalPlayer], work=200*
 26: 0x39EB [0x1C] WAIT(60* ticks)
 27: 0x39EE [0x52] END_LOAD_SCHEDULER: End scheduler "s000" with entities [EventEntity, EventEntity], work=815*
 28: 0x39FD [0x45] LOAD_SCHEDULED_TASK: Load scheduler "s001" with entities [EventEntity, EventEntity], work=[815*, 0*]
 29: 0x3A0E [0x1C] WAIT(30* ticks)
 30: 0x3A11 [0x2B] Unnamed NPC (ID: 17928233/0x01119029) [8002*]:
    → "Impressive.\u007F1\u0000\u0007"
 31: 0x3A18 [0x23] WAIT_FOR_DIALOG_INTERACTION
 32: 0x3A19 [0x1C] WAIT(60* ticks)
 33: 0x3A1C [0x52] END_LOAD_SCHEDULER: End scheduler "s001" with entities [EventEntity, EventEntity], work=815*
 34: 0x3A2B [0x02] IF !(LocalPlayer->Race == 3*) GOTO 0x3A47
 35: 0x3A33 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "sg02" with entities [EventEntity, EventEntity], work=[815*, 0*]
 36: 0x3A44 [0x01] GOTO 0x3AC8
 37: 0x3A47 [0x02] IF !(LocalPlayer->Race == 4*) GOTO 0x3A63
 38: 0x3A4F [0x45] LOAD_SCHEDULED_TASK: Load scheduler "sg02" with entities [EventEntity, EventEntity], work=[815*, 0*]
 39: 0x3A60 [0x01] GOTO 0x3AC8
 40: 0x3A63 [0x02] IF !(LocalPlayer->Race == 5*) GOTO 0x3A7F
 41: 0x3A6B [0x45] LOAD_SCHEDULED_TASK: Load scheduler "st02" with entities [EventEntity, EventEntity], work=[815*, 0*]
 42: 0x3A7C [0x01] GOTO 0x3AC8
 43: 0x3A7F [0x02] IF !(LocalPlayer->Race == 6*) GOTO 0x3A9B
 44: 0x3A87 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "st02" with entities [EventEntity, EventEntity], work=[815*, 0*]
 45: 0x3A98 [0x01] GOTO 0x3AC8
 46: 0x3A9B [0x02] IF !(LocalPlayer->Race == 8*) GOTO 0x3AB7
 47: 0x3AA3 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "sg02" with entities [EventEntity, EventEntity], work=[815*, 0*]
 48: 0x3AB4 [0x01] GOTO 0x3AC8
 49: 0x3AB7 [0x45] LOAD_SCHEDULED_TASK: Load scheduler "s002" with entities [EventEntity, EventEntity], work=[815*, 0*]
 50: 0x3AC8 [0x2B] Unnamed NPC (ID: 17928233/0x01119029) [8042*]:
    → "I have once again confirmed the bond between us. You have my gratitude.\u007F1\u0000\u0007"
 51: 0x3ACF [0x23] WAIT_FOR_DIALOG_INTERACTION
 52: 0x3AD0 [0x2B] Unnamed NPC (ID: 17928233/0x01119029) [8006*]:
    → "Tell me, what is it that you desire?\u007F1\u0000\u0007"
 53: 0x3AD7 [0x23] WAIT_FOR_DIALOG_INTERACTION
 54: 0x3AD8 [0x03] Work_Zone[1] = 1*
 55: 0x3ADD [0x43] SEND_EVENT_UPDATE: Send pending tag to server (packet 0x005B)
 56: 0x3ADF [0x43] SEND_EVENT_UPDATE: Check pending flag (skip if not pending)
 57: 0x3AE1 [0x03] ExtData[1]->WorkLocal[1] = Work_Zone[9]
 58: 0x3AE6 [0x03] Work_Zone[1] = 0*
 59: 0x3AEB [0x03] ExtData[1]->WorkLocal[2] = 0*
 60: 0x3AF0 [0x02] IF !(ExtData[1]->WorkLocal[2] == 0*) GOTO 0x3C02
 61: 0x3AF8 [0x03] ExtData[1]->WorkLocal[4] = 0*
 62: 0x3AFD [0x9D] IF (0x379A) 1* = Work_Zone[2] // extra=0x8068
 63: 0x3B07 [0x9D] IF (0x379A) 2* = Work_Zone[3] // extra=0x8068
 64: 0x3B11 [0x9D] IF (0x379A) 3* = Work_Zone[4] // extra=0x8068
 65: 0x3B1B [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration A (buffer=[01 80 02 10 D4 03 03 80...])
 66: 0x3B39 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x3B3A [0x25] WAIT_DIALOG_SELECT()
     0x3B3B [0x02] IF !(Work_Zone[0] == 3*) GOTO 0x3B50
     0x3B43 [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[0]
     0x3B48 [0x03] ExtData[1]->WorkLocal[4] = 1*
     0x3B4D [0x01] GOTO 0x3B6F
     0x3B50 [0x02] IF !(Work_Zone[0] == 4*) GOTO 0x3B65
     0x3B58 [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[0]
     0x3B5D [0x03] ExtData[1]->WorkLocal[4] = 2*
     0x3B62 [0x01] GOTO 0x3B6F
     0x3B65 [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[0]
     0x3B6A [0x03] ExtData[1]->WorkLocal[4] = 0*
     0x3B6F [0x2B] Unnamed NPC (ID: 17928233/0x01119029) [8008*]:
    → "Is that what you truly desire?\u007F1\u0000\u0007"
     0x3B76 [0x23] WAIT_FOR_DIALOG_INTERACTION
     0x3B77 [0x02] IF !(ExtData[1]->WorkLocal[4] == 0*) GOTO 0x3BB9
     0x3B7F [0x03] ExtData[1]->WorkLocal[3] = ExtData[1]->WorkLocal[0]
     0x3B84 [0x0B] ExtData[1]->WorkLocal[3]++
     0x3B87 [0x9D] IF (0x379A) ExtData[1]->WorkLocal[3] = Work_Zone[6] // extra=0x8068
     0x3B91 [0xD4] MAP_QUERY_WINDOW: Prepare buffer configuration A (buffer=[01 80 06 10 D4 03 03 80...])
     0x3BAF [0x02] IF !(0x0300 & 0x0180) GOTO 0x013B
     0x3BB7 [0xFF] UNKNOWN_0xFF
     0x3BB8 [0x3B] GET_ENTITY_POSITION(entity=Unknown NPC (ID: 50332674/0x03000402), x_destination=3530*, y_destination=0x3BDC, z_destination=0xD224)
     0x3BC3 [0x80] LOAD_WAIT(entity=Unknown NPC (ID: 2147581955/0x80018003))
     0x3BC8 [0x25] WAIT_DIALOG_SELECT()
     0x3BC9 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x3BD9
     0x3BD1 [0x03] ExtData[1]->WorkLocal[2] = 1*
     0x3BD6 [0x01] GOTO 0x3BD9
     0x3BD9 [0x01] GOTO 0x3BFF
     0x3BDC [0x02] IF !(ExtData[1]->WorkLocal[4] == 2*) GOTO 0x3BFF
     0x3BE4 [0x24] CREATE_DIALOG(message_id=8011*, default_option=1*, option_flags=0*)
    → "Are you sure about this?\u0007\u000BYes.\u0007On second thought...\u007F1\u0000\u0007"
     0x3BEB [0x25] WAIT_DIALOG_SELECT()
     0x3BEC [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x3BFC
     0x3BF4 [0x03] ExtData[1]->WorkLocal[2] = 1*
     0x3BF9 [0x01] GOTO 0x3BFC
     0x3BFC [0x01] GOTO 0x3BFF
     0x3BFF [0x01] GOTO 0x3AF0
```