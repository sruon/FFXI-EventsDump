# Event 173

## Metadata

| Field           | Value     |
|-----------------|-----------|
| Event Index     | 4/4       |
| Offset          | 0x0041    |
| Data Size       | 278 bytes |
| Calculated Size | 278 bytes |
| Instructions    | 29        |

```
      00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F
      -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --
0040:    03 00 00 09 10 06 01  10 1E F0 FF FF 7F 6F 70   .............op
0050: 02 00 00 04 80 00 EC 00  6E E1 42 08 01 05 80 99  ........n.B.....
0060: E1 42 08 01 1D 06 80 23  66 00 80 F8 FF FF 7F F8  .B.....#f.......
0070: FF FF 7F 74 6C 6B 30 03  02 10 07 80 1D 08 80 23  ...tlk0........#
0080: 1D 09 80 23 24 0A 80 04  80 04 80 25 02 00 10 04  ...#$......%....
0090: 80 00 9A 00 01 55 01 01  E9 00 02 00 10 0B 80 00  .....U..........
00A0: B8 00 6E E1 42 08 01 0C  80 99 E1 42 08 01 1D 0D  ..n.B......B....
00B0: 80 23 01 84 00 01 E9 00  02 00 10 0E 80 00 E9 00  .#..............
00C0: 42 66 00 80 F8 FF FF 7F  F8 FF FF 7F 74 6C 6B 30  Bf..........tlk0
00D0: 1D 0F 80 23 03 02 10 01  80 1D 10 80 23 1D 11 80  ...#........#...
00E0: 23 03 01 10 0B 80 01 E9  00 01 55 01 1D 12 80 23  #.........U....#
00F0: 24 0A 80 04 80 04 80 25  02 00 10 04 80 00 06 01  $......%........
0100: 01 55 01 01 55 01 02 00  10 0B 80 00 24 01 6E E1  .U..U.......$.n.
0110: 42 08 01 0C 80 99 E1 42  08 01 1D 0D 80 23 01 84  B......B.....#..
0120: 00 01 55 01 02 00 10 0E  80 00 55 01 42 66 00 80  ..U.......U.Bf..
0130: F8 FF FF 7F F8 FF FF 7F  74 6C 6B 30 1D 0F 80 23  ........tlk0...#
0140: 03 02 10 01 80 1D 10 80  23 1D 11 80 23 03 01 10  ........#...#...
0150: 0B 80 01 55 01 21 00                              ...U.!.         
```

## Opcodes

```
  0: 0x0041 [0x03] ExtData[1]->WorkLocal[0] = Work_Zone[9]
  1: 0x0046 [0x06] Work_Zone[1] = 0
  2: 0x0049 [0x1E] EventEntity looks at LocalPlayer and starts talking
  3: 0x004E [0x6F] WAIT_FRAME_DELAY: Yield until WaitTime reaches zero
  4: 0x004F [0x70] WAIT_ENTITY_RENDER_FLAG: Wait while EventEntity->Render.Flags3 bit 2 is set (cancel turn if not)
  5: 0x0050 [0x02] IF !(ExtData[1]->WorkLocal[0] == 0*) GOTO 0x00EC
  6: 0x0058 [0x6E] Joulet (ID: 17318625/0x010842E1) uses emote 33*
  7: 0x005F [0x99] Wait for Joulet (ID: 17318625/0x010842E1) animation to complete
  8: 0x0064 [0x1D] PRINT_EVENT_MESSAGE(message_id=7945*)
    → "Confound it, yet another failure!\u0007What in this accursed world am I to do now?\u007F1\u0000\u0007"
  9: 0x0067 [0x23] WAIT_FOR_DIALOG_INTERACTION
 10: 0x0068 [0x66] LOAD_EXT_SCHEDULER_MAIN: Load scheduler "tlk0" with entities [EventEntity, EventEntity], work=20*
 11: 0x0077 [0x03] Work_Zone[2] = 17391*
 12: 0x007C [0x1D] PRINT_EVENT_MESSAGE(message_id=7946*)
    → "Not moments after we received this \u0001\u0005#\u0002\u0000\u0000\u0000 for repairs, some foul fiends did for our resident craftsman.\u0007Heaven knows I've tried to mend it for days now, but 'tis no use. I simply have not the expertise.\u007F1\u0000\u0007"
 13: 0x007F [0x23] WAIT_FOR_DIALOG_INTERACTION
 14: 0x0080 [0x1D] PRINT_EVENT_MESSAGE(message_id=7947*)
    → "With times difficult as they are, naught can be permitted to go to waste.\u0007Even a humble fishing rod could well spell the difference between a belly full of fish and starvation...but I'm at my wit's end.\u007F1\u0000\u0007"
 15: 0x0083 [0x23] WAIT_FOR_DIALOG_INTERACTION
 16: 0x0084 [0x24] CREATE_DIALOG(message_id=7948*, default_option=0*, option_flags=0*)
    → "What will do you?\u0007\u000BNothing.\u0007Cheer him up with a jest.\u0007Offer to mend the fishing rod.\u007F1\u0000\u0007"
 17: 0x008B [0x25] WAIT_DIALOG_SELECT()
 18: 0x008C [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x009A
 19: 0x0094 [0x01] GOTO 0x0155

SUBROUTINE_00E9:
 20: 0x00E9 [0x01] GOTO 0x0155
 21: 0x00EC [0x1D] PRINT_EVENT_MESSAGE(message_id=7955*)
    → "Ah, you couldn't have come at a better time.\u0007Yet another fishing rod has fallen victim to my brother's ineptitude, you see, and I haven't quite mastered the repairs...\u007F1\u0000\u0007"
 22: 0x00EF [0x23] WAIT_FOR_DIALOG_INTERACTION
 23: 0x00F0 [0x24] CREATE_DIALOG(message_id=7948*, default_option=0*, option_flags=0*)
    → "What will do you?\u0007\u000BNothing.\u0007Cheer him up with a jest.\u0007Offer to mend the fishing rod.\u007F1\u0000\u0007"
 24: 0x00F7 [0x25] WAIT_DIALOG_SELECT()
 25: 0x00F8 [0x02] IF !(Work_Zone[0] == 0*) GOTO 0x0106
 26: 0x0100 [0x01] GOTO 0x0155

SUBROUTINE_0155:
 27: 0x0155 [0x21] END_EVENT
 28: 0x0156 [0x00] END_REQSTACK()
```

## Data or dead code:

```
# Dead code (unreachable instructions):
     0x0097 [0x01] GOTO 0x00E9
     0x00B5 [0x01] GOTO 0x00E9
# Dead code (unreachable instructions):
     0x0103 [0x01] GOTO 0x0155
     0x0121 [0x01] GOTO 0x0155
```